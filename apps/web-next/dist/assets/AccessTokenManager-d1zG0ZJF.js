import{r as n,j as e,c as r}from"./index-CbGtQieT.js";const o=[{id:"app1",name:"Horizon Dashboard",clientId:"cli_9kX2mNpQ",type:"spa",scopes:["read","write","admin"],redirectUris:["https://app.corp.io/callback"],status:"active",createdAt:"2024-01-15",lastUsed:"2026-02-22",tokenCount:8241},{id:"app2",name:"Mobile App (iOS)",clientId:"cli_7jM3pRsT",type:"native",scopes:["read","write"],redirectUris:["io.corp.app://callback"],status:"active",createdAt:"2024-03-02",lastUsed:"2026-02-22",tokenCount:3102},{id:"app3",name:"CI Pipeline Bot",clientId:"cli_5nK4qStU",type:"machine",scopes:["deploy","read"],redirectUris:[],status:"active",createdAt:"2024-06-10",lastUsed:"2026-02-21",tokenCount:144},{id:"app4",name:"Analytics Exporter",clientId:"cli_3mJ5rTuV",type:"machine",scopes:["read","analytics.export"],redirectUris:[],status:"active",createdAt:"2025-01-20",lastUsed:"2026-02-20",tokenCount:29},{id:"app5",name:"Legacy Web App (Sunset)",clientId:"cli_1kH6sTwW",type:"web",scopes:["read"],redirectUris:["https://legacy.corp.io/auth"],status:"suspended",createdAt:"2022-09-01",lastUsed:"2025-11-14",tokenCount:0},{id:"app6",name:"Partner Integration",clientId:"cli_8pN7uVxX",type:"web",scopes:["read","partner.api"],redirectUris:["https://partner.acme.com/oauth/callback"],status:"active",createdAt:"2025-08-12",lastUsed:"2026-02-22",tokenCount:891}],x=[{id:"tok1",appId:"app1",userId:"usr_9kX2",userEmail:"alice@corp.io",scopes:["read","write","admin"],issuedAt:"2026-02-22T06:15:00Z",expiresAt:"2026-02-22T07:15:00Z",lastUsed:"2026-02-22T07:38:00Z",status:"active",ipAddress:"10.0.1.42",userAgent:"Chrome/122 macOS"},{id:"tok2",appId:"app2",userId:"usr_8xT1",userEmail:"bob@corp.io",scopes:["read","write"],issuedAt:"2026-02-22T07:01:00Z",expiresAt:"2026-02-22T08:01:00Z",lastUsed:"2026-02-22T07:35:00Z",status:"active",ipAddress:"192.168.1.101",userAgent:"iOS/17.3 com.corp.app"},{id:"tok3",appId:"app3",userId:"sys_ci",userEmail:"ci@corp.io",scopes:["deploy","read"],issuedAt:"2026-02-22T07:30:00Z",expiresAt:"2026-02-22T08:30:00Z",lastUsed:"2026-02-22T07:32:00Z",status:"active",ipAddress:"10.100.0.5",userAgent:"GitHub-Actions"},{id:"tok4",appId:"app1",userId:"usr_7kW2",userEmail:"carol@corp.io",scopes:["read","write"],issuedAt:"2026-02-22T05:00:00Z",expiresAt:"2026-02-22T06:00:00Z",lastUsed:"2026-02-22T05:55:00Z",status:"expired",ipAddress:"172.16.0.20",userAgent:"Firefox/124 Windows"},{id:"tok5",appId:"app6",userId:"ext_acme",userEmail:"api@acme.com",scopes:["read","partner.api"],issuedAt:"2026-02-21T12:00:00Z",expiresAt:"2026-02-22T12:00:00Z",lastUsed:"2026-02-21T18:30:00Z",status:"active",ipAddress:"54.201.88.12",userAgent:"AcmeIntegration/2.1"},{id:"tok6",appId:"app4",userId:"sys_exp",userEmail:"exporter@corp.io",scopes:["read","analytics.export"],issuedAt:"2026-02-20T00:00:00Z",expiresAt:"2026-02-21T00:00:00Z",lastUsed:"2026-02-20T23:45:00Z",status:"expired",ipAddress:"10.0.2.30",userAgent:"ExporterBot/1.0"},{id:"tok7",appId:"app1",userId:"usr_5nRt",userEmail:"david@corp.io",scopes:["read"],issuedAt:"2026-02-19T14:00:00Z",expiresAt:"2026-02-20T14:00:00Z",lastUsed:"2026-02-19T14:00:00Z",status:"revoked",ipAddress:"203.0.113.44",userAgent:"Chrome/121 Linux"}],U=[{key:"sub",value:"usr_9kX2",type:"standard"},{key:"iss",value:"https://auth.corp.io",type:"standard"},{key:"aud",value:"https://api.corp.io",type:"standard"},{key:"exp",value:"1740207300 (2026-02-22T07:15:00Z)",type:"standard"},{key:"iat",value:"1740203700 (2026-02-22T06:15:00Z)",type:"standard"},{key:"jti",value:"tok_a8f3d9e2",type:"standard"},{key:"scope",value:"read write admin",type:"standard"},{key:"email",value:"alice@corp.io",type:"custom"},{key:"plan",value:"enterprise",type:"custom"},{key:"org",value:"corp_9kX2",type:"custom"},{key:"roles",value:'["admin","developer"]',type:"custom"}],E=["read","write","admin","deploy","analytics.export","partner.api","billing","audit.read"],h={spa:"bg-indigo-400/15 border-indigo-500/30 text-indigo-300",web:"bg-blue-400/15 border-blue-500/30 text-blue-300",native:"bg-emerald-400/15 border-emerald-500/30 text-emerald-300",machine:"bg-amber-400/15 border-amber-500/30 text-amber-300"};function _(){const[d,g]=n.useState("tokens"),[i,v]=n.useState(null),[t,j]=n.useState(null),[p,N]=n.useState("all"),[m,y]=n.useState("all"),[f,z]=n.useState(""),[C,A]=n.useState(!1),k=[{id:"tokens",label:"Active Tokens",emoji:"ðŸ”‘"},{id:"apps",label:"OAuth Apps",emoji:"ðŸ“±"},{id:"jwt",label:"JWT Inspector",emoji:"ðŸ”"},{id:"config",label:"Config",emoji:"âš™ï¸"}],w=x.filter(s=>!(p!=="all"&&s.status!==p||m!=="all"&&s.appId!==m)),T=x.filter(s=>s.status==="active").length,S=x.filter(s=>s.status==="expired").length,I=x.filter(s=>s.status==="revoked").length,u=s=>{var a;return((a=o.find(l=>l.id===s))==null?void 0:a.name)??s},b={active:"bg-emerald-400/15 text-emerald-400 border-emerald-500/30",expired:"bg-zinc-700 text-zinc-400 border-zinc-600",revoked:"bg-rose-400/15 text-rose-400 border-rose-500/30"},c=s=>new Date(s).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Access Token Manager"}),e.jsx("p",{className:"text-zinc-400 text-sm mt-0.5",children:"Manage OAuth apps, access tokens, and JWT configuration"})]}),e.jsx("button",{className:"text-sm px-4 py-2 bg-indigo-500 text-white rounded hover:bg-indigo-600 transition-colors",children:"+ Register App"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[{label:"OAuth Apps",value:o.filter(s=>s.status==="active").length,color:"text-indigo-400"},{label:"Active Tokens",value:T,color:"text-emerald-400"},{label:"Expired",value:S,color:"text-zinc-400"},{label:"Revoked",value:I,color:"text-rose-400"}].map(s=>e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-xs text-zinc-400 mb-1",children:s.label}),e.jsx("div",{className:r("text-2xl font-bold",s.color),children:s.value})]},s.label))}),e.jsx("div",{className:"flex gap-1 mb-6 bg-zinc-900 p-1 rounded-lg border border-zinc-800 w-fit",children:k.map(s=>e.jsxs("button",{onClick:()=>g(s.id),className:r("px-4 py-2 text-sm rounded-md transition-colors",d===s.id?"bg-indigo-500 text-white":"text-zinc-400 hover:text-white hover:bg-zinc-800"),children:[s.emoji," ",s.label]},s.id))}),d==="tokens"&&e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsxs("div",{className:"col-span-3 space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:p,onChange:s=>N(s.target.value),className:"bg-zinc-800 border border-zinc-700 text-white text-xs rounded px-2 py-1.5 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"revoked",children:"Revoked"})]}),e.jsxs("select",{value:m,onChange:s=>y(s.target.value),className:"bg-zinc-800 border border-zinc-700 text-white text-xs rounded px-2 py-1.5 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Apps"}),o.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsx("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg overflow-hidden",children:w.map(s=>e.jsxs("button",{onClick:()=>j(s),className:r("w-full border-b border-zinc-800 last:border-b-0 p-4 text-left hover:bg-zinc-800/30 transition-colors",(t==null?void 0:t.id)===s.id&&"bg-zinc-800/50"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:r("text-xs px-2 py-0.5 rounded border",b[s.status]),children:s.status}),e.jsx("span",{className:"text-sm font-mono text-zinc-300 truncate max-w-[160px]",children:s.id})]}),e.jsx("span",{className:"text-xs text-zinc-500",children:c(s.issuedAt)})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-zinc-400",children:[e.jsx("span",{children:s.userEmail}),e.jsx("span",{children:"Â·"}),e.jsx("span",{children:u(s.appId)})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1.5",children:s.scopes.map(a=>e.jsx("span",{className:"text-xs bg-zinc-800 border border-zinc-700 text-zinc-400 px-1.5 py-0.5 rounded font-mono",children:a},a))})]},s.id))})]}),e.jsx("div",{className:"col-span-2",children:t?e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Token Detail"}),e.jsx("span",{className:r("text-xs px-2 py-0.5 rounded border",b[t.status]),children:t.status})]}),e.jsx("div",{className:"space-y-2 text-xs",children:[["Token ID",t.id],["User",t.userEmail],["App",u(t.appId)],["Issued",c(t.issuedAt)],["Expires",c(t.expiresAt)],["Last Used",c(t.lastUsed)],["IP",t.ipAddress],["User Agent",t.userAgent]].map(([s,a])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-zinc-500",children:s}),e.jsx("span",{className:"text-zinc-300 font-mono max-w-[60%] truncate text-right",children:a})]},s))}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1.5",children:"Scopes"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.scopes.map(s=>e.jsx("span",{className:"text-xs bg-zinc-800 border border-zinc-700 text-zinc-300 px-2 py-0.5 rounded font-mono",children:s},s))})]}),t.status==="active"&&e.jsx("button",{className:"w-full text-xs py-2 bg-rose-400/10 border border-rose-500/30 text-rose-300 rounded hover:bg-rose-400/20 transition-colors",children:"ðŸš« Revoke Token"})]}):e.jsx("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-8 text-center text-zinc-500 text-sm",children:"Select a token to inspect"})})]}),d==="apps"&&e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsx("div",{className:"col-span-2 space-y-3",children:o.map(s=>e.jsxs("button",{onClick:()=>v(s),className:r("w-full bg-zinc-900 border rounded-lg p-4 text-left hover:border-zinc-600 transition-colors",(i==null?void 0:i.id)===s.id?"border-indigo-500/50":"border-zinc-800"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:s.name}),s.status==="suspended"&&e.jsx("span",{className:"text-xs bg-rose-400/10 border border-rose-500/30 text-rose-400 px-1.5 py-0.5 rounded",children:"suspended"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:r("px-1.5 py-0.5 rounded border",h[s.type]),children:s.type}),e.jsx("span",{className:"text-zinc-500 font-mono",children:s.clientId})]}),e.jsxs("div",{className:"text-xs text-zinc-500 mt-1",children:[s.tokenCount.toLocaleString()," tokens Â· last used ",s.lastUsed]})]},s.id))}),e.jsx("div",{className:"col-span-3",children:i?e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-5 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-base font-semibold text-white",children:i.name}),e.jsx("span",{className:r("text-xs px-2 py-0.5 rounded border",h[i.type]),children:i.type})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[["Client ID",i.clientId],["Created",i.createdAt],["Last Used",i.lastUsed],["Tokens",i.tokenCount.toLocaleString()]].map(([s,a])=>e.jsxs("div",{className:"bg-zinc-800 rounded p-2",children:[e.jsx("div",{className:"text-zinc-500",children:s}),e.jsx("div",{className:"text-zinc-300 font-mono mt-0.5",children:a})]},s))}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-zinc-400 mb-2",children:"Allowed Scopes"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:E.map(s=>e.jsx("span",{className:r("text-xs px-2 py-0.5 rounded border font-mono",i.scopes.includes(s)?"bg-indigo-500/10 border-indigo-500/30 text-indigo-300":"bg-zinc-800 border-zinc-700 text-zinc-600"),children:s},s))})]}),i.redirectUris.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-zinc-400 mb-2",children:"Redirect URIs"}),e.jsx("div",{className:"space-y-1",children:i.redirectUris.map(s=>e.jsx("div",{className:"bg-zinc-800 rounded px-3 py-1.5 text-xs font-mono text-zinc-300",children:s},s))})]}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t border-zinc-800",children:[e.jsx("button",{className:"text-xs px-3 py-1.5 bg-indigo-500/20 border border-indigo-500/30 text-indigo-300 rounded hover:bg-indigo-500/30",children:"Edit App"}),e.jsx("button",{className:"text-xs px-3 py-1.5 bg-zinc-800 border border-zinc-700 text-zinc-400 rounded hover:bg-zinc-700",children:"Rotate Secret"}),i.status==="active"?e.jsx("button",{className:"text-xs px-3 py-1.5 bg-rose-400/10 border border-rose-500/30 text-rose-300 rounded hover:bg-rose-400/20",children:"Suspend"}):e.jsx("button",{className:"text-xs px-3 py-1.5 bg-emerald-400/10 border border-emerald-500/30 text-emerald-300 rounded hover:bg-emerald-400/20",children:"Reactivate"})]})]}):e.jsx("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-10 text-center text-zinc-500 text-sm",children:"Select an app to view details"})})]}),d==="jwt"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white mb-2",children:"Paste JWT Token"}),e.jsx("textarea",{value:f,onChange:s=>z(s.target.value),placeholder:"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",className:"w-full h-32 bg-zinc-900 border border-zinc-800 text-zinc-300 text-xs font-mono rounded p-3 resize-none focus:outline-none focus:border-indigo-500 placeholder:text-zinc-600"}),e.jsx("button",{onClick:()=>A(!0),className:"mt-2 w-full py-2 bg-indigo-500 text-white text-sm rounded hover:bg-indigo-600 transition-colors",children:"ðŸ” Decode JWT"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs text-zinc-400 mb-2",children:"Token format"}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded p-3 font-mono text-xs leading-relaxed",children:[e.jsx("span",{className:"text-rose-300",children:"header"}),".",e.jsx("span",{className:"text-indigo-300",children:"payload"}),".",e.jsx("span",{className:"text-emerald-300",children:"signature"})]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white mb-2",children:"Decoded Claims"}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex gap-2 px-4 py-2 border-b border-zinc-800 text-xs",children:[e.jsx("span",{className:"text-zinc-400",children:"Algorithm:"}),e.jsx("span",{className:"text-indigo-300 font-mono",children:"RS256"}),e.jsx("span",{className:"text-zinc-600 mx-1",children:"|"}),e.jsx("span",{className:"text-zinc-400",children:"Type:"}),e.jsx("span",{className:"text-indigo-300 font-mono",children:"JWT"})]}),e.jsx("div",{className:"divide-y divide-zinc-800 max-h-80 overflow-y-auto",children:U.map(s=>e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2",children:[e.jsx("span",{className:r("w-16 text-xs font-mono font-semibold flex-shrink-0",s.type==="standard"?"text-amber-300":"text-indigo-300"),children:s.key}),e.jsx("span",{className:"text-xs text-zinc-300 font-mono",children:s.value}),e.jsx("span",{className:r("ml-auto text-xs px-1.5 py-0.5 rounded flex-shrink-0",s.type==="standard"?"bg-amber-400/10 text-amber-400":"bg-indigo-500/10 text-indigo-300"),children:s.type})]},s.key))})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-emerald-400",children:[e.jsx("span",{children:"âœ“ Signature valid"}),e.jsx("span",{className:"text-zinc-600",children:"|"}),e.jsx("span",{children:"âœ“ Not expired"})]})]})]}),d==="config"&&e.jsxs("div",{className:"max-w-lg space-y-4",children:[[{label:"Token Expiry (access)",value:"3600",type:"number",unit:"seconds"},{label:"Token Expiry (refresh)",value:"2592000",type:"number",unit:"seconds"},{label:"Signing Algorithm",value:"RS256",type:"select",opts:["RS256","RS512","HS256","ES256"]},{label:"PKCE Required",value:"enabled",type:"select",opts:["enabled","disabled"]},{label:"Token Rotation",value:"enabled",type:"select",opts:["enabled","disabled"]},{label:"Max Tokens per User",value:"10",type:"number"},{label:"Issuer URL",value:"https://auth.corp.io",type:"text"},{label:"JWKS URI",value:"https://auth.corp.io/.well-known/jwks.json",type:"text"}].map(s=>{var a;return e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-zinc-400 mb-1.5",children:[s.label,s.unit?e.jsxs("span",{className:"text-zinc-500 ml-1",children:["(",s.unit,")"]}):""]}),s.type==="select"?e.jsx("select",{className:"w-full bg-zinc-800 border border-zinc-700 text-white text-sm rounded px-3 py-2 focus:outline-none",children:(a=s.opts)==null?void 0:a.map(l=>e.jsx("option",{selected:l===s.value,children:l},l))}):e.jsx("input",{type:s.type,defaultValue:s.value,className:"w-full bg-zinc-800 border border-zinc-700 text-white text-sm rounded px-3 py-2 focus:outline-none focus:border-indigo-500 font-mono"})]},s.label)}),e.jsx("button",{className:"px-4 py-2 bg-indigo-500 text-white text-sm rounded hover:bg-indigo-600 transition-colors",children:"Save Configuration"})]})]})}export{_ as default};
