import{r as n,j as e,c as p}from"./index-CaqN0wrg.js";const D=[{id:"agents:read",label:"Agents Read",group:"Agents",desc:"List and read agent configurations"},{id:"agents:write",label:"Agents Write",group:"Agents",desc:"Create, update, and delete agents"},{id:"sessions:read",label:"Sessions Read",group:"Sessions",desc:"View session history and logs"},{id:"sessions:write",label:"Sessions Write",group:"Sessions",desc:"Create and terminate sessions"},{id:"models:read",label:"Models Read",group:"Models",desc:"List available models and pricing"},{id:"nodes:read",label:"Nodes Read",group:"Nodes",desc:"View paired nodes and status"},{id:"nodes:write",label:"Nodes Write",group:"Nodes",desc:"Pair, configure, and remove nodes"},{id:"cron:read",label:"Cron Read",group:"Cron",desc:"List scheduled jobs"},{id:"cron:write",label:"Cron Write",group:"Cron",desc:"Create, update, and delete cron jobs"},{id:"files:read",label:"Files Read",group:"Files",desc:"Read workspace file contents"},{id:"files:write",label:"Files Write",group:"Files",desc:"Write and delete workspace files"},{id:"admin",label:"Admin",group:"Admin",desc:"Full administrative access â€” use sparingly"}],E=["agent.created","agent.updated","agent.deleted","session.started","session.ended","session.error","cron.fired","cron.failed","node.paired","node.disconnected","model.usage","billing.threshold"];function y(t){return Array.from({length:t},()=>Math.floor(Math.random()*16).toString(16)).join("")}function M(t){const x=["active","active","active","revoked","expired"],c=[["agents:read","agents:write","sessions:read"],["models:read","nodes:read","files:read"],["admin"],["agents:read","cron:read","cron:write"],["sessions:read","sessions:write","files:read","files:write"]],u=["Production Key","CI/CD Pipeline","Admin Backdoor","Monitoring Bot","Dev Integration"],o=["104.21.8.1","185.220.101.9","31.13.72.36","192.168.1.100",null],m=new Date,l=new Date(m.getTime()-(t+1)*14*24*36e5),v=t===2?null:new Date(m.getTime()+(4-t)*90*24*36e5);return{id:`key_${y(8)}`,name:u[t%u.length],prefix:`oc_sk_${y(6)}`,scopes:c[t%c.length],status:x[t%x.length],createdAt:l,expiresAt:v,lastUsedAt:t<3?new Date(m.getTime()-t*2*36e5):null,lastUsedIp:o[t%o.length],usageCount:[4812,291,18403,0,1043][t%5]}}function P(t){const x=["Slack Alert Relay","GitHub CI Trigger","PagerDuty Escalation","Analytics Sink"],c=["https://hooks.slack.com/services/T0.../B0.../xxx","https://api.github.com/repos/dgarson/clawdbot/dispatches","https://events.pagerduty.com/v2/enqueue","https://ingest.segment.io/v1/track"],u=[["session.error","cron.failed","node.disconnected"],["agent.created","agent.updated","cron.fired"],["session.error","model.usage","billing.threshold"],["agent.created","session.started","session.ended","cron.fired","model.usage"]],o=["active","active","failing","paused"],m=new Date;return{id:`wh_${y(8)}`,name:x[t%x.length],url:c[t%c.length],events:u[t%u.length],status:o[t%o.length],secret:`whsec_${y(24)}`,lastFiredAt:t<3?new Date(m.getTime()-t*5*36e5):null,successRate:[99.4,100,62.1,0][t%4],totalDeliveries:[2341,88,417,0][t%4]}}const L=Array.from({length:5},(t,x)=>M(x)),_=Array.from({length:4},(t,x)=>P(x));function I(t){if(!t)return"never";const x=Date.now()-t.getTime(),c=Math.floor(x/1e3);if(c<60)return`${c}s ago`;const u=Math.floor(c/60);if(u<60)return`${u}m ago`;const o=Math.floor(u/60);return o<24?`${o}h ago`:`${Math.floor(o/24)}d ago`}function T(t){return t?t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Never"}function K(t){return{active:"bg-emerald-500/15 text-emerald-400 border border-emerald-500/30",revoked:"bg-red-500/15 text-red-400 border border-red-500/30",expired:"bg-amber-500/15 text-amber-400 border border-amber-500/30"}[t]}function W(t){return{active:"bg-emerald-500/15 text-emerald-400 border border-emerald-500/30",paused:"bg-zinc-500/15 text-zinc-400 border border-zinc-500/30",failing:"bg-red-500/15 text-red-400 border border-red-500/30"}[t]}function A({text:t,label:x}){const[c,u]=n.useState(!1),o=n.useCallback(async()=>{try{await navigator.clipboard.writeText(t),u(!0),setTimeout(()=>u(!1),1800)}catch{u(!1)}},[t]);return e.jsx("button",{type:"button",onClick:o,"aria-label":`Copy ${x??"value"}`,className:"ml-1.5 px-2 py-0.5 rounded text-xs text-muted-foreground hover:text-foreground hover:bg-white/5 border border-white/10 transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:c?"âœ“ copied":"copy"})}function $({onClose:t,onCreated:x}){const[c,u]=n.useState(""),[o,m]=n.useState(new Set(["agents:read"])),[l,v]=n.useState("90"),[s,j]=n.useState("form"),[w,d]=n.useState(""),[g,N]=n.useState(null),k=n.useRef(null);n.useEffect(()=>{var a;(a=k.current)==null||a.focus()},[]);const C=a=>{m(f=>{const i=new Set(f);return i.has(a)?i.delete(a):i.add(a),i})},r=()=>{if(!c.trim()||o.size===0)return;const a=`oc_sk_${y(32)}`,f=new Date;let i=null;l!=="never"&&(i=new Date(f.getTime()+parseInt(l)*24*36e5));const h={id:`key_${y(8)}`,name:c.trim(),prefix:a.slice(0,14),scopes:Array.from(o),status:"active",createdAt:f,expiresAt:i,lastUsedAt:null,lastUsedIp:null,usageCount:0};d(a),N(h),j("reveal"),x(h,a)},S=Array.from(new Set(D.map(a=>a.group)));return e.jsx("div",{role:"dialog","aria-modal":"true","aria-label":"Create API Key",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:a=>{a.target===a.currentTarget&&t()},children:e.jsxs("div",{className:"w-full max-w-lg bg-zinc-900 border border-white/10 rounded-xl shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/10",children:[e.jsx("h2",{className:"font-semibold text-base",children:s==="form"?"Create API Key":"Key Created â€” Copy Now"}),e.jsx("button",{type:"button",onClick:t,"aria-label":"Close modal",className:"p-1 rounded hover:bg-white/10 text-muted-foreground hover:text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:"âœ•"})]}),s==="form"?e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"key-name",className:"block text-sm font-medium mb-1.5",children:["Key Name ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{id:"key-name",ref:k,type:"text",value:c,onChange:a=>u(a.target.value),placeholder:"e.g. Production Bot",className:"w-full bg-black/40 border border-white/10 rounded-lg px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm font-medium mb-1.5",children:"Expiration"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:["30","90","365","never"].map(a=>e.jsx("button",{type:"button",onClick:()=>v(a),className:p("px-3 py-1.5 rounded-lg text-xs font-medium border transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",l===a?"bg-violet-600 border-violet-500 text-white":"bg-white/5 border-white/10 text-muted-foreground hover:text-foreground hover:bg-white/10"),children:a==="never"?"No Expiry":`${a} days`},a))})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-sm font-medium mb-2",children:["Scopes ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("div",{className:"space-y-3 max-h-52 overflow-y-auto pr-1",children:S.map(a=>e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase tracking-widest text-muted-foreground/60 mb-1.5",children:a}),e.jsx("div",{className:"space-y-1",children:D.filter(f=>f.group===a).map(f=>e.jsxs("label",{className:p("flex items-start gap-3 px-3 py-2 rounded-lg cursor-pointer border transition-all",o.has(f.id)?"bg-violet-500/10 border-violet-500/30":"bg-white/5 border-white/5 hover:bg-white/8 hover:border-white/10"),children:[e.jsx("input",{type:"checkbox",checked:o.has(f.id),onChange:()=>C(f.id),className:"mt-0.5 accent-violet-500 shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:p("text-xs font-mono font-medium",o.has(f.id)?"text-violet-300":"text-foreground"),children:f.id}),e.jsx("p",{className:"text-xs text-muted-foreground",children:f.desc})]})]},f.id))})]},a))})]}),o.has("admin")&&e.jsxs("div",{className:"flex gap-2 bg-amber-500/10 border border-amber-500/30 rounded-lg px-3 py-2",children:[e.jsx("span",{className:"text-amber-400 shrink-0",children:"âš "}),e.jsx("p",{className:"text-xs text-amber-300",children:"Admin scope grants full access. Only use for trusted internal automation."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-1",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 text-muted-foreground hover:text-foreground transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:"Cancel"}),e.jsx("button",{type:"button",onClick:r,disabled:!c.trim()||o.size===0,className:"px-4 py-2 text-sm rounded-lg bg-violet-600 hover:bg-violet-500 text-white font-medium transition-all disabled:opacity-40 disabled:cursor-not-allowed focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:"Generate Key"})]})]}):e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg px-4 py-3",children:[e.jsx("p",{className:"text-sm font-semibold text-amber-300 mb-1",children:"âš  Copy this key now"}),e.jsx("p",{className:"text-xs text-amber-200/80",children:"This is the only time you'll see the full key. We don't store it."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1.5 font-medium",children:"Your new API key"}),e.jsxs("div",{className:"flex items-center bg-black/60 border border-white/10 rounded-lg px-3 py-2.5",children:[e.jsx("code",{className:"text-xs font-mono text-emerald-300 break-all flex-1",children:w}),e.jsx(A,{text:w,label:"API key"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs text-muted-foreground",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground mb-0.5",children:"Name"}),e.jsx("p",{children:g==null?void 0:g.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground mb-0.5",children:"Scopes"}),e.jsxs("p",{children:[g==null?void 0:g.scopes.length," assigned"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground mb-0.5",children:"Expires"}),e.jsx("p",{children:T((g==null?void 0:g.expiresAt)??null)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground mb-0.5",children:"Status"}),e.jsx("p",{className:"text-emerald-400",children:"Active"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm rounded-lg bg-violet-600 hover:bg-violet-500 text-white font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:"Done"})})]})]})})}function z({onClose:t,onCreated:x}){const[c,u]=n.useState(""),[o,m]=n.useState(""),[l,v]=n.useState(new Set(["session.error","cron.failed"])),s=n.useRef(null);n.useEffect(()=>{var d;(d=s.current)==null||d.focus()},[]);const j=d=>{v(g=>{const N=new Set(g);return N.has(d)?N.delete(d):N.add(d),N})},w=()=>{if(!c.trim()||!o.trim()||l.size===0)return;const d={id:`wh_${y(8)}`,name:c.trim(),url:o.trim(),events:Array.from(l),status:"active",secret:`whsec_${y(24)}`,lastFiredAt:null,successRate:100,totalDeliveries:0};x(d),t()};return e.jsx("div",{role:"dialog","aria-modal":"true","aria-label":"Create Webhook",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:d=>{d.target===d.currentTarget&&t()},children:e.jsxs("div",{className:"w-full max-w-lg bg-zinc-900 border border-white/10 rounded-xl shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/10",children:[e.jsx("h2",{className:"font-semibold text-base",children:"Create Webhook"}),e.jsx("button",{type:"button",onClick:t,"aria-label":"Close modal",className:"p-1 rounded hover:bg-white/10 text-muted-foreground hover:text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:"âœ•"})]}),e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"wh-name",className:"block text-sm font-medium mb-1.5",children:["Name ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{id:"wh-name",ref:s,type:"text",value:c,onChange:d=>u(d.target.value),placeholder:"e.g. Slack Alerts",className:"w-full bg-black/40 border border-white/10 rounded-lg px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-violet-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"wh-url",className:"block text-sm font-medium mb-1.5",children:["Endpoint URL ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{id:"wh-url",type:"url",value:o,onChange:d=>m(d.target.value),placeholder:"https://your-server.com/webhooks/openclaw",className:"w-full bg-black/40 border border-white/10 rounded-lg px-3 py-2 text-sm font-mono placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-violet-500"})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-sm font-medium mb-2",children:["Events ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:E.map(d=>e.jsx("button",{type:"button",onClick:()=>j(d),"aria-pressed":l.has(d),className:p("px-2.5 py-1 rounded text-xs font-mono border transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",l.has(d)?"bg-violet-600 border-violet-500 text-white":"bg-white/5 border-white/10 text-muted-foreground hover:text-foreground hover:bg-white/10"),children:d},d))})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-1",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 text-muted-foreground hover:text-foreground transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:"Cancel"}),e.jsx("button",{type:"button",onClick:w,disabled:!c.trim()||!o.trim()||l.size===0,className:"px-4 py-2 text-sm rounded-lg bg-violet-600 hover:bg-violet-500 text-white font-medium transition-all disabled:opacity-40 disabled:cursor-not-allowed focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:"Create Webhook"})]})]})]})})}function U({keys:t,onRevoke:x,onDelete:c,onRotate:u,onCreate:o,revealedKeys:m}){var C;const[l,v]=n.useState(((C=t[0])==null?void 0:C.id)??null),s=t.find(r=>r.id===l)??null,[j,w]=n.useState("all"),[d,g]=n.useState(""),N=t.filter(r=>!(j!=="all"&&r.status!==j||d&&!r.name.toLowerCase().includes(d.toLowerCase()))),k={active:t.filter(r=>r.status==="active").length,revoked:t.filter(r=>r.status==="revoked").length,expired:t.filter(r=>r.status==="expired").length};return e.jsxs("div",{className:"flex gap-4 h-[calc(100vh-240px)] min-h-0",children:[e.jsxs("div",{className:"w-80 shrink-0 flex flex-col gap-3",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["active","revoked","expired"].map(r=>e.jsxs("button",{type:"button",onClick:()=>w(j===r?"all":r),"aria-pressed":j===r,className:p("rounded-lg p-2 text-center border transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",j===r?"bg-violet-600/20 border-violet-500/50":"bg-white/5 border-white/10 hover:bg-white/8"),children:[e.jsx("p",{className:"text-lg font-bold",children:k[r]}),e.jsx("p",{className:"text-[10px] text-muted-foreground capitalize",children:r})]},r))}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground text-xs",children:"ðŸ”"}),e.jsx("input",{type:"search",value:d,onChange:r=>g(r.target.value),placeholder:"Search keysâ€¦","aria-label":"Search API keys",className:"w-full bg-black/40 border border-white/10 rounded-lg pl-8 pr-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-violet-500"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-1.5 pr-0.5",role:"listbox","aria-label":"API Keys",children:N.length===0?e.jsx("div",{className:"text-center py-10 text-sm text-muted-foreground",children:"No keys match filter."}):N.map(r=>e.jsxs("button",{type:"button",role:"option","aria-selected":l===r.id,onClick:()=>v(r.id),className:p("w-full text-left px-3 py-3 rounded-xl border transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",l===r.id?"bg-violet-600/15 border-violet-500/40":"bg-white/4 border-white/8 hover:bg-white/7 hover:border-white/12"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium truncate",children:r.name}),e.jsx("span",{className:p("text-[10px] font-medium px-1.5 py-0.5 rounded-full capitalize shrink-0 ml-2",K(r.status)),children:r.status})]}),e.jsxs("p",{className:"text-xs font-mono text-muted-foreground",children:[r.prefix,"â€¢â€¢â€¢"]}),e.jsxs("p",{className:"text-[11px] text-muted-foreground/60 mt-1",children:["Used ",I(r.lastUsedAt)," Â· ",r.usageCount.toLocaleString()," calls"]})]},r.id))}),e.jsxs("button",{type:"button",onClick:o,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl bg-violet-600 hover:bg-violet-500 text-white text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:[e.jsx("span",{"aria-hidden":!0,children:"+"})," Generate New Key"]})]}),e.jsx("div",{className:"flex-1 min-w-0 overflow-y-auto",children:s?e.jsxs("div",{className:"bg-white/4 border border-white/10 rounded-xl p-5 space-y-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 font-mono",children:s.id})]}),e.jsx("span",{className:p("text-xs font-medium px-2 py-1 rounded-full capitalize shrink-0",K(s.status)),children:s.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1.5",children:"Key (masked)"}),e.jsxs("div",{className:"flex items-center bg-black/40 border border-white/10 rounded-lg px-3 py-2",children:[m[s.id]?e.jsx("code",{className:"text-xs font-mono text-emerald-300 break-all flex-1",children:m[s.id]}):e.jsxs("code",{className:"text-xs font-mono text-foreground flex-1",children:[s.prefix,"â€¢".repeat(28)]}),m[s.id]&&e.jsx(A,{text:m[s.id],label:"API key"})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{label:"Created",value:T(s.createdAt)},{label:"Expires",value:T(s.expiresAt)},{label:"Last Used",value:I(s.lastUsedAt)},{label:"Last IP",value:s.lastUsedIp??"â€”"},{label:"Total Calls",value:s.usageCount.toLocaleString()},{label:"Scopes",value:`${s.scopes.length} assigned`}].map(r=>e.jsxs("div",{className:"bg-black/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wider text-muted-foreground/60 mb-0.5",children:r.label}),e.jsx("p",{className:"text-sm font-medium",children:r.value})]},r.label))}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Scopes"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:s.scopes.map(r=>e.jsx("span",{className:p("px-2 py-0.5 rounded text-xs font-mono border",r==="admin"?"bg-red-500/15 text-red-300 border-red-500/30":"bg-violet-500/10 text-violet-300 border-violet-500/20"),children:r},r))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Last 7 Days Activity"}),e.jsx("div",{className:"flex items-end gap-1 h-10",children:Array.from({length:28},(r,S)=>{const a=Math.max(2,Math.floor(Math.random()*40));return e.jsx("div",{style:{height:`${a}px`},className:"flex-1 bg-violet-500/30 rounded-t hover:bg-violet-500/60 transition-colors",title:`${Math.floor(Math.random()*100)} calls`},S)})}),e.jsxs("div",{className:"flex justify-between text-[10px] text-muted-foreground/60 mt-1",children:[e.jsx("span",{children:"7 days ago"}),e.jsx("span",{children:"Today"})]})]}),s.status==="active"&&e.jsxs("div",{className:"flex gap-2 pt-1",children:[e.jsx("button",{type:"button",onClick:()=>u(s.id),className:"flex-1 px-3 py-2 rounded-lg text-sm bg-white/5 hover:bg-white/10 border border-white/10 text-muted-foreground hover:text-foreground transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:"ðŸ”„ Rotate"}),e.jsx("button",{type:"button",onClick:()=>x(s.id),className:"flex-1 px-3 py-2 rounded-lg text-sm bg-amber-500/10 hover:bg-amber-500/15 border border-amber-500/30 text-amber-300 hover:text-amber-200 transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:"ðŸš« Revoke"}),e.jsx("button",{type:"button",onClick:()=>c(s.id),className:"px-3 py-2 rounded-lg text-sm bg-red-500/10 hover:bg-red-500/15 border border-red-500/30 text-red-400 hover:text-red-300 transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:"ðŸ—‘"})]}),s.status!=="active"&&e.jsx("button",{type:"button",onClick:()=>c(s.id),className:"w-full px-3 py-2 rounded-lg text-sm bg-red-500/10 hover:bg-red-500/15 border border-red-500/30 text-red-400 hover:text-red-300 transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:"ðŸ—‘ Delete Key"})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground text-sm",children:"Select a key to view details."})})]})}function F({webhooks:t,onDelete:x,onToggle:c,onCreate:u}){var v;const[o,m]=n.useState(((v=t[0])==null?void 0:v.id)??null),l=t.find(s=>s.id===o)??null;return e.jsxs("div",{className:"flex gap-4 h-[calc(100vh-240px)] min-h-0",children:[e.jsxs("div",{className:"w-80 shrink-0 flex flex-col gap-3",children:[e.jsx("div",{className:"flex-1 overflow-y-auto space-y-1.5",role:"listbox","aria-label":"Webhooks",children:t.length===0?e.jsx("div",{className:"text-center py-10 text-sm text-muted-foreground",children:"No webhooks yet."}):t.map(s=>e.jsxs("button",{type:"button",role:"option","aria-selected":o===s.id,onClick:()=>m(s.id),className:p("w-full text-left px-3 py-3 rounded-xl border transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",o===s.id?"bg-violet-600/15 border-violet-500/40":"bg-white/4 border-white/8 hover:bg-white/7 hover:border-white/12"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium truncate",children:s.name}),e.jsx("span",{className:p("text-[10px] font-medium px-1.5 py-0.5 rounded-full capitalize shrink-0 ml-2",W(s.status)),children:s.status})]}),e.jsx("p",{className:"text-xs font-mono text-muted-foreground truncate",children:s.url}),e.jsxs("div",{className:"flex gap-3 mt-1.5 text-[11px] text-muted-foreground/70",children:[e.jsxs("span",{children:["âœ‰ ",s.totalDeliveries.toLocaleString()]}),e.jsxs("span",{children:["âœ“ ",s.successRate,"%"]}),e.jsxs("span",{children:[s.events.length," events"]})]})]},s.id))}),e.jsxs("button",{type:"button",onClick:u,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl bg-violet-600 hover:bg-violet-500 text-white text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:[e.jsx("span",{"aria-hidden":!0,children:"+"})," Add Webhook"]})]}),e.jsx("div",{className:"flex-1 min-w-0 overflow-y-auto",children:l?e.jsxs("div",{className:"bg-white/4 border border-white/10 rounded-xl p-5 space-y-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:l.name}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 font-mono",children:l.id})]}),e.jsx("span",{className:p("text-xs font-medium px-2 py-1 rounded-full capitalize shrink-0",W(l.status)),children:l.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1.5",children:"Endpoint URL"}),e.jsxs("div",{className:"flex items-center bg-black/40 border border-white/10 rounded-lg px-3 py-2",children:[e.jsx("code",{className:"text-xs font-mono text-foreground break-all flex-1",children:l.url}),e.jsx(A,{text:l.url,label:"webhook URL"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1.5",children:"Signing Secret"}),e.jsxs("div",{className:"flex items-center bg-black/40 border border-white/10 rounded-lg px-3 py-2",children:[e.jsx("code",{className:"text-xs font-mono text-muted-foreground flex-1",children:"â€¢".repeat(32)}),e.jsx(A,{text:l.secret,label:"signing secret"})]}),e.jsx("p",{className:"text-[11px] text-muted-foreground/60 mt-1",children:"Validate webhook payloads using HMAC-SHA256 with this secret."})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{label:"Total Deliveries",value:l.totalDeliveries.toLocaleString()},{label:"Success Rate",value:`${l.successRate}%`},{label:"Last Fired",value:I(l.lastFiredAt)}].map(s=>e.jsxs("div",{className:"bg-black/30 rounded-lg p-3 text-center",children:[e.jsx("p",{className:p("text-lg font-bold",s.label==="Success Rate"&&l.successRate<80?"text-red-400":""),children:s.value}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:s.label})]},s.label))}),l.status==="failing"&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg px-4 py-3",children:[e.jsx("p",{className:"text-sm font-semibold text-red-400 mb-0.5",children:"âš  Delivery Failures Detected"}),e.jsx("p",{className:"text-xs text-red-300/80",children:"More than 20% of recent deliveries failed. Check your endpoint is reachable and returning 2xx."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Subscribed Events"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:l.events.map(s=>e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-mono bg-violet-500/10 text-violet-300 border border-violet-500/20",children:s},s))})]}),e.jsxs("div",{className:"flex gap-2 pt-1",children:[e.jsx("button",{type:"button",onClick:()=>c(l.id),className:"flex-1 px-3 py-2 rounded-lg text-sm bg-white/5 hover:bg-white/10 border border-white/10 text-muted-foreground hover:text-foreground transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:l.status==="active"?"â¸ Pause":"â–¶ Resume"}),e.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded-lg text-sm bg-white/5 hover:bg-white/10 border border-white/10 text-muted-foreground hover:text-foreground transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:"ðŸ“¤ Send Test"}),e.jsx("button",{type:"button",onClick:()=>x(l.id),className:"px-3 py-2 rounded-lg text-sm bg-red-500/10 hover:bg-red-500/15 border border-red-500/30 text-red-400 hover:text-red-300 transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",children:"ðŸ—‘"})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground text-sm",children:"Select a webhook to view details."})})]})}function H(){const[t,x]=n.useState("api-keys"),[c,u]=n.useState(L),[o,m]=n.useState(_),[l,v]=n.useState(!1),[s,j]=n.useState(!1),[w,d]=n.useState({}),g=n.useCallback(i=>{u(h=>h.map(b=>b.id===i?{...b,status:"revoked"}:b))},[]),N=n.useCallback(i=>{u(h=>h.filter(b=>b.id!==i))},[]),k=n.useCallback(i=>{const h=`oc_sk_${y(32)}`;u(b=>b.map(R=>R.id===i?{...R,prefix:h.slice(0,14),lastUsedAt:null,usageCount:0}:R)),d(b=>({...b,[i]:h}))},[]),C=n.useCallback((i,h)=>{u(b=>[i,...b]),d(b=>({...b,[i.id]:h}))},[]),r=n.useCallback(i=>{m(h=>h.filter(b=>b.id!==i))},[]),S=n.useCallback(i=>{m(h=>h.map(b=>b.id===i?{...b,status:b.status==="active"?"paused":"active"}:b))},[]),a=n.useCallback(i=>{m(h=>[i,...h])},[]),f=[{id:"api-keys",label:"API Keys",count:c.filter(i=>i.status==="active").length},{id:"webhooks",label:"Webhooks",count:o.filter(i=>i.status==="active").length}];return e.jsxs("div",{className:"h-full flex flex-col gap-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"API & Integrations"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5",children:"Manage API keys, signing secrets, and webhook endpoints."})]}),e.jsx("a",{href:"https://docs.openclaw.ai/api",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-violet-400 hover:text-violet-300 underline underline-offset-2 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500 rounded",children:"API Reference â†—"})]}),e.jsxs("div",{className:"flex items-start gap-3 bg-amber-500/8 border border-amber-500/20 rounded-xl px-4 py-3",children:[e.jsx("span",{className:"text-amber-400 text-sm shrink-0 mt-0.5",children:"ðŸ”"}),e.jsxs("div",{className:"text-xs text-amber-200/80",children:[e.jsx("span",{className:"font-semibold text-amber-300",children:"Keep your keys secret."})," ","Never commit API keys to source control. Rotate keys that may have been exposed. Revoked keys stop working immediately."]})]}),e.jsx("div",{className:"flex gap-1 p-1 bg-white/5 rounded-xl w-fit border border-white/10",role:"tablist",children:f.map(i=>e.jsxs("button",{type:"button",role:"tab","aria-selected":t===i.id,onClick:()=>x(i.id),className:p("flex items-center gap-2 px-4 py-1.5 rounded-lg text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-500",t===i.id?"bg-violet-600 text-white shadow":"text-muted-foreground hover:text-foreground hover:bg-white/5"),children:[i.label,e.jsx("span",{className:p("text-[10px] font-semibold px-1.5 py-0.5 rounded-full",t===i.id?"bg-white/20 text-white":"bg-white/10 text-muted-foreground"),children:i.count})]},i.id))}),e.jsx("div",{className:"flex-1 min-h-0",children:t==="api-keys"?e.jsx(U,{keys:c,onRevoke:g,onDelete:N,onRotate:k,onCreate:()=>v(!0),revealedKeys:w}):e.jsx(F,{webhooks:o,onDelete:r,onToggle:S,onCreate:()=>j(!0)})}),l&&e.jsx($,{onClose:()=>v(!1),onCreated:C}),s&&e.jsx(z,{onClose:()=>j(!1),onCreated:a})]})}export{H as default};
