import{r as l,j as e,c as x}from"./index-D2H6hWpW.js";const T=new Date,o=s=>new Date(T.getTime()-s),m=s=>s*60*1e3,d=s=>s*60*m(1),D=[{id:"evt-001",timestamp:o(m(2)),severity:"info",category:"cron",actor:"system",actorKind:"system",action:"cron.job.execute",resource:"cron:ux-work-check",result:"success",duration:14200,detail:"Hourly UX Work Check (Luis) completed. 19 views shipped.",meta:{jobId:"e61f3c46",runtime:"14.2s"}},{id:"evt-002",timestamp:o(m(8)),severity:"info",category:"session",actor:"agent:luis",actorKind:"agent",action:"session.spawn",resource:"session:agent:piper:subagent:d7c8e57e",result:"success",duration:312,detail:"Luis spawned Piper sub-agent for TeamManagement view.",meta:{label:"horizon-team-management",model:"claude-sonnet-4-6"}},{id:"evt-003",timestamp:o(m(15)),severity:"success",category:"agent",actor:"agent:luis",actorKind:"agent",action:"agent.file.write",resource:"file:src/views/ApiKeysManager.tsx",result:"success",duration:890,detail:"ApiKeysManager.tsx created â€” 30.88 kB, âœ“ 0 TS errors.",meta:{size:"30.88 kB",gzip:"6.98 kB"}},{id:"evt-004",timestamp:o(m(22)),severity:"info",category:"api",actor:"api:oc_sk_prod_7f2a",actorKind:"api",action:"api.agents.list",resource:"agents:*",result:"success",duration:45,ip:"203.0.113.12",detail:"API key oc_sk_prod_7f2a listed all agents (14 returned).",meta:{count:"14",keyName:"CI Pipeline"}},{id:"evt-005",timestamp:o(m(34)),severity:"warning",category:"api",actor:"api:oc_sk_dev_3a9b",actorKind:"api",action:"api.sessions.write",resource:"session:new",result:"failure",duration:12,ip:"192.168.1.44",detail:"Scope violation: key oc_sk_dev_3a9b lacks sessions:write permission.",meta:{scope:"sessions:write",keyName:"Dev Local"}},{id:"evt-006",timestamp:o(d(1)),severity:"info",category:"auth",actor:"user:david",actorKind:"user",action:"auth.login",resource:"user:david",result:"success",duration:230,ip:"10.0.1.5",detail:"David signed in via browser session.",meta:{method:"session-token",browser:"Safari/19"}},{id:"evt-007",timestamp:o(d(1)+m(10)),severity:"error",category:"cron",actor:"system",actorKind:"system",action:"cron.job.execute",resource:"cron:data-sync",result:"failure",duration:30012,detail:"Cron job data-sync timed out after 30s. Will retry at next interval.",meta:{jobId:"a3b4c5d6",timeout:"30s",retryAt:"02:15 AM"}},{id:"evt-008",timestamp:o(d(1)+m(25)),severity:"info",category:"node",actor:"user:david",actorKind:"user",action:"node.pair",resource:"node:david-iphone",result:"success",duration:1840,detail:"David paired iPhone 15 Pro (node: david-iphone).",meta:{os:"iOS 18.3",platform:"arm64"}},{id:"evt-009",timestamp:o(d(2)),severity:"info",category:"agent",actor:"user:david",actorKind:"user",action:"agent.config.update",resource:"agent:xavier",result:"success",duration:340,ip:"10.0.1.5",detail:"Xavier agent config updated â€” model changed to claude-opus-4-6.",meta:{field:"model",from:"claude-sonnet-4-6",to:"claude-opus-4-6"}},{id:"evt-010",timestamp:o(d(2)+m(15)),severity:"warning",category:"billing",actor:"system",actorKind:"system",action:"billing.budget.alert",resource:"budget:daily-tokens",result:"partial",detail:"Daily token budget at 87% â€” claude-opus-4-6. Estimated cap at ~3 AM.",meta:{model:"claude-opus-4-6",used:"87%",estimate:"3:00 AM"}},{id:"evt-011",timestamp:o(d(3)),severity:"info",category:"file",actor:"agent:luis",actorKind:"agent",action:"file.read",resource:"file:CONTEXT.md",result:"success",duration:8,detail:"Luis read CONTEXT.md during session start.",meta:{size:"12.3 kB"}},{id:"evt-012",timestamp:o(d(4)),severity:"error",category:"auth",actor:"api:oc_sk_unknown",actorKind:"api",action:"auth.token.validate",resource:"api:gateway",result:"failure",duration:3,ip:"198.51.100.44",detail:"Invalid API token presented â€” key not found. Possible credential leak or brute force.",meta:{ip:"198.51.100.44",attempts:"3"}},{id:"evt-013",timestamp:o(d(5)),severity:"info",category:"session",actor:"agent:stephan",actorKind:"agent",action:"session.create",resource:"session:stephan:cron:brand-review",result:"success",duration:280,detail:"Stephan started brand review cron session.",meta:{kind:"cron",model:"claude-sonnet-4-6"}},{id:"evt-014",timestamp:o(d(6)),severity:"success",category:"system",actor:"system",actorKind:"system",action:"system.gateway.restart",resource:"gateway:main",result:"success",duration:4200,detail:"Gateway restarted cleanly. All services healthy. Uptime reset.",meta:{version:"2.4.1",pid:"8842"}},{id:"evt-015",timestamp:o(d(8)),severity:"info",category:"agent",actor:"user:david",actorKind:"user",action:"agent.create",resource:"agent:sam",result:"success",duration:510,ip:"10.0.1.5",detail:"Sam agent created. Role: Worker â€” Product & UI Squad.",meta:{role:"worker",squad:"product-ui"}}],w={info:{label:"Info",dot:"bg-indigo-500",badge:"bg-indigo-500/15 text-indigo-300 ring-indigo-500/25",text:"text-indigo-300"},success:{label:"Success",dot:"bg-emerald-500",badge:"bg-emerald-500/15 text-emerald-300 ring-emerald-500/25",text:"text-emerald-300"},warning:{label:"Warning",dot:"bg-amber-500",badge:"bg-amber-500/15 text-amber-300 ring-amber-500/25",text:"text-amber-300"},error:{label:"Error",dot:"bg-rose-500",badge:"bg-rose-500/15 text-rose-300 ring-rose-500/25",text:"text-rose-300"}},z={auth:"Auth",agent:"Agent",session:"Session",cron:"Cron",api:"API",file:"File",node:"Node",billing:"Billing",system:"System"},E={agent:{label:"Agent",color:"text-indigo-300"},user:{label:"User",color:"text-emerald-300"},system:{label:"System",color:"text-zinc-400"},api:{label:"API",color:"text-amber-300"}},K={success:{label:"Success",color:"text-emerald-400"},failure:{label:"Failure",color:"text-rose-400"},partial:{label:"Partial",color:"text-amber-400"}};function M(s){return s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}function P(s){return s.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}function O(s){const a=Date.now()-s.getTime();return a<6e4?`${Math.floor(a/1e3)}s ago`:a<36e5?`${Math.floor(a/6e4)}m ago`:`${Math.floor(a/36e5)}h ago`}function B(s){const a=["id","timestamp","severity","category","actor","actorKind","action","resource","result","duration_ms","ip","detail"].join(","),p=s.map(r=>[r.id,r.timestamp.toISOString(),r.severity,r.category,r.actor,r.actorKind,r.action,r.resource,r.result,r.duration??"",r.ip??"",`"${r.detail.replace(/"/g,'""')}"`].join(",")),u=[a,...p].join(`
`),f=new Blob([u],{type:"text/csv"}),i=URL.createObjectURL(f),c=document.createElement("a");c.href=i,c.download=`audit-log-${new Date().toISOString().slice(0,10)}.csv`,c.click(),URL.revokeObjectURL(i)}function U({severity:s}){const a=w[s];return e.jsxs("span",{className:x("inline-flex items-center gap-1.5 px-2 py-0.5 text-xs font-medium rounded-full ring-1",a.badge),children:[e.jsx("span",{className:x("h-1.5 w-1.5 rounded-full",a.dot)}),a.label]})}function I({category:s}){return e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 text-xs font-mono font-medium rounded bg-zinc-800 text-zinc-300 border border-zinc-700",children:z[s]})}function W({event:s,onClose:a}){const p=l.useRef(null);l.useEffect(()=>{var c;(c=p.current)==null||c.focus();const i=r=>{r.key==="Escape"&&a()};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[a]),w[s.severity];const u=E[s.actorKind],f=K[s.result];return e.jsxs("div",{className:"flex flex-col h-full bg-zinc-900 border-l border-zinc-800",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 px-5 py-4 border-b border-zinc-800",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(U,{severity:s.severity}),e.jsx(I,{category:s.category})]}),e.jsx("p",{className:"mt-2 text-sm font-semibold text-white leading-snug",children:s.detail}),e.jsx("p",{className:"mt-1 text-xs text-zinc-500 font-mono",children:s.action})]}),e.jsx("button",{ref:p,onClick:a,"aria-label":"Close detail panel",className:"flex-none p-1.5 rounded-md text-zinc-400 hover:text-white hover:bg-zinc-800 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 transition-colors",children:e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",d:"M4 4l8 8M12 4l-8 8"})})})]}),e.jsxs("div",{className:"px-5 py-4 border-b border-zinc-800",children:[e.jsx("h3",{className:"text-xs font-semibold text-zinc-500 uppercase tracking-wider mb-3",children:"Event Details"}),e.jsx("dl",{className:"grid grid-cols-2 gap-x-4 gap-y-3",children:[{label:"Event ID",value:s.id,mono:!0},{label:"Timestamp",value:P(s.timestamp),mono:!0},{label:"Actor",value:s.actor,mono:!0},{label:"Actor Kind",value:u.label,color:u.color},{label:"Resource",value:s.resource,mono:!0},{label:"Result",value:f.label,color:f.color},...s.duration!==void 0?[{label:"Duration",value:`${s.duration.toLocaleString()}ms`,mono:!0}]:[],...s.ip?[{label:"IP Address",value:s.ip,mono:!0}]:[]].map(({label:i,value:c,mono:r,color:v})=>e.jsxs("div",{children:[e.jsx("dt",{className:"text-xs text-zinc-500",children:i}),e.jsx("dd",{className:x("mt-0.5 text-xs break-all",r?"font-mono text-zinc-200":"font-medium",v??"text-zinc-200"),children:c})]},i))})]}),s.meta&&Object.keys(s.meta).length>0&&e.jsxs("div",{className:"px-5 py-4",children:[e.jsx("h3",{className:"text-xs font-semibold text-zinc-500 uppercase tracking-wider mb-3",children:"Metadata"}),e.jsx("div",{className:"rounded-lg bg-zinc-950 border border-zinc-800 divide-y divide-zinc-800",children:Object.entries(s.meta).map(([i,c])=>e.jsxs("div",{className:"flex items-center px-3 py-2 gap-3",children:[e.jsx("span",{className:"text-xs font-mono text-indigo-400 flex-none",children:i}),e.jsx("span",{className:"text-xs font-mono text-zinc-300 truncate",children:c})]},i))})]})]})}function V(){const[s]=l.useState(D),[a,p]=l.useState(null),[u,f]=l.useState(""),[i,c]=l.useState("all"),[r,v]=l.useState("all"),[y,k]=l.useState("all"),[j,S]=l.useState("all"),C=l.useRef(null);l.useEffect(()=>{const t=n=>{var h;(n.metaKey||n.ctrlKey)&&n.key==="f"&&(n.preventDefault(),(h=C.current)==null||h.focus())};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[]);const g=s.filter(t=>{if(i!=="all"&&t.severity!==i||r!=="all"&&t.category!==r||y!=="all"&&t.result!==y||j!=="all"&&t.actorKind!==j)return!1;if(u.trim()){const n=u.toLowerCase();return t.detail.toLowerCase().includes(n)||t.actor.toLowerCase().includes(n)||t.action.toLowerCase().includes(n)||t.resource.toLowerCase().includes(n)||t.id.toLowerCase().includes(n)}return!0}),N=a?s.find(t=>t.id===a)??null:null,_=l.useCallback(t=>{p(n=>n===t?null:t)},[]),F=l.useCallback(()=>p(null),[]),R=l.useCallback(()=>B(g),[g]),b={total:g.length,errors:g.filter(t=>t.severity==="error").length,warnings:g.filter(t=>t.severity==="warning").length,failures:g.filter(t=>t.result==="failure").length};return e.jsxs("div",{className:"flex flex-col h-full bg-zinc-950",children:[e.jsxs("div",{className:"flex-none px-6 py-4 border-b border-zinc-800",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-white",children:"Audit Log"}),e.jsx("p",{className:"text-sm text-zinc-500 mt-0.5",children:"Complete record of all system events, API calls, and configuration changes"})]}),e.jsxs("button",{onClick:R,"aria-label":"Export filtered audit log as CSV",className:"flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg bg-zinc-800 text-zinc-200 hover:bg-zinc-700 hover:text-white border border-zinc-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 transition-colors",children:[e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 2v8m0 0l-2.5-2.5M8 10l2.5-2.5M3 13h10"})}),"Export CSV"]})]}),e.jsx("div",{className:"flex items-center gap-4 mt-4 flex-wrap",children:[{label:"Total",value:b.total,color:"text-white"},{label:"Errors",value:b.errors,color:b.errors>0?"text-rose-400":"text-zinc-500"},{label:"Warnings",value:b.warnings,color:b.warnings>0?"text-amber-400":"text-zinc-500"},{label:"Failures",value:b.failures,color:b.failures>0?"text-rose-400":"text-zinc-500"}].map(({label:t,value:n,color:h})=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:x("text-sm font-semibold tabular-nums",h),children:n}),e.jsx("span",{className:"text-xs text-zinc-500",children:t})]},t))})]}),e.jsxs("div",{className:"flex-none px-6 py-3 border-b border-zinc-800 flex items-center gap-3 flex-wrap",children:[e.jsxs("div",{className:"relative flex-1 min-w-48 max-w-sm",children:[e.jsxs("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-zinc-500 pointer-events-none",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:[e.jsx("circle",{cx:"7",cy:"7",r:"4.5"}),e.jsx("path",{strokeLinecap:"round",d:"M10.5 10.5l3 3"})]}),e.jsx("input",{ref:C,type:"search",value:u,onChange:t=>f(t.target.value),placeholder:"Search eventsâ€¦ (âŒ˜F)","aria-label":"Search audit events",className:"w-full pl-8 pr-3 py-1.5 text-sm bg-zinc-900 border border-zinc-700 rounded-lg text-zinc-200 placeholder:text-zinc-600 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),e.jsxs("select",{value:i,onChange:t=>c(t.target.value),"aria-label":"Filter by severity",className:"py-1.5 pl-2 pr-6 text-sm bg-zinc-900 border border-zinc-700 rounded-lg text-zinc-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 appearance-none",children:[e.jsx("option",{value:"all",children:"All Severity"}),["info","success","warning","error"].map(t=>e.jsx("option",{value:t,children:w[t].label},t))]}),e.jsxs("select",{value:r,onChange:t=>v(t.target.value),"aria-label":"Filter by category",className:"py-1.5 pl-2 pr-6 text-sm bg-zinc-900 border border-zinc-700 rounded-lg text-zinc-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 appearance-none",children:[e.jsx("option",{value:"all",children:"All Categories"}),Object.keys(z).map(t=>e.jsx("option",{value:t,children:z[t]},t))]}),e.jsxs("select",{value:y,onChange:t=>k(t.target.value),"aria-label":"Filter by result",className:"py-1.5 pl-2 pr-6 text-sm bg-zinc-900 border border-zinc-700 rounded-lg text-zinc-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 appearance-none",children:[e.jsx("option",{value:"all",children:"All Results"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failure",children:"Failure"}),e.jsx("option",{value:"partial",children:"Partial"})]}),e.jsxs("select",{value:j,onChange:t=>S(t.target.value),"aria-label":"Filter by actor type",className:"py-1.5 pl-2 pr-6 text-sm bg-zinc-900 border border-zinc-700 rounded-lg text-zinc-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 appearance-none",children:[e.jsx("option",{value:"all",children:"All Actors"}),e.jsx("option",{value:"agent",children:"Agent"}),e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"system",children:"System"}),e.jsx("option",{value:"api",children:"API Key"})]}),(u||i!=="all"||r!=="all"||y!=="all"||j!=="all")&&e.jsx("button",{onClick:()=>{f(""),c("all"),v("all"),k("all"),S("all")},"aria-label":"Clear all filters",className:"text-xs text-indigo-400 hover:text-indigo-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 rounded transition-colors px-1",children:"Clear filters"})]}),e.jsxs("div",{className:"flex flex-1 min-h-0",children:[e.jsxs("div",{role:"listbox","aria-label":"Audit events","aria-multiselectable":"false",className:x("flex flex-col overflow-y-auto",N?"w-1/2":"w-full"),children:[g.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 py-20 text-center px-8",children:[e.jsx("span",{className:"text-4xl",children:"ðŸ”"}),e.jsx("p",{className:"text-sm font-medium text-zinc-300",children:"No events match your filters"}),e.jsx("p",{className:"text-xs text-zinc-600",children:"Try adjusting your search or clearing filters"})]}),g.map(t=>{const n=w[t.severity],h=E[t.actorKind],A=K[t.result],L=t.id===a;return e.jsxs("button",{role:"option","aria-selected":L,onClick:()=>_(t.id),className:x("flex items-start gap-3 w-full text-left px-5 py-3 border-b border-zinc-800/70 transition-colors group","hover:bg-zinc-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-indigo-500",L&&"bg-zinc-900 ring-1 ring-inset ring-indigo-500/40"),children:[e.jsx("div",{className:"flex-none mt-1.5",children:e.jsx("span",{className:x("block h-2 w-2 rounded-full",n.dot)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-xs font-mono text-zinc-500",children:M(t.timestamp)}),e.jsx(I,{category:t.category}),e.jsx("span",{className:x("text-xs font-mono",h.color),children:t.actor}),e.jsx("span",{className:x("text-xs font-medium",A.color),children:A.label})]}),e.jsx("p",{className:"mt-0.5 text-sm text-zinc-200 leading-snug truncate",children:t.detail}),e.jsxs("p",{className:"mt-0.5 text-xs font-mono text-zinc-600",children:[t.action," â†’ ",t.resource]})]}),e.jsxs("div",{className:"flex-none text-right",children:[e.jsx("p",{className:"text-xs text-zinc-600",children:O(t.timestamp)}),t.duration!==void 0&&e.jsxs("p",{className:"text-xs text-zinc-700 mt-0.5",children:[t.duration.toLocaleString(),"ms"]})]})]},t.id)})]}),N&&e.jsx("div",{className:"w-1/2 flex-none overflow-y-auto",children:e.jsx(W,{event:N,onClose:F})})]})]})}export{V as default};
