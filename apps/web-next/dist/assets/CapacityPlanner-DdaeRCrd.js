import{r as j,j as e,c as i}from"./index-veJTZUgy.js";const u=[{id:"api-rate",name:"API Rate Limits",current:8500,capacity:1e4,unit:"req/min",trend:"growing",growthRatePercent:12,daysUntilCap:45,forecastData:[8500,8900,9320,9760,1e4,1e4,1e4,1e4,1e4,1e4,1e4,1e4]},{id:"sessions",name:"Concurrent Sessions",current:142,capacity:250,unit:"sessions",trend:"growing",growthRatePercent:8,daysUntilCap:120,forecastData:[142,153,165,178,192,208,224,242,250,250,250,250]},{id:"token-budget",name:"Token Budget (Monthly)",current:182e5,capacity:2e7,unit:"tokens",trend:"growing",growthRatePercent:15,daysUntilCap:22,forecastData:[182e5,19e6,2e7,2e7,2e7,2e7,2e7,2e7,2e7,2e7,2e7,2e7]},{id:"tool-calls",name:"Tool Call Rate",current:320,capacity:500,unit:"calls/min",trend:"stable",growthRatePercent:2,daysUntilCap:null,forecastData:[320,326,333,339,346,353,360,367,374,382,389,397]},{id:"memory",name:"Memory / Storage",current:74,capacity:100,unit:"GB",trend:"growing",growthRatePercent:6,daysUntilCap:90,forecastData:[74,78,83,88,93,98,100,100,100,100,100,100]},{id:"bandwidth",name:"Network Bandwidth",current:450,capacity:1e3,unit:"Mbps",trend:"declining",growthRatePercent:-3,daysUntilCap:null,forecastData:[450,437,423,410,398,386,374,363,352,341,331,321]}],N=[{id:"r1",resourceId:"token-budget",priority:"P0",title:"Upgrade token tier to 50M/mo",impact:"Eliminates token cap risk for 6+ months",effort:"Low — billing change"},{id:"r2",resourceId:"api-rate",priority:"P0",title:"Enable rate limit auto-scaling",impact:"Prevents API throttling under load spikes",effort:"Medium — config + testing"},{id:"r3",resourceId:"memory",priority:"P1",title:"Archive stale agent memory snapshots",impact:"Frees ~18 GB, extends headroom to 6 months",effort:"Medium — migration script"},{id:"r4",resourceId:"sessions",priority:"P1",title:"Implement session pooling",impact:"Reduces peak concurrent sessions by ~30%",effort:"High — architecture change"},{id:"r5",resourceId:"api-rate",priority:"P1",title:"Add request deduplication layer",impact:"Reduces redundant API calls by ~20%",effort:"Medium — middleware"},{id:"r6",resourceId:"tool-calls",priority:"P2",title:"Batch tool calls where possible",impact:"Reduces call rate by ~15%",effort:"Low — agent prompt tuning"},{id:"r7",resourceId:"bandwidth",priority:"P2",title:"Enable response compression",impact:"Reduces bandwidth usage by ~40%",effort:"Low — gateway config"}];function p(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}K`:n.toString()}function k(n,r){return Math.round(n/r*100)}function P(n,r){return Math.round((r-n)/r*100)}function R(n,r,c){const o=k(n,r);return o>=90?"Critical":o>=80&&c==="growing"?"At Risk":o>=70?"Warning":"Healthy"}function E(n){return n>=10?"↑":n>=4?"↗":n>-4?"→":n>-10?"↘":"↓"}function H(n){return n>=90?"bg-rose-500":n>=70?"bg-amber-500":"bg-emerald-500"}function F(n){switch(n){case"Critical":return"text-rose-400 bg-rose-500/10 border-rose-500/30";case"At Risk":return"text-amber-400 bg-amber-500/10 border-amber-500/30";case"Warning":return"text-amber-400 bg-amber-500/10 border-amber-500/30";case"Healthy":return"text-emerald-400 bg-emerald-500/10 border-emerald-500/30"}}function M(n){switch(n){case"P0":return"text-rose-400 bg-rose-500/10 border-rose-500/30";case"P1":return"text-amber-400 bg-amber-500/10 border-amber-500/30";case"P2":return"text-zinc-400 bg-zinc-500/10 border-zinc-500/30"}}function B(n,r){const c=[n.current],o=1+r/100;let m=null;for(let l=1;l<12;l++){const s=Math.min(c[l-1]*o,n.capacity);c.push(Math.round(s)),m===null&&s>=n.capacity&&(m=l*30)}return{data:c,daysUntilCap:m}}function O(){const[n,r]=j.useState("12M"),[c,o]=j.useState(null),[m,l]=j.useState(null),s=u.find(t=>t.id===c)??null,h=m??(s==null?void 0:s.growthRatePercent)??0,v=u.filter(t=>P(t.current,t.capacity)<20).length,U=u.filter(t=>R(t.current,t.capacity,t.trend)==="Healthy").length,b=u.reduce((t,a)=>a.daysUntilCap===null?t:t===null?a.daysUntilCap:Math.min(t,a.daysUntilCap),null),w=N.filter(t=>t.priority==="P0"||t.priority==="P1").length,I=parseInt(n.replace("M",""),10),z=s?N.filter(t=>t.resourceId===s.id):[],g=s?B(s,h):null,S=m!==null&&g?g.data:(s==null?void 0:s.forecastData)??[],d=m!==null&&g?g.daysUntilCap:(s==null?void 0:s.daysUntilCap)??null,A=t=>{c===t?(o(null),l(null)):(o(t),l(null))},C=Math.min(I,12);return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Capacity Planner"}),e.jsx("div",{className:"flex items-center gap-1 bg-zinc-900 border border-zinc-800 rounded p-1",children:["3M","6M","12M","24M"].map(t=>e.jsx("button",{onClick:()=>r(t),className:i("px-3 py-1 rounded text-sm font-medium transition-colors",n===t?"bg-indigo-600 text-white":"text-zinc-400 hover:text-white"),children:t},t))})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[{label:"At Risk",value:v.toString(),sub:"< 20% headroom",color:v>0?"text-rose-400":"text-emerald-400"},{label:"Healthy",value:U.toString(),sub:"resources",color:"text-emerald-400"},{label:"First Cap Hit",value:b!==null?`${b}d`:"—",sub:"days until",color:b!==null&&b<60?"text-amber-400":"text-zinc-400"},{label:"Actions Needed",value:w.toString(),sub:"P0 + P1",color:w>0?"text-indigo-400":"text-zinc-400"}].map(t=>e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-zinc-500 text-xs font-medium uppercase tracking-wider mb-1",children:t.label}),e.jsx("div",{className:i("text-2xl font-bold",t.color),children:t.value}),e.jsx("div",{className:"text-zinc-500 text-xs mt-0.5",children:t.sub})]},t.label))}),e.jsx("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg overflow-hidden mb-6",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-zinc-800",children:["Resource","Current","Capacity","Usage %","Headroom","Trend","Days to Cap","Status"].map(t=>e.jsx("th",{className:"text-left text-zinc-500 text-xs font-medium uppercase tracking-wider px-4 py-3",children:t},t))})}),e.jsx("tbody",{children:u.map(t=>{const a=k(t.current,t.capacity),x=P(t.current,t.capacity),f=R(t.current,t.capacity,t.trend),y=c===t.id;return e.jsxs("tr",{onClick:()=>A(t.id),className:i("border-b border-zinc-800/50 cursor-pointer transition-colors",y?"bg-indigo-500/10":"hover:bg-zinc-800/50"),children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:t.name}),e.jsxs("td",{className:"px-4 py-3 text-zinc-400",children:[p(t.current)," ",e.jsx("span",{className:"text-zinc-600 text-xs",children:t.unit})]}),e.jsx("td",{className:"px-4 py-3 text-zinc-400",children:p(t.capacity)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 h-2 bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:i("h-full rounded-full",H(a)),style:{width:`${Math.min(a,100)}%`}})}),e.jsxs("span",{className:"text-zinc-400 text-xs w-8",children:[a,"%"]})]})}),e.jsxs("td",{className:i("px-4 py-3 text-xs font-medium",x<20?"text-rose-400":x<30?"text-amber-400":"text-emerald-400"),children:[x,"%"]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:i("text-sm",t.trend==="growing"?"text-amber-400":t.trend==="declining"?"text-emerald-400":"text-zinc-500"),children:[E(t.growthRatePercent)," ",e.jsxs("span",{className:"text-xs text-zinc-500",children:[t.growthRatePercent>0?"+":"",t.growthRatePercent,"%"]})]})}),e.jsx("td",{className:i("px-4 py-3 text-sm",t.daysUntilCap!==null&&t.daysUntilCap<60?"text-rose-400 font-medium":"text-zinc-400"),children:t.daysUntilCap!==null?`${t.daysUntilCap}d`:"—"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:i("text-xs font-medium px-2 py-0.5 rounded border",F(f)),children:f})})]},t.id)})})]})}),s&&e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold",children:[s.name," — Forecast"]}),e.jsxs("span",{className:"text-zinc-500 text-sm",children:[C,"-month projection",d!==null&&e.jsxs("span",{className:"ml-2 text-amber-400",children:["· cap in ",d,"d"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex items-end gap-1 h-40",children:S.slice(0,C).map((t,a)=>{const x=s.capacity*1.05,f=Math.max(t/x*100,2),y=s.capacity/x*100,$=t>=s.capacity,D=a===0;return e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1 relative h-full justify-end",children:[e.jsx("div",{className:i("w-full rounded-t transition-all",D?"bg-indigo-500":$?"bg-rose-500/70":"bg-indigo-500/40"),style:{height:`${f}%`},title:`M${a+1}: ${p(t)} ${s.unit}`}),e.jsxs("span",{className:"text-zinc-600 text-[10px]",children:["M",a+1]}),a===0&&e.jsx("div",{className:"absolute left-0 right-0 border-t border-dashed border-rose-500/50",style:{bottom:`${y}%`}})]},a)})}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsxs("span",{className:"text-zinc-600 text-[10px]",children:["Current: ",p(s.current)]}),e.jsxs("span",{className:"text-zinc-600 text-[10px]",children:["Capacity: ",p(s.capacity)," ",s.unit]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-3",children:"Recommended Actions"}),z.length>0?e.jsx("ul",{className:"space-y-2",children:z.map(t=>e.jsxs("li",{className:"bg-zinc-800/50 rounded p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:i("text-[10px] font-bold px-1.5 py-0.5 rounded border",M(t.priority)),children:t.priority}),e.jsx("span",{className:"text-sm font-medium",children:t.title})]}),e.jsx("div",{className:"text-zinc-500 text-xs",children:t.impact})]},t.id))}):e.jsx("p",{className:"text-zinc-600 text-sm",children:"No specific actions for this resource."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-3",children:"What-If Scenario"}),e.jsxs("div",{className:"bg-zinc-800/50 rounded p-4",children:[e.jsxs("label",{className:"block text-xs text-zinc-500 mb-2",children:["Adjust monthly growth rate: ",e.jsxs("span",{className:"text-white font-medium",children:[h>0?"+":"",h,"%"]})]}),e.jsx("input",{type:"range",min:-20,max:30,step:1,value:h,onChange:t=>l(parseInt(t.target.value,10)),className:"w-full accent-indigo-500"}),e.jsxs("div",{className:"flex justify-between text-[10px] text-zinc-600 mt-1",children:[e.jsx("span",{children:"-20%"}),e.jsx("span",{children:"0%"}),e.jsx("span",{children:"+30%"})]}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-zinc-500",children:"Original growth"}),e.jsxs("span",{className:"text-zinc-400",children:[s.growthRatePercent>0?"+":"",s.growthRatePercent,"%/mo"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-zinc-500",children:"Projected cap hit"}),e.jsx("span",{className:i(d!==null&&d<90?"text-rose-400":"text-emerald-400"),children:d!==null?`${d} days`:"Not projected"})]}),m!==null&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-zinc-500",children:"vs. baseline"}),e.jsx("span",{className:"text-indigo-400",children:d!==null&&s.daysUntilCap!==null?`${d-s.daysUntilCap>0?"+":""}${d-s.daysUntilCap}d`:d===null&&s.daysUntilCap!==null?"Cap eliminated":"—"})]})]}),m!==null&&e.jsx("button",{onClick:()=>l(null),className:"mt-3 text-xs text-zinc-500 hover:text-zinc-300 underline",children:"Reset to baseline"})]})]})]})]})]}),e.jsx("div",{className:"w-60 shrink-0",children:e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-4 sticky top-6",children:[e.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wider text-zinc-500 mb-4",children:"All Recommendations"}),e.jsx("div",{className:"space-y-3",children:N.map(t=>e.jsxs("div",{className:i("rounded p-3 border transition-colors cursor-pointer",c===t.resourceId?"border-indigo-500/40 bg-indigo-500/5":"border-zinc-800 bg-zinc-800/30 hover:border-zinc-700"),onClick:()=>{o(t.resourceId),l(null)},children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:i("text-[10px] font-bold px-1.5 py-0.5 rounded border",M(t.priority)),children:t.priority})}),e.jsx("div",{className:"text-xs font-medium text-white leading-snug mb-1",children:t.title}),e.jsx("div",{className:"text-[10px] text-zinc-500 leading-snug mb-1",children:t.impact}),e.jsxs("div",{className:"text-[10px] text-zinc-600",children:["Effort: ",t.effort]})]},t.id))})]})})]})]})}export{O as default};
