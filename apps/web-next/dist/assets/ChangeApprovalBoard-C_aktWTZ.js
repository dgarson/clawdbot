import{r as l,j as t,c as n}from"./index-CQVgRzMx.js";const m={draft:"bg-zinc-500/20 text-zinc-400 border border-zinc-500/30",pending:"bg-amber-500/20 text-amber-400 border border-amber-500/30",approved:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",rejected:"bg-rose-500/20 text-rose-400 border border-rose-500/30","in-progress":"bg-sky-500/20 text-sky-400 border border-sky-500/30",completed:"bg-violet-500/20 text-violet-400 border border-violet-500/30",cancelled:"bg-zinc-500/20 text-zinc-500 border border-zinc-600/30"},p={standard:"bg-zinc-500/20 text-zinc-400",normal:"bg-sky-500/20 text-sky-400",major:"bg-indigo-500/20 text-indigo-400",emergency:"bg-rose-500/20 text-rose-400"},x={low:"bg-emerald-500/20 text-emerald-400",medium:"bg-amber-500/20 text-amber-400",high:"bg-orange-500/20 text-orange-400",critical:"bg-red-500/20 text-red-400"},y={approved:{icon:"✓",color:"text-emerald-400"},rejected:{icon:"✗",color:"text-rose-400"},pending:{icon:"⋯",color:"text-zinc-500"},abstain:{icon:"—",color:"text-zinc-600"}},r=[{id:"CR-2201",title:"Upgrade PostgreSQL 14 → 16 on prod",type:"major",status:"pending",risk:"high",requestedBy:"alice",team:"Platform",service:"postgres-primary",environment:"production",scheduledStart:"2025-02-28 02:00",scheduledEnd:"2025-02-28 06:00",description:"In-place major version upgrade of the production PostgreSQL cluster from 14.10 to 16.2. Requires ~15min downtime for switchover.",rollbackPlan:"Restore from pre-upgrade snapshot. Estimated recovery: 30min. Snapshot taken 1hr before window.",testPlan:"Staged 3 days prior in staging. pg_upgrade check runs clean. Tested all stored procedures and extensions.",approvers:[{name:"xavier",role:"VP Engineering",decision:"approved",comment:"Staging looked good. Proceed.",decidedAt:"2025-02-22 10:30"},{name:"tim",role:"Platform Architect",decision:"approved",comment:"Migration plan is solid.",decidedAt:"2025-02-22 11:00"},{name:"cto",role:"CTO",decision:"pending",comment:null,decidedAt:null}],createdAt:"2025-02-20",updatedAt:"4h ago",linkedTickets:["PLAT-4892","OPS-1201"],maintenanceWindow:!0},{id:"CR-2199",title:"Deploy rate limiter middleware to prod API",type:"normal",status:"approved",risk:"medium",requestedBy:"bob",team:"Backend",service:"api-gateway",environment:"production",scheduledStart:"2025-02-23 14:00",scheduledEnd:"2025-02-23 14:30",description:"Deploy new Redis-backed rate limiting middleware (PR #1482). Zero-downtime deployment via rolling update.",rollbackPlan:"Feature flag to disable. Rollback deploy in 5min if error rate spikes.",testPlan:"Load tested in staging. No regression in p99. Canary passed at 5% traffic.",approvers:[{name:"alice",role:"Senior Engineer",decision:"approved",comment:"Tested thoroughly.",decidedAt:"2025-02-22 09:00"},{name:"xavier",role:"VP Engineering",decision:"approved",comment:"Good to go.",decidedAt:"2025-02-22 09:15"}],createdAt:"2025-02-21",updatedAt:"2h ago",linkedTickets:["BE-3341"],maintenanceWindow:!1},{id:"CR-2195",title:"Emergency: Revert webhook worker OOM config",type:"emergency",status:"in-progress",risk:"critical",requestedBy:"carol",team:"Platform",service:"webhook-worker",environment:"production",scheduledStart:"2025-02-22 14:15",scheduledEnd:"2025-02-22 14:45",description:"Emergency change to revert the webhook-worker memory limit from 256Mi to 512Mi. Active incident CR-INC-2195.",rollbackPlan:"N/A — this IS the rollback of the original change.",testPlan:"N/A — emergency. Monitoring closely after apply.",approvers:[{name:"xavier",role:"VP Engineering",decision:"approved",comment:"Approved. Fix the outage.",decidedAt:"2025-02-22 14:12"}],createdAt:"2025-02-22",updatedAt:"12m ago",linkedTickets:["INC-2195","PLAT-4901"],maintenanceWindow:!1},{id:"CR-2188",title:"Rotate production JWT signing keys",type:"normal",status:"pending",risk:"high",requestedBy:"eve",team:"Security",service:"auth-service",environment:"production",scheduledStart:"2025-03-01 03:00",scheduledEnd:"2025-03-01 04:00",description:"Rotate HS256 JWT signing keys and migrate to RS256. Requires coordinated deploy of auth-service and all consumer services.",rollbackPlan:"Keep old keys active for 24hr overlap. Can roll back by re-enabling old key in Vault.",testPlan:"Tested in staging with 4 consumer services. All token flows verified.",approvers:[{name:"security",role:"CISO",decision:"approved",comment:"Long overdue.",decidedAt:"2025-02-21 16:00"},{name:"xavier",role:"VP Engineering",decision:"pending",comment:null,decidedAt:null},{name:"tim",role:"Platform Architect",decision:"pending",comment:null,decidedAt:null}],createdAt:"2025-02-18",updatedAt:"1d ago",linkedTickets:["SEC-882","AUTH-219"],maintenanceWindow:!0},{id:"CR-2180",title:"Enable WAF on production load balancer",type:"standard",status:"completed",risk:"medium",requestedBy:"frank",team:"Security",service:"load-balancer",environment:"production",scheduledStart:"2025-02-19 23:00",scheduledEnd:"2025-02-20 00:00",description:"Enable AWS WAF with OWASP managed ruleset on the production ALB. Rate limiting rules for login endpoint.",rollbackPlan:"Disable WAF association in 2 CLI commands. Estimated 60s.",testPlan:"Tested in staging for 7 days. No false positives on legitimate traffic patterns.",approvers:[{name:"security",role:"CISO",decision:"approved",comment:"Required by Q1 audit.",decidedAt:"2025-02-18 14:00"},{name:"xavier",role:"VP Engineering",decision:"approved",comment:"Approved.",decidedAt:"2025-02-18 15:30"}],createdAt:"2025-02-15",updatedAt:"3d ago",linkedTickets:["SEC-860"],maintenanceWindow:!1},{id:"CR-2176",title:"Increase Elasticsearch shard count for search index",type:"major",status:"rejected",risk:"high",requestedBy:"grace",team:"Search",service:"elasticsearch",environment:"production",scheduledStart:"2025-02-17 02:00",scheduledEnd:"2025-02-17 08:00",description:"Reindex search with 12 shards (up from 5) to reduce per-shard size and improve query throughput.",rollbackPlan:"Reindex back to 5 shards. Estimated 4-6hr recovery window.",testPlan:"Tested in staging — reindex took 3.5hr. Some query latency improvement observed.",approvers:[{name:"tim",role:"Platform Architect",decision:"rejected",comment:"Risk window too wide. We have the DB migration same week. Defer to March.",decidedAt:"2025-02-16 11:00"},{name:"xavier",role:"VP Engineering",decision:"abstain",comment:"Deferring to Tim's judgment on scheduling.",decidedAt:"2025-02-16 11:30"}],createdAt:"2025-02-14",updatedAt:"5d ago",linkedTickets:["SRCH-104"],maintenanceWindow:!1}],N=r.filter(i=>i.status==="pending").length,k=r.filter(i=>i.status==="approved").length,w=r.filter(i=>i.type==="emergency"&&(i.status==="pending"||i.status==="in-progress")).length;function z(){const[i,g]=l.useState("board"),[s,d]=l.useState(null),[o,h]=l.useState("all"),[c,b]=l.useState("all"),v=r.filter(e=>(o==="all"||e.status===o)&&(c==="all"||e.type===c)),j=[{id:"board",label:"Change Board"},{id:"calendar",label:"Scheduled"}];return t.jsx("div",{className:"min-h-screen bg-zinc-950 text-white p-6",children:t.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-white",children:"Change Approval Board"}),t.jsx("p",{className:"text-zinc-400 text-sm mt-1",children:"Change requests, approvals, and change management workflow"})]}),t.jsx("button",{className:"px-4 py-2 rounded-lg bg-indigo-600 hover:bg-indigo-500 text-sm font-medium transition-colors",children:"+ Submit Change"})]}),t.jsx("div",{className:"grid grid-cols-4 gap-4",children:[{label:"Pending Approval",value:N,color:"text-amber-400"},{label:"Approved (7d)",value:k,color:"text-emerald-400"},{label:"Active Emergencies",value:w,color:"text-rose-400"},{label:"Total (30d)",value:r.length,color:"text-white"}].map(e=>t.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[t.jsx("p",{className:"text-xs text-zinc-500 uppercase tracking-wider",children:e.label}),t.jsx("p",{className:n("text-3xl font-bold mt-1",e.color),children:e.value})]},e.label))}),t.jsx("div",{className:"flex gap-1 border-b border-zinc-800",children:j.map(e=>t.jsx("button",{onClick:()=>{g(e.id),d(null)},className:n("px-4 py-2 text-sm font-medium border-b-2 transition-colors",i===e.id?"border-indigo-500 text-white":"border-transparent text-zinc-400 hover:text-zinc-200"),children:e.label},e.id))}),i==="board"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[["all","pending","approved","in-progress","completed","rejected"].map(e=>t.jsx("button",{onClick:()=>{h(e==="all"?"all":e),d(null)},className:n("px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",o===e?"bg-indigo-600 text-white":"bg-zinc-800 text-zinc-400 hover:text-zinc-200"),children:e==="all"?"All":e.split("-").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")},e)),t.jsx("div",{className:"ml-auto flex gap-2",children:["all","emergency","major","normal","standard"].map(e=>t.jsx("button",{onClick:()=>b(e==="all"?"all":e),className:n("px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",c===e?"bg-zinc-600 text-white":"bg-zinc-800 text-zinc-500 hover:text-zinc-300"),children:e==="all"?"All types":e},e))})]}),s?t.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5 space-y-5",children:[t.jsx("button",{onClick:()=>d(null),className:"text-zinc-400 hover:text-white text-sm",children:"← Back"}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[t.jsx("span",{className:"text-xs font-mono text-zinc-500",children:s.id}),t.jsx("span",{className:n("text-xs px-2 py-0.5 rounded-full font-medium",m[s.status]),children:s.status}),t.jsx("span",{className:n("text-xs px-2 py-0.5 rounded font-medium",p[s.type]),children:s.type}),t.jsxs("span",{className:n("text-xs px-2 py-0.5 rounded font-medium",x[s.risk]),children:["risk: ",s.risk]}),s.maintenanceWindow&&t.jsx("span",{className:"text-xs bg-indigo-500/20 text-indigo-400 px-2 py-0.5 rounded",children:"maintenance window"})]}),t.jsx("h2",{className:"text-xl font-bold text-white",children:s.title})]}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[{label:"Requested by",value:s.requestedBy},{label:"Team",value:s.team},{label:"Service",value:s.service},{label:"Environment",value:s.environment},{label:"Starts",value:s.scheduledStart},{label:"Ends",value:s.scheduledEnd},{label:"Created",value:s.createdAt},{label:"Updated",value:s.updatedAt}].map(e=>t.jsxs("div",{className:"bg-zinc-800/60 rounded-lg p-3",children:[t.jsx("p",{className:"text-xs text-zinc-500",children:e.label}),t.jsx("p",{className:"text-sm font-medium text-white mt-0.5",children:e.value})]},e.label))}),[{label:"Description",text:s.description},{label:"Rollback Plan",text:s.rollbackPlan},{label:"Test Plan",text:s.testPlan}].map(e=>t.jsxs("div",{className:"bg-zinc-800/40 rounded-lg p-4",children:[t.jsx("p",{className:"text-xs font-semibold text-zinc-400 uppercase tracking-wider mb-2",children:e.label}),t.jsx("p",{className:"text-sm text-zinc-300 leading-relaxed",children:e.text})]},e.label)),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-sm font-semibold text-zinc-300 mb-3",children:["Approvals (",s.approvers.filter(e=>e.decision!=="pending").length,"/",s.approvers.length,")"]}),t.jsx("div",{className:"space-y-2",children:s.approvers.map(e=>{const a=y[e.decision];return t.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3 flex items-start gap-3",children:[t.jsx("div",{className:"w-7 h-7 rounded-full bg-zinc-700 flex items-center justify-center text-xs font-bold flex-shrink-0",children:e.name[0].toUpperCase()}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-white",children:e.name}),t.jsx("span",{className:"text-xs text-zinc-500",children:e.role}),t.jsxs("span",{className:n("text-sm font-bold ml-auto",a.color),children:[a.icon," ",e.decision]})]}),e.comment&&t.jsx("p",{className:"text-xs text-zinc-400 mt-1",children:e.comment}),e.decidedAt&&t.jsx("p",{className:"text-xs text-zinc-600 mt-0.5",children:e.decidedAt})]})]},e.name)})})]}),s.linkedTickets.length>0&&t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-zinc-500 mb-2",children:"Linked tickets"}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:s.linkedTickets.map(e=>t.jsx("span",{className:"text-xs bg-zinc-800 text-indigo-400 px-2 py-1 rounded font-mono",children:e},e))})]}),s.status==="pending"&&t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500 rounded-lg text-sm font-medium transition-colors",children:"Approve"}),t.jsx("button",{className:"px-4 py-2 bg-rose-600 hover:bg-rose-500 rounded-lg text-sm font-medium transition-colors",children:"Reject"}),t.jsx("button",{className:"px-4 py-2 bg-zinc-700 hover:bg-zinc-600 rounded-lg text-sm font-medium transition-colors",children:"Abstain"})]})]}):t.jsx("div",{className:"space-y-3",children:v.map(e=>{const a=e.approvers.filter(f=>f.decision==="approved").length,u=e.approvers.length;return t.jsx("button",{onClick:()=>d(e),className:n("w-full text-left bg-zinc-900 border rounded-xl p-4 transition-colors hover:border-zinc-600",e.type==="emergency"?"border-rose-500/30":"border-zinc-800"),children:t.jsxs("div",{className:"flex items-start justify-between gap-4 mb-2",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[t.jsx("span",{className:"text-xs font-mono text-zinc-500",children:e.id}),t.jsx("span",{className:n("text-xs px-2 py-0.5 rounded-full font-medium",m[e.status]),children:e.status}),t.jsx("span",{className:n("text-xs px-1.5 py-0.5 rounded",p[e.type]),children:e.type}),t.jsxs("span",{className:n("text-xs px-1.5 py-0.5 rounded",x[e.risk]),children:[e.risk," risk"]})]}),t.jsx("p",{className:"text-sm font-semibold text-white truncate",children:e.title}),t.jsxs("p",{className:"text-xs text-zinc-500 mt-0.5",children:[e.service," · ",e.team," · by ",e.requestedBy," · ",e.updatedAt]})]}),t.jsxs("div",{className:"flex-shrink-0 text-right",children:[t.jsxs("div",{className:n("text-xs font-medium px-2 py-1 rounded",a===u?"text-emerald-400 bg-emerald-500/10":"text-zinc-400 bg-zinc-800"),children:[a,"/",u," approved"]}),t.jsx("p",{className:"text-xs text-zinc-600 mt-1",children:e.scheduledStart})]})]})},e.id)})})]}),i==="calendar"&&t.jsxs("div",{className:"space-y-3",children:[t.jsx("p",{className:"text-sm text-zinc-400",children:"Upcoming scheduled changes"}),r.filter(e=>!["completed","rejected","cancelled"].includes(e.status)).sort((e,a)=>e.scheduledStart.localeCompare(a.scheduledStart)).map(e=>t.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 flex items-center gap-4",children:[t.jsxs("div",{className:"bg-indigo-500/20 border border-indigo-500/30 rounded-lg p-3 text-center flex-shrink-0 w-20",children:[t.jsx("p",{className:"text-xs text-indigo-400 font-medium",children:e.scheduledStart.slice(5,10)}),t.jsx("p",{className:"text-xs text-indigo-300",children:e.scheduledStart.slice(11,16)})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[t.jsx("span",{className:n("text-xs px-2 py-0.5 rounded-full font-medium",m[e.status]),children:e.status}),t.jsx("span",{className:n("text-xs px-1.5 py-0.5 rounded",p[e.type]),children:e.type})]}),t.jsx("p",{className:"text-sm font-semibold text-white truncate",children:e.title}),t.jsxs("p",{className:"text-xs text-zinc-500",children:[e.service," · ",e.team]})]}),t.jsxs("div",{className:"flex-shrink-0 text-right",children:[t.jsxs("span",{className:n("text-xs px-2 py-0.5 rounded",x[e.risk]),children:[e.risk," risk"]}),t.jsxs("p",{className:"text-xs text-zinc-600 mt-1",children:["to ",e.scheduledEnd.slice(11,16)]})]})]},e.id))]})]})})}export{z as default};
