import{r as o,j as e,c as a}from"./index-CiPVXHVM.js";const n=[{id:"p1",name:"Data Encryption at Rest",version:"2.1.0",category:"data-privacy",status:"active",framework:"SOC 2 Type II",riskLevel:"critical",owner:"CISO Office",reviewDate:"2026-06-01",effectiveDate:"2025-01-01",description:"All sensitive data stored in persistent storage must be encrypted using AES-256 or equivalent. This includes databases, file systems, backups, and logs containing PII.",rules:[{id:"r1",text:"Production databases must use AES-256 encryption",required:!0},{id:"r2",text:"Encryption keys must be rotated every 90 days",required:!0},{id:"r3",text:"Backup archives must be encrypted before transmission",required:!0},{id:"r4",text:"Key management must use a dedicated HSM or KMS",required:!0},{id:"r5",text:"Encryption algorithms must meet FIPS 140-2 standards",required:!1}],controls:[{id:"c1",name:"DB Encryption Check",description:"Automated scan of all databases for encryption configuration",status:"passing",lastTested:"2026-02-22 06:00",evidenceType:"automated",owner:"Platform Team",automationId:"scan-db-enc-001"},{id:"c2",name:"Key Rotation Audit",description:"Verify encryption keys were rotated within 90 days",status:"warning",lastTested:"2026-02-20 12:00",evidenceType:"automated",owner:"Security Team",automationId:"key-rot-check-002"},{id:"c3",name:"Backup Encryption Verification",description:"Sample-based verification of backup encryption",status:"passing",lastTested:"2026-02-19 08:00",evidenceType:"manual",owner:"Ops Team",automationId:null},{id:"c4",name:"KMS Configuration Review",description:"Quarterly review of KMS policies and access",status:"passing",lastTested:"2026-01-15 10:00",evidenceType:"attestation",owner:"CISO Office",automationId:null}],passingControls:3,totalControls:4,lastAudit:"2026-02-15",exceptions:0,tags:["encryption","PII","GDPR","SOC2"]},{id:"p2",name:"Multi-Factor Authentication",version:"1.5.2",category:"access-control",status:"active",framework:"ISO 27001",riskLevel:"high",owner:"Identity Team",reviewDate:"2026-08-01",effectiveDate:"2024-09-01",description:"All user accounts with access to production systems or sensitive data must authenticate using multi-factor authentication. Hardware tokens required for privileged accounts.",rules:[{id:"r6",text:"MFA required for all admin accounts",required:!0},{id:"r7",text:"MFA required for production system access",required:!0},{id:"r8",text:"Hardware tokens required for C-level and CISO roles",required:!0},{id:"r9",text:"MFA bypass must require CISO approval and time-limit",required:!0},{id:"r10",text:"MFA enrollment must complete within 24h of account creation",required:!1}],controls:[{id:"c5",name:"MFA Coverage Scan",description:"Scan all active accounts for MFA enrollment status",status:"passing",lastTested:"2026-02-22 04:00",evidenceType:"automated",owner:"Identity Team",automationId:"mfa-scan-003"},{id:"c6",name:"Privileged Account Review",description:"Quarterly review of privileged accounts with hardware token verification",status:"passing",lastTested:"2026-01-31 09:00",evidenceType:"manual",owner:"CISO Office",automationId:null},{id:"c7",name:"MFA Bypass Log Review",description:"Review all MFA bypass events for unauthorized usage",status:"failing",lastTested:"2026-02-10 11:00",evidenceType:"automated",owner:"Security Ops",automationId:"bypass-audit-004"}],passingControls:2,totalControls:3,lastAudit:"2026-01-31",exceptions:2,tags:["MFA","authentication","access-control"]},{id:"p3",name:"Vulnerability Management",version:"3.0.0",category:"security",status:"active",framework:"NIST CSF",riskLevel:"high",owner:"Security Engineering",reviewDate:"2026-04-01",effectiveDate:"2025-04-01",description:"All systems must undergo regular vulnerability scanning. Critical vulnerabilities must be remediated within 24 hours, high severity within 7 days, and medium within 30 days.",rules:[{id:"r11",text:"Critical CVEs must be patched within 24 hours",required:!0},{id:"r12",text:"High CVEs must be patched within 7 days",required:!0},{id:"r13",text:"Weekly automated vulnerability scans for all services",required:!0},{id:"r14",text:"Penetration testing annually for production systems",required:!0}],controls:[{id:"c8",name:"Automated Vuln Scan",description:"Weekly Trivy + Grype scan of all container images",status:"passing",lastTested:"2026-02-21 02:00",evidenceType:"automated",owner:"Security Engineering",automationId:"vuln-scan-005"},{id:"c9",name:"SLA Compliance Tracker",description:"Track patch SLA compliance for open CVEs",status:"failing",lastTested:"2026-02-22 01:00",evidenceType:"automated",owner:"Security Engineering",automationId:"patch-sla-006"},{id:"c10",name:"Pen Test Evidence",description:"Annual penetration test report and remediation evidence",status:"not-tested",lastTested:"2025-08-15 00:00",evidenceType:"manual",owner:"CISO Office",automationId:null}],passingControls:1,totalControls:3,lastAudit:"2026-02-01",exceptions:1,tags:["CVE","patching","scanning","NIST"]},{id:"p4",name:"Data Retention & Deletion",version:"1.2.0",category:"data-privacy",status:"draft",framework:"GDPR",riskLevel:"medium",owner:"Legal & Compliance",reviewDate:"2026-03-01",effectiveDate:"N/A",description:"Personal data must not be retained beyond its stated retention period. Deletion requests must be honored within 30 days. Automated deletion jobs must run at least weekly.",rules:[{id:"r15",text:"Retention periods must be documented per data class",required:!0},{id:"r16",text:"DSAR deletion requests honored within 30 days",required:!0},{id:"r17",text:"Automated deletion jobs run weekly",required:!0}],controls:[{id:"c11",name:"Retention Policy Audit",description:"Annual audit of documented retention policies vs actual data",status:"not-tested",lastTested:"2025-09-01 00:00",evidenceType:"manual",owner:"Legal",automationId:null},{id:"c12",name:"DSAR Response Timer",description:"Track time to completion of data deletion requests",status:"not-tested",lastTested:"never",evidenceType:"automated",owner:"Privacy Team",automationId:null}],passingControls:0,totalControls:2,lastAudit:"2025-09-01",exceptions:0,tags:["GDPR","retention","PII","deletion"]},{id:"p5",name:"Change Management Policy",version:"2.0.1",category:"operational",status:"active",framework:"ITIL",riskLevel:"medium",owner:"Platform Engineering",reviewDate:"2026-09-01",effectiveDate:"2025-03-01",description:"All changes to production systems must follow the change approval process. Emergency changes require post-hoc review within 72 hours. All changes must be logged.",rules:[{id:"r18",text:"All production changes require CAB approval",required:!0},{id:"r19",text:"Emergency changes reviewed within 72 hours",required:!0},{id:"r20",text:"Changes must include rollback plan",required:!0},{id:"r21",text:"Deployment windows defined and enforced",required:!1}],controls:[{id:"c13",name:"CAB Approval Rate",description:"Track % of changes with formal CAB approval",status:"passing",lastTested:"2026-02-22 00:00",evidenceType:"automated",owner:"Change Mgmt",automationId:"cab-rate-007"},{id:"c14",name:"Emergency Change Review",description:"Verify emergency changes reviewed within 72h",status:"warning",lastTested:"2026-02-18 10:00",evidenceType:"automated",owner:"Change Mgmt",automationId:"emrg-review-008"},{id:"c15",name:"Rollback Plan Presence",description:"Check all change tickets include documented rollback",status:"passing",lastTested:"2026-02-20 08:00",evidenceType:"automated",owner:"Platform Eng",automationId:"rollback-check-009"}],passingControls:2,totalControls:3,lastAudit:"2026-02-01",exceptions:0,tags:["change-management","ITIL","CAB"]}],R=[{id:"a1",policyId:"p1",policyName:"Data Encryption at Rest",action:"Version bumped to 2.1.0",user:"alice@company.com",timestamp:"2026-02-10 14:22",before:"2.0.3",after:"2.1.0"},{id:"a2",policyId:"p2",policyName:"Multi-Factor Authentication",action:"Added hardware token rule for C-level",user:"bob@company.com",timestamp:"2026-02-08 09:15",before:"r7 missing",after:"r7 added"},{id:"a3",policyId:"p3",policyName:"Vulnerability Management",action:"Critical CVE SLA changed from 48h to 24h",user:"security-eng@company.com",timestamp:"2026-02-05 16:00",before:"48h SLA",after:"24h SLA"},{id:"a4",policyId:"p5",policyName:"Change Management Policy",action:"Control c14 status changed to warning",user:"system",timestamp:"2026-02-18 10:00",before:"passing",after:"warning"},{id:"a5",policyId:"p4",policyName:"Data Retention & Deletion",action:"Policy status changed to draft for revision",user:"legal@company.com",timestamp:"2026-02-01 11:00",before:"review",after:"draft"}],g=[{id:"e1",policyId:"p2",policyName:"Multi-Factor Authentication",requester:"dev-tools-bot@company.com",reason:"CI/CD pipeline requires non-interactive auth; MFA not compatible with automation flows.",status:"approved",expiresAt:"2026-06-30",riskAccepted:"medium",approver:"ciso@company.com",submittedAt:"2026-01-15"},{id:"e2",policyId:"p2",policyName:"Multi-Factor Authentication",requester:"monitoring-svc@company.com",reason:"Legacy monitoring system does not support MFA; migration scheduled for Q3 2026.",status:"approved",expiresAt:"2026-09-30",riskAccepted:"medium",approver:"ciso@company.com",submittedAt:"2026-01-20"},{id:"e3",policyId:"p3",policyName:"Vulnerability Management",requester:"vendor-integration@company.com",reason:"Third-party vendor component CVE-2026-1234; patch not yet available from vendor.",status:"pending",expiresAt:"2026-04-30",riskAccepted:"high",approver:null,submittedAt:"2026-02-18"}];function N(s){return s==="active"?"bg-emerald-400/10 text-emerald-400":s==="draft"?"bg-amber-400/10 text-amber-400":s==="archived"?"bg-zinc-600 text-zinc-400":"bg-indigo-400/10 text-indigo-400"}function v(s){return s==="critical"?"bg-rose-500/10 text-rose-400":s==="high"?"bg-orange-500/10 text-orange-400":s==="medium"?"bg-amber-500/10 text-amber-400":"bg-emerald-500/10 text-emerald-400"}function w(s){return s==="passing"?"bg-emerald-400":s==="failing"?"bg-rose-400":s==="warning"?"bg-amber-400":"bg-zinc-500"}function z(s){return s==="passing"?"text-emerald-400":s==="failing"?"text-rose-400":s==="warning"?"text-amber-400":"text-zinc-500"}function C(s){return{"data-privacy":"Data Privacy","access-control":"Access Control",security:"Security",operational:"Operational",financial:"Financial"}[s]}function M(s){return s==="approved"?"bg-emerald-400/10 text-emerald-400":s==="denied"?"bg-rose-400/10 text-rose-400":"bg-amber-400/10 text-amber-400"}function A({passing:s,total:c}){const i=c>0?s/c*100:0,l=i===100?"bg-emerald-500":i>=60?"bg-amber-500":"bg-rose-500";return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-zinc-700 rounded-full overflow-hidden",children:e.jsx("div",{className:a("h-full rounded-full",l),style:{width:`${i}%`}})}),e.jsxs("span",{className:"text-xs text-zinc-400 whitespace-nowrap",children:[s,"/",c]})]})}function O(){const[s,c]=o.useState("policies"),[i,l]=o.useState(null),[m,k]=o.useState("all"),[x,T]=o.useState("all"),[u,I]=o.useState("all"),[d,b]=o.useState(!1),S=n.filter(t=>!(m!=="all"&&t.status!==m||x!=="all"&&t.category!==x||u!=="all"&&t.riskLevel!==u)),q=n.length,P=n.filter(t=>t.status==="active").length,f=n.flatMap(t=>t.controls).filter(t=>t.status==="failing").length,y=g.filter(t=>t.status==="pending").length,p=n.reduce((t,r)=>t+r.totalControls,0),E=n.reduce((t,r)=>t+r.passingControls,0),h=p>0?Math.round(E/p*100):0,D=[{id:"policies",label:"Policies"},{id:"controls",label:"Controls"},{id:"exceptions",label:`Exceptions (${g.length})`},{id:"audit",label:"Audit Log"}];return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Compliance Policy Editor"}),e.jsx("p",{className:"text-zinc-400 text-sm mt-1",children:"Manage compliance policies, controls, and exception tracking"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 text-sm bg-zinc-800 hover:bg-zinc-700 rounded-lg text-zinc-300 transition-colors",children:"Export PDF"}),e.jsx("button",{className:"px-3 py-1.5 text-sm bg-indigo-600 hover:bg-indigo-500 rounded-lg text-white transition-colors",children:"+ New Policy"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 border border-zinc-800",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Active Policies"}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[P,e.jsxs("span",{className:"text-sm text-zinc-500 font-normal",children:["/",q]})]})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 border border-zinc-800",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Control Pass Rate"}),e.jsxs("div",{className:a("text-2xl font-bold",h>=80?"text-emerald-400":h>=60?"text-amber-400":"text-rose-400"),children:[h,"%"]})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 border border-zinc-800",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Failing Controls"}),e.jsx("div",{className:a("text-2xl font-bold",f>0?"text-rose-400":"text-emerald-400"),children:f})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 border border-zinc-800",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Open Exceptions"}),e.jsx("div",{className:a("text-2xl font-bold",y>0?"text-amber-400":"text-zinc-400"),children:y})]})]}),e.jsx("div",{className:"flex gap-1 border-b border-zinc-800 mb-6",children:D.map(t=>e.jsx("button",{onClick:()=>{c(t.id),l(null)},className:a("px-4 py-2 text-sm font-medium transition-colors border-b-2 -mb-px",s===t.id?"border-indigo-500 text-white":"border-transparent text-zinc-400 hover:text-zinc-200"),children:t.label},t.id))}),s==="policies"&&!i&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsxs("select",{value:m,onChange:t=>k(t.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-1.5 text-sm text-zinc-200",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"review",children:"In Review"}),e.jsx("option",{value:"archived",children:"Archived"})]}),e.jsxs("select",{value:x,onChange:t=>T(t.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-1.5 text-sm text-zinc-200",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"data-privacy",children:"Data Privacy"}),e.jsx("option",{value:"access-control",children:"Access Control"}),e.jsx("option",{value:"security",children:"Security"}),e.jsx("option",{value:"operational",children:"Operational"}),e.jsx("option",{value:"financial",children:"Financial"})]}),e.jsxs("select",{value:u,onChange:t=>I(t.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-1.5 text-sm text-zinc-200",children:[e.jsx("option",{value:"all",children:"All Risk"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]}),e.jsx("div",{className:"space-y-3",children:S.map(t=>e.jsxs("div",{onClick:()=>l(t),className:"bg-zinc-900 rounded-xl p-4 border border-zinc-800 hover:border-zinc-600 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("span",{className:"font-semibold text-zinc-100",children:t.name}),e.jsxs("span",{className:"text-xs text-zinc-500",children:["v",t.version]}),e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full capitalize",N(t.status)),children:t.status}),e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full capitalize",v(t.riskLevel)),children:t.riskLevel})]}),e.jsxs("div",{className:"text-xs text-zinc-400",children:[C(t.category)," · ",t.framework]}),e.jsxs("div",{className:"text-xs text-zinc-500 mt-0.5",children:["Owner: ",t.owner," · Review: ",t.reviewDate]})]}),e.jsxs("div",{className:"text-right text-xs text-zinc-500",children:[t.exceptions>0&&e.jsxs("div",{className:"text-amber-400 mb-1",children:[t.exceptions," exception",t.exceptions!==1?"s":""]}),e.jsxs("div",{children:["Last audit: ",t.lastAudit]})]})]}),e.jsx(A,{passing:t.passingControls,total:t.totalControls})]},t.id))})]}),s==="policies"&&i&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>{l(null),b(!1)},className:"flex items-center gap-1 text-sm text-zinc-400 hover:text-zinc-200 transition-colors",children:"← Back to policies"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>b(!d),className:a("px-3 py-1.5 text-sm rounded-lg transition-colors",d?"bg-indigo-600 text-white":"bg-zinc-800 hover:bg-zinc-700 text-zinc-300"),children:d?"Editing...":"Edit Policy"}),d&&e.jsx("button",{className:"px-3 py-1.5 text-sm bg-emerald-600 hover:bg-emerald-500 rounded-lg text-white transition-colors",children:"Save Changes"})]})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800 mb-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:i.name}),e.jsxs("span",{className:"text-sm text-zinc-500",children:["v",i.version]}),e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full",N(i.status)),children:i.status}),e.jsxs("span",{className:a("text-xs px-2 py-0.5 rounded-full",v(i.riskLevel)),children:[i.riskLevel," risk"]})]}),e.jsxs("div",{className:"text-sm text-zinc-400",children:[C(i.category)," · ",i.framework]}),e.jsxs("div",{className:"text-xs text-zinc-500 mt-1",children:["Owner: ",i.owner," · Effective: ",i.effectiveDate," · Review: ",i.reviewDate]})]}),e.jsx(A,{passing:i.passingControls,total:i.totalControls})]}),e.jsx("p",{className:"text-sm text-zinc-300 leading-relaxed",children:i.description}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-3",children:i.tags.map(t=>e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-zinc-700 text-zinc-300",children:t},t))})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800 mb-5",children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-300 mb-4",children:"Policy Rules"}),e.jsx("div",{className:"space-y-2",children:i.rules.map(t=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-zinc-800 rounded-lg",children:[e.jsx("div",{className:a("w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0",t.required?"bg-rose-400":"bg-zinc-500")}),e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:"text-sm text-zinc-200",children:t.text})}),e.jsx("span",{className:a("text-xs px-1.5 py-0.5 rounded flex-shrink-0",t.required?"bg-rose-400/10 text-rose-400":"bg-zinc-600 text-zinc-400"),children:t.required?"Required":"Recommended"})]},t.id))})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800",children:[e.jsxs("h3",{className:"text-sm font-medium text-zinc-300 mb-4",children:["Controls (",i.controls.length,")"]}),e.jsx("div",{className:"space-y-3",children:i.controls.map(t=>e.jsxs("div",{className:"p-4 bg-zinc-800 rounded-lg border border-zinc-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:a("w-2.5 h-2.5 rounded-full flex-shrink-0",w(t.status))}),e.jsx("span",{className:"font-medium text-zinc-200 text-sm",children:t.name}),e.jsx("span",{className:a("text-xs capitalize",z(t.status)),children:t.status.replace("-"," ")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-zinc-500 capitalize",children:t.evidenceType}),t.automationId&&e.jsxs("span",{className:"text-xs text-indigo-400",children:["⚙ ",t.automationId]})]})]}),e.jsx("p",{className:"text-xs text-zinc-400 ml-5 mb-2",children:t.description}),e.jsxs("div",{className:"flex justify-between text-xs text-zinc-500 ml-5",children:[e.jsxs("span",{children:["Owner: ",t.owner]}),e.jsxs("span",{children:["Last tested: ",t.lastTested]})]})]},t.id))})]})]}),s==="controls"&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 text-xs text-zinc-500",children:[p," total controls across ",n.length," policies"]}),e.jsx("div",{className:"space-y-2",children:n.flatMap(t=>t.controls.map(r=>({...r,policyName:t.name,policyRisk:t.riskLevel}))).sort((t,r)=>{const j={failing:0,warning:1,"not-tested":2,passing:3};return j[t.status]-j[r.status]}).map(t=>e.jsx("div",{className:a("bg-zinc-900 rounded-xl p-4 border transition-colors",t.status==="failing"?"border-rose-500/30":t.status==="warning"?"border-amber-500/20":"border-zinc-800"),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:a("w-2.5 h-2.5 rounded-full mt-1 flex-shrink-0",w(t.status))}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-zinc-200 text-sm",children:t.name}),e.jsxs("div",{className:"text-xs text-zinc-500 mt-0.5",children:[t.policyName," · Owner: ",t.owner]}),e.jsx("div",{className:"text-xs text-zinc-400 mt-1",children:t.description})]})]}),e.jsxs("div",{className:"text-right text-xs text-zinc-500",children:[e.jsx("div",{className:a("mb-1 capitalize font-medium",z(t.status)),children:t.status.replace("-"," ")}),e.jsx("div",{children:t.lastTested==="never"?"Never tested":`Tested: ${t.lastTested}`}),e.jsx("div",{className:"mt-1 capitalize",children:t.evidenceType})]})]})},t.id))})]}),s==="exceptions"&&e.jsx("div",{className:"space-y-3",children:g.map(t=>e.jsxs("div",{className:a("bg-zinc-900 rounded-xl p-4 border",t.status==="pending"?"border-amber-500/30":"border-zinc-800"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-zinc-100",children:t.policyName}),e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full capitalize",M(t.status)),children:t.status}),e.jsxs("span",{className:a("text-xs px-2 py-0.5 rounded-full capitalize",v(t.riskAccepted)),children:[t.riskAccepted," risk accepted"]})]}),e.jsxs("div",{className:"text-xs text-zinc-500",children:["Requester: ",t.requester]})]}),e.jsxs("div",{className:"text-right text-xs text-zinc-500",children:[e.jsxs("div",{children:["Submitted: ",t.submittedAt]}),e.jsxs("div",{children:["Expires: ",t.expiresAt]}),t.approver&&e.jsxs("div",{className:"text-emerald-400 mt-1",children:["Approved by: ",t.approver]})]})]}),e.jsx("div",{className:"text-sm text-zinc-300 bg-zinc-800 rounded-lg p-3",children:t.reason}),t.status==="pending"&&e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{className:"px-3 py-1.5 text-xs bg-emerald-600 hover:bg-emerald-500 rounded-lg text-white transition-colors",children:"Approve"}),e.jsx("button",{className:"px-3 py-1.5 text-xs bg-rose-600 hover:bg-rose-500 rounded-lg text-white transition-colors",children:"Deny"}),e.jsx("button",{className:"px-3 py-1.5 text-xs bg-zinc-700 hover:bg-zinc-600 rounded-lg text-zinc-300 transition-colors",children:"Request Info"})]})]},t.id))}),s==="audit"&&e.jsx("div",{children:e.jsx("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-zinc-700",children:["Timestamp","Policy","Action","User","Before → After"].map(t=>e.jsx("th",{className:"px-4 py-3 text-left text-xs text-zinc-500 font-medium",children:t},t))})}),e.jsx("tbody",{className:"divide-y divide-zinc-800",children:R.map(t=>e.jsxs("tr",{className:"hover:bg-zinc-800/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-xs text-zinc-400 whitespace-nowrap",children:t.timestamp}),e.jsx("td",{className:"px-4 py-3 text-sm text-zinc-200",children:t.policyName}),e.jsx("td",{className:"px-4 py-3 text-xs text-zinc-300",children:t.action}),e.jsx("td",{className:"px-4 py-3 text-xs text-zinc-400",children:t.user}),e.jsxs("td",{className:"px-4 py-3 text-xs",children:[e.jsx("span",{className:"text-zinc-500",children:t.before}),e.jsx("span",{className:"text-zinc-600 mx-1",children:"→"}),e.jsx("span",{className:"text-zinc-300",children:t.after})]})]},t.id))})]})})})]})}export{O as default};
