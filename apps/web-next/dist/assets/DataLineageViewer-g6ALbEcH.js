import{r as x,j as e,c as d}from"./index-CaqN0wrg.js";const n=[{id:"src-postgres",name:"Production Postgres",kind:"source",system:"PostgreSQL 15",description:"Primary operational database containing user, session, and billing records.",owner:"platform-core",tags:["pii","operational","tier-1"],recordCount:428e4,lastUpdated:"2026-02-22T06:01:00Z",upstreamIds:[]},{id:"src-kafka",name:"Event Stream (Kafka)",kind:"source",system:"Apache Kafka 3.6",description:"Real-time event stream: clicks, page views, API calls.",owner:"platform-core",tags:["events","real-time"],recordCount:182e6,lastUpdated:"2026-02-22T06:10:00Z",upstreamIds:[]},{id:"src-s3-raw",name:"S3 Raw Ingest",kind:"source",system:"AWS S3",description:"Raw file drops: CSV exports, webhook payloads, third-party feeds.",owner:"data-eng",tags:["raw","batch"],recordCount:22e6,lastUpdated:"2026-02-21T23:00:00Z",upstreamIds:[]},{id:"tf-clean",name:"Data Cleaning",kind:"transform",system:"Apache Spark 3.5",description:"Deduplication, null handling, type coercion, PII masking.",owner:"data-eng",tags:["etl","pii-mask"],recordCount:4155e3,lastUpdated:"2026-02-22T06:05:00Z",upstreamIds:["src-postgres","src-s3-raw"]},{id:"tf-enrich",name:"Event Enrichment",kind:"transform",system:"Apache Spark 3.5",description:"Joins event stream with user dimension, adds geo/device attributes.",owner:"data-eng",tags:["enrichment","join"],recordCount:178e6,lastUpdated:"2026-02-22T06:12:00Z",upstreamIds:["src-kafka","tf-clean"]},{id:"tf-aggregate",name:"Metric Aggregation",kind:"transform",system:"dbt",description:"Rolls up enriched events into hourly and daily metric tables.",owner:"analytics",tags:["metrics","aggregation"],recordCount:84e5,lastUpdated:"2026-02-22T06:20:00Z",upstreamIds:["tf-enrich"]},{id:"tf-ml-features",name:"ML Feature Store",kind:"transform",system:"Feast + Spark",description:"Computes user-level features: engagement score, churn risk, LTV.",owner:"ml-team",tags:["ml","features","real-time"],recordCount:12e5,lastUpdated:"2026-02-22T06:15:00Z",upstreamIds:["tf-enrich","tf-aggregate"]},{id:"store-warehouse",name:"Data Warehouse (Snowflake)",kind:"storage",system:"Snowflake",description:"Central analytical warehouse. Source of truth for BI and ad-hoc analysis.",owner:"data-eng",tags:["warehouse","analytical"],recordCount:24e7,lastUpdated:"2026-02-22T06:25:00Z",upstreamIds:["tf-clean","tf-aggregate"]},{id:"store-feature-db",name:"Feature Store DB",kind:"storage",system:"Redis + Parquet",description:"Online and offline feature store for ML serving.",owner:"ml-team",tags:["ml","features"],recordCount:12e5,lastUpdated:"2026-02-22T06:16:00Z",upstreamIds:["tf-ml-features"]},{id:"sink-bi",name:"BI Dashboard Layer",kind:"sink",system:"Looker",description:"Business intelligence dashboards served to stakeholders.",owner:"analytics",tags:["bi","reporting"],recordCount:84e5,lastUpdated:"2026-02-22T06:30:00Z",upstreamIds:["store-warehouse"]},{id:"sink-ml-serving",name:"ML Model Serving",kind:"sink",system:"KServe",description:"Online model serving endpoints powered by feature store.",owner:"ml-team",tags:["ml","serving"],recordCount:0,lastUpdated:"2026-02-22T06:00:00Z",upstreamIds:["store-feature-db"]},{id:"sink-reverse-etl",name:"Reverse ETL â†’ CRM",kind:"sink",system:"Census",description:"Syncs enriched user segments back to Salesforce and HubSpot.",owner:"growth",tags:["crm","reverse-etl"],recordCount:62e4,lastUpdated:"2026-02-22T05:00:00Z",upstreamIds:["store-warehouse"]}],u=[{id:"run-001",pipelineName:"daily-etl-full",startedAt:"2026-02-22T04:00:00Z",duration:"1h 22m",status:"success",rowsProcessed:4155e3,nodesVisited:["src-postgres","src-s3-raw","tf-clean","tf-aggregate","store-warehouse"]},{id:"run-002",pipelineName:"event-enrichment-stream",startedAt:"2026-02-22T06:00:00Z",duration:"14m",status:"running",rowsProcessed:94e6,nodesVisited:["src-kafka","tf-clean","tf-enrich"]},{id:"run-003",pipelineName:"ml-feature-refresh",startedAt:"2026-02-22T05:45:00Z",duration:"28m",status:"success",rowsProcessed:12e5,nodesVisited:["tf-enrich","tf-aggregate","tf-ml-features","store-feature-db"]},{id:"run-004",pipelineName:"reverse-etl-crm-sync",startedAt:"2026-02-22T05:00:00Z",duration:"11m",status:"partial",rowsProcessed:612e3,nodesVisited:["store-warehouse","sink-reverse-etl"]},{id:"run-005",pipelineName:"bi-snapshot-refresh",startedAt:"2026-02-21T22:00:00Z",duration:"8m",status:"failed",rowsProcessed:0,nodesVisited:["store-warehouse","sink-bi"]},{id:"run-006",pipelineName:"daily-etl-full",startedAt:"2026-02-21T04:00:00Z",duration:"1h 18m",status:"success",rowsProcessed:4102e3,nodesVisited:["src-postgres","src-s3-raw","tf-clean","tf-aggregate","store-warehouse"]}],h=[{datasetId:"src-postgres",datasetName:"Production Postgres",downstreamCount:7,upstreamCount:0,criticalPath:!0},{datasetId:"src-kafka",datasetName:"Event Stream (Kafka)",downstreamCount:6,upstreamCount:0,criticalPath:!0},{datasetId:"tf-enrich",datasetName:"Event Enrichment",downstreamCount:5,upstreamCount:2,criticalPath:!0},{datasetId:"tf-aggregate",datasetName:"Metric Aggregation",downstreamCount:4,upstreamCount:1,criticalPath:!0},{datasetId:"store-warehouse",datasetName:"Data Warehouse",downstreamCount:3,upstreamCount:2,criticalPath:!0},{datasetId:"tf-ml-features",datasetName:"ML Feature Store",downstreamCount:2,upstreamCount:2,criticalPath:!1},{datasetId:"store-feature-db",datasetName:"Feature Store DB",downstreamCount:1,upstreamCount:1,criticalPath:!1},{datasetId:"tf-clean",datasetName:"Data Cleaning",downstreamCount:3,upstreamCount:2,criticalPath:!0}];function m(t){return{source:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30",transform:"bg-indigo-500/20 text-indigo-400 border-indigo-500/30",sink:"bg-amber-500/20 text-amber-400 border-amber-500/30",storage:"bg-blue-500/20 text-blue-400 border-blue-500/30"}[t]}function N(t){return{source:"â¬†",transform:"âš™",sink:"â¬‡",storage:"ðŸ—„"}[t]}function f(t){return{success:"text-emerald-400",failed:"text-rose-400",running:"text-indigo-400",partial:"text-amber-400"}[t]}function b(t){return{success:"bg-emerald-400",failed:"bg-rose-400",running:"bg-indigo-400 animate-pulse",partial:"bg-amber-400"}[t]}function p(t){return t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(0)+"K":String(t)}function j(){const[t,i]=x.useState(null),[s,l]=x.useState("all");s==="all"||n.filter(a=>a.kind===s);const o={source:n.filter(a=>a.kind==="source"),transform:n.filter(a=>a.kind==="transform"),storage:n.filter(a=>a.kind==="storage"),sink:n.filter(a=>a.kind==="sink")};return e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex gap-2 mb-4",children:["all","source","transform","storage","sink"].map(a=>e.jsx("button",{onClick:()=>l(a),className:d("px-3 py-1 rounded-full text-xs font-medium transition-colors capitalize",s===a?"bg-indigo-600 text-white":"bg-zinc-800 text-zinc-400 hover:text-white"),children:a},a))}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2",children:["source","transform","storage","sink"].map(a=>{const r=o[a].filter(c=>s==="all"||c.kind===s);return r.length===0?null:e.jsxs("div",{className:"shrink-0 w-44 space-y-2",children:[e.jsx("div",{className:"text-xs font-semibold text-zinc-500 uppercase tracking-wider text-center mb-3",children:a}),r.map(c=>{const g=(t==null?void 0:t.id)===c.id;return e.jsxs("button",{onClick:()=>i(g?null:c),className:d("w-full text-left rounded-xl border p-3 transition-all",g?"border-indigo-500 bg-indigo-500/10":"border-zinc-800 bg-zinc-900 hover:border-zinc-600"),children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx("span",{className:"text-sm",children:N(c.kind)}),e.jsx("span",{className:d("text-xs px-1.5 py-0.5 rounded border capitalize",m(c.kind)),children:c.kind})]}),e.jsx("div",{className:"text-xs font-semibold text-white leading-tight",children:c.name}),e.jsx("div",{className:"text-xs text-zinc-500 mt-1",children:c.system}),e.jsxs("div",{className:"text-xs text-zinc-400 mt-1",children:[p(c.recordCount)," rows"]})]},c.id)})]},a)})})]}),e.jsx("div",{className:"w-72 shrink-0",children:t?e.jsxs("div",{className:"rounded-xl border border-zinc-800 bg-zinc-900 p-5 space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:d("text-xs px-2 py-0.5 rounded border capitalize",m(t.kind)),children:t.kind})}),e.jsx("h3",{className:"text-white font-semibold",children:t.name}),e.jsx("p",{className:"text-xs text-zinc-400 mt-1",children:t.system})]}),e.jsx("p",{className:"text-sm text-zinc-300",children:t.description}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-zinc-500",children:"Owner"}),e.jsx("span",{className:"text-zinc-300",children:t.owner})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-zinc-500",children:"Records"}),e.jsx("span",{className:"text-zinc-300",children:p(t.recordCount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-zinc-500",children:"Last updated"}),e.jsxs("span",{className:"text-zinc-300",children:[t.lastUpdated.slice(11,16)," UTC"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-zinc-500",children:"Upstream"}),e.jsxs("span",{className:"text-zinc-300",children:[t.upstreamIds.length," nodes"]})]})]}),t.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:t.tags.map(a=>e.jsx("span",{className:"text-xs bg-zinc-800 text-zinc-400 rounded px-2 py-0.5",children:a},a))}),t.upstreamIds.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Upstream nodes"}),e.jsx("div",{className:"space-y-1",children:t.upstreamIds.map(a=>{const r=n.find(c=>c.id===a);return r?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:d("text-xs px-1.5 py-0.5 rounded border capitalize",m(r.kind)),children:r.kind}),e.jsx("span",{className:"text-xs text-zinc-300",children:r.name})]},a):null})})]})]}):e.jsx("div",{className:"flex items-center justify-center h-40 text-zinc-500 text-sm rounded-xl border border-zinc-800 bg-zinc-900",children:"Click a node to inspect"})})]})}function w(){const[t,i]=x.useState(null);return e.jsx("div",{className:"space-y-3",children:u.map(s=>e.jsxs("div",{className:d("rounded-xl border p-4 cursor-pointer transition-all",(t==null?void 0:t.id)===s.id?"border-indigo-500 bg-indigo-500/5":"border-zinc-800 bg-zinc-900 hover:border-zinc-600"),onClick:()=>i((t==null?void 0:t.id)===s.id?null:s),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:d("w-2 h-2 rounded-full shrink-0",b(s.status))}),e.jsx("span",{className:"font-medium text-white text-sm",children:s.pipelineName}),e.jsx("span",{className:d("text-xs font-semibold ml-auto capitalize",f(s.status)),children:s.status})]}),e.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-zinc-500",children:[e.jsx("span",{children:s.startedAt.slice(0,16).replace("T"," ")}),e.jsxs("span",{children:["â± ",s.duration]}),e.jsxs("span",{children:["ðŸ“¦ ",p(s.rowsProcessed)," rows"]}),e.jsxs("span",{children:["ðŸ”— ",s.nodesVisited.length," nodes"]})]}),(t==null?void 0:t.id)===s.id&&e.jsxs("div",{className:"mt-4 border-t border-zinc-800 pt-4",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-2",children:"Nodes visited (in order)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.nodesVisited.map((l,o)=>{const a=n.find(r=>r.id===l);return e.jsxs("div",{className:"flex items-center gap-1",children:[o>0&&e.jsx("span",{className:"text-zinc-600 text-xs",children:"â†’"}),e.jsx("span",{className:d("text-xs px-2 py-0.5 rounded border",a?m(a.kind):"bg-zinc-800 text-zinc-400 border-zinc-700"),children:(a==null?void 0:a.name)??l})]},l)})})]})]},s.id))})}function v(){const t=[...h].sort((s,l)=>l.downstreamCount-s.downstreamCount),i=Math.max(...t.map(s=>s.downstreamCount));return e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-zinc-400 mb-4",children:"Downstream impact scores â€” how many nodes depend on each dataset. Critical path datasets affect the most downstream consumers."}),t.map(s=>e.jsxs("div",{className:"rounded-xl border border-zinc-800 bg-zinc-900 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("span",{className:"font-medium text-white text-sm",children:s.datasetName}),s.criticalPath&&e.jsx("span",{className:"text-xs bg-rose-500/20 text-rose-400 border border-rose-500/30 rounded px-2 py-0.5",children:"Critical Path"}),e.jsxs("span",{className:"ml-auto text-xs text-zinc-500",children:[s.upstreamCount," up Â· ",s.downstreamCount," down"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-zinc-500 w-24",children:"Downstream"}),e.jsx("div",{className:"flex-1 bg-zinc-800 rounded-full h-2",children:e.jsx("div",{className:d("h-2 rounded-full",s.criticalPath?"bg-rose-500":"bg-indigo-500"),style:{width:s.downstreamCount/i*100+"%"}})}),e.jsx("span",{className:"text-xs font-bold text-white w-6 text-right",children:s.downstreamCount})]})]},s.datasetId))]})}function k(){const t=[{label:"Nodes Tracked",value:n.length.toString(),sub:"across 4 types",color:"text-white"},{label:"Active Pipelines",value:"6",sub:"3 scheduled, 3 streaming",color:"text-white"},{label:"Last Full Run",value:"1h 22m",sub:"completed 06:25 UTC",color:"text-emerald-400"},{label:"Failed Runs (24h)",value:"1",sub:"bi-snapshot-refresh",color:"text-rose-400"},{label:"Total Records",value:p(n.reduce((s,l)=>s+l.recordCount,0)),sub:"across all nodes",color:"text-white"},{label:"Critical Path Nodes",value:h.filter(s=>s.criticalPath).length.toString(),sub:"require priority SLA",color:"text-amber-400"}],i={};return n.forEach(s=>{i[s.owner]=(i[s.owner]??0)+1}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-3 gap-4",children:t.map(s=>e.jsxs("div",{className:"rounded-xl border border-zinc-800 bg-zinc-900 p-4",children:[e.jsx("div",{className:d("text-2xl font-bold mb-1",s.color),children:s.value}),e.jsx("div",{className:"text-sm font-medium text-white",children:s.label}),e.jsx("div",{className:"text-xs text-zinc-500 mt-0.5",children:s.sub})]},s.label))}),e.jsxs("div",{className:"rounded-xl border border-zinc-800 bg-zinc-900 p-5",children:[e.jsx("h3",{className:"text-sm font-semibold text-white mb-4",children:"Ownership Breakdown"}),e.jsx("div",{className:"space-y-3",children:Object.entries(i).map(([s,l])=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-28 text-xs text-zinc-400 shrink-0",children:s}),e.jsx("div",{className:"flex-1 bg-zinc-800 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full bg-indigo-500",style:{width:l/n.length*100+"%"}})}),e.jsx("span",{className:"text-xs text-zinc-300 w-6 text-right",children:l})]},s))})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-800 bg-zinc-900 p-5",children:[e.jsx("h3",{className:"text-sm font-semibold text-white mb-4",children:"Pipeline Run History (last 6)"}),e.jsx("div",{className:"space-y-2",children:u.map(s=>e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[e.jsx("span",{className:d("w-2 h-2 rounded-full shrink-0",b(s.status))}),e.jsx("span",{className:"text-zinc-300 w-44 truncate",children:s.pipelineName}),e.jsx("span",{className:"text-zinc-500",children:s.startedAt.slice(5,16).replace("T"," ")}),e.jsx("span",{className:d("ml-auto capitalize",f(s.status)),children:s.status})]},s.id))})]})]})}const z=["Graph","Runs","Impact","Quality"];function C(){const[t,i]=x.useState("Graph"),s=n.filter(r=>r.kind==="source").length,l=n.filter(r=>r.kind==="transform").length,o=u.filter(r=>r.status==="running").length,a=u.filter(r=>r.status==="failed").length;return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-1",children:"Data Lineage Viewer"}),e.jsxs("p",{className:"text-zinc-400 text-sm",children:["End-to-end data flow visualization â€” ",n.length," nodes, ",s," sources â†’ ",l," transforms â†’ sinks"]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[{label:"Pipeline Nodes",value:n.length,color:"text-white"},{label:"Active Runs",value:o,color:"text-indigo-400"},{label:"Failed (24h)",value:a,color:a>0?"text-rose-400":"text-emerald-400"},{label:"Critical Path",value:h.filter(r=>r.criticalPath).length,color:"text-amber-400"}].map(r=>e.jsxs("div",{className:"rounded-xl border border-zinc-800 bg-zinc-900 p-4",children:[e.jsx("div",{className:d("text-3xl font-bold",r.color),children:r.value}),e.jsx("div",{className:"text-sm text-zinc-400 mt-1",children:r.label})]},r.label))}),e.jsx("div",{className:"flex gap-1 mb-6 border-b border-zinc-800",children:z.map(r=>e.jsx("button",{onClick:()=>i(r),className:d("px-4 py-2 text-sm font-medium border-b-2 transition-colors -mb-px",t===r?"border-indigo-500 text-indigo-400":"border-transparent text-zinc-400 hover:text-white"),children:r},r))}),t==="Graph"&&e.jsx(j,{}),t==="Runs"&&e.jsx(w,{}),t==="Impact"&&e.jsx(v,{}),t==="Quality"&&e.jsx(k,{})]})}export{C as default};
