import{r,j as e,c as a}from"./index-rWtyeRSA.js";const l=[{id:"r1",name:"Email Masking",strategy:"partial-mask",status:"active",sensitivity:"pii",fieldTypes:["email"],environments:["production","staging"],appliedTo:[{name:"email",type:"email",table:"users",database:"app_db",rowCount:245e3,sensitivity:"pii"},{name:"contact_email",type:"email",table:"contacts",database:"crm_db",rowCount:18200,sensitivity:"pii"}],createdBy:"admin@co.com",createdAt:"2025-01-15",updatedAt:"2026-01-10",description:"Partially masks email addresses, preserving domain for analytics. E.g. jo**@example.com",example:{original:"john.smith@example.com",masked:"jo**@example.com"},executionCount:1482e3,lastExecuted:"2026-02-22 06:00"},{id:"r2",name:"SSN Full Redaction",strategy:"full-redact",status:"active",sensitivity:"pii",fieldTypes:["ssn"],environments:["production","staging","development"],appliedTo:[{name:"ssn",type:"ssn",table:"employees",database:"hr_db",rowCount:1240,sensitivity:"pii"}],createdBy:"compliance@co.com",createdAt:"2024-08-01",updatedAt:"2025-09-20",description:"Completely redacts Social Security Numbers to *** in all environments.",example:{original:"123-45-6789",masked:"***-**-****"},executionCount:62e4,lastExecuted:"2026-02-22 06:00"},{id:"r3",name:"Credit Card Tokenization",strategy:"tokenize",status:"active",sensitivity:"pci",fieldTypes:["credit-card"],environments:["production"],appliedTo:[{name:"card_number",type:"credit-card",table:"payments",database:"billing_db",rowCount:89400,sensitivity:"pci"},{name:"billing_card",type:"credit-card",table:"subscriptions",database:"billing_db",rowCount:42100,sensitivity:"pci"}],createdBy:"security@co.com",createdAt:"2024-06-01",updatedAt:"2026-02-01",description:"Replaces credit card numbers with irreversible tokens. Last 4 digits preserved.",example:{original:"4111-1111-1111-1234",masked:"tok_****-****-****-1234"},executionCount:394e4,lastExecuted:"2026-02-22 04:00"},{id:"r4",name:"Phone Number Masking",strategy:"partial-mask",status:"active",sensitivity:"pii",fieldTypes:["phone"],environments:["production","staging"],appliedTo:[{name:"phone",type:"phone",table:"users",database:"app_db",rowCount:22e4,sensitivity:"pii"},{name:"mobile",type:"phone",table:"contacts",database:"crm_db",rowCount:15600,sensitivity:"pii"}],createdBy:"admin@co.com",createdAt:"2025-03-01",updatedAt:"2025-11-01",description:"Masks middle digits of phone numbers, preserving country code and last 2 digits.",example:{original:"+1 (555) 867-5309",masked:"+1 (***) ***-09"},executionCount:89e4,lastExecuted:"2026-02-22 06:00"},{id:"r5",name:"Date of Birth Pseudonymize",strategy:"pseudonymize",status:"active",sensitivity:"pii",fieldTypes:["dob"],environments:["production","staging"],appliedTo:[{name:"date_of_birth",type:"dob",table:"patients",database:"health_db",rowCount:54200,sensitivity:"phi"}],createdBy:"compliance@co.com",createdAt:"2025-05-01",updatedAt:"2025-10-01",description:"Shifts date of birth by a deterministic random offset per patient, preserving age range for analytics.",example:{original:"1985-07-14",masked:"1985-07-21"},executionCount:218e3,lastExecuted:"2026-02-22 05:00"},{id:"r6",name:"IP Address Hashing",strategy:"hash",status:"draft",sensitivity:"pii",fieldTypes:["ip"],environments:[],appliedTo:[],createdBy:"security@co.com",createdAt:"2026-02-10",updatedAt:"2026-02-10",description:"SHA-256 hash of IP addresses for analytics without exposing user location.",example:{original:"192.168.1.100",masked:"sha256:a4b2c3..."},executionCount:0,lastExecuted:null}],_=[{id:"s1",name:"Full Discovery Scan — Feb 2026",databases:["app_db","crm_db","billing_db","hr_db","health_db"],status:"completed",startedAt:"2026-02-22 02:00",completedAt:"2026-02-22 04:32",fieldsDiscovered:1840,fieldsMatched:412,coverage:98.4,rulesApplied:5},{id:"s2",name:"Billing DB Scan",databases:["billing_db"],status:"completed",startedAt:"2026-02-15 03:00",completedAt:"2026-02-15 03:45",fieldsDiscovered:284,fieldsMatched:89,coverage:100,rulesApplied:1},{id:"s3",name:"HR Database Scan",databases:["hr_db"],status:"failed",startedAt:"2026-02-10 06:00",completedAt:"2026-02-10 06:12",fieldsDiscovered:0,fieldsMatched:0,coverage:0,rulesApplied:0},{id:"s4",name:"Weekly Automated Scan",databases:["app_db","crm_db"],status:"scheduled",startedAt:"2026-03-01 02:00",completedAt:null,fieldsDiscovered:0,fieldsMatched:0,coverage:0,rulesApplied:0}],u=[{id:"v1",fieldName:"ip_address",database:"analytics_db",table:"events",sensitivity:"pii",environment:"production",discoveredAt:"2026-02-22 04:32",ruleId:null,status:"open"},{id:"v2",fieldName:"raw_email",database:"logs_db",table:"email_log",sensitivity:"pii",environment:"production",discoveredAt:"2026-02-22 04:32",ruleId:"r1",status:"open"},{id:"v3",fieldName:"patient_name",database:"health_db",table:"appointments",sensitivity:"phi",environment:"staging",discoveredAt:"2026-02-15 03:45",ruleId:null,status:"accepted"},{id:"v4",fieldName:"card_cvv",database:"billing_db",table:"payment_methods",sensitivity:"pci",environment:"production",discoveredAt:"2026-01-20 10:00",ruleId:null,status:"remediated"}];function b(i){return{"full-redact":"bg-rose-500/10 text-rose-400","partial-mask":"bg-amber-500/10 text-amber-400",tokenize:"bg-indigo-500/10 text-indigo-400",hash:"bg-purple-500/10 text-purple-400",pseudonymize:"bg-blue-500/10 text-blue-400",encrypt:"bg-emerald-500/10 text-emerald-400"}[i]}function d(i){return{pii:"bg-rose-500/10 text-rose-400",phi:"bg-purple-500/10 text-purple-400",pci:"bg-orange-500/10 text-orange-400",financial:"bg-amber-500/10 text-amber-400",confidential:"bg-indigo-500/10 text-indigo-400",internal:"bg-zinc-500/10 text-zinc-400"}[i]}function v(i){return i==="active"?"bg-emerald-400/10 text-emerald-400":i==="inactive"?"bg-zinc-600 text-zinc-400":"bg-amber-400/10 text-amber-400"}function S(i){return i==="completed"?"bg-emerald-400/10 text-emerald-400":i==="running"?"bg-indigo-400/10 text-indigo-400":i==="failed"?"bg-rose-400/10 text-rose-400":"bg-zinc-500/10 text-zinc-400"}function w(i){return i==="open"?"bg-rose-400/10 text-rose-400":i==="remediated"?"bg-emerald-400/10 text-emerald-400":"bg-zinc-600 text-zinc-400"}function T(){const[i,c]=r.useState("rules"),[s,o]=r.useState(null),[x,h]=r.useState("all"),[m,g]=r.useState("all"),j=l.filter(t=>!(x!=="all"&&t.status!==x||m!=="all"&&t.sensitivity!==m)),f=l.filter(t=>t.status==="active").length,N=l.reduce((t,n)=>t+n.appliedTo.length,0),y=l.reduce((t,n)=>t+n.executionCount,0),p=u.filter(t=>t.status==="open").length,z=[{id:"rules",label:`Rules (${l.length})`},{id:"scans",label:"Discovery Scans"},{id:"violations",label:`Violations (${p} open)`},{id:"coverage",label:"Coverage"}],A=[{name:"app_db",covered:98,sensitive:245,total:1840},{name:"billing_db",covered:100,sensitive:131,total:284},{name:"hr_db",covered:0,sensitive:24,total:180},{name:"health_db",covered:95,sensitive:88,total:320},{name:"crm_db",covered:92,sensitive:64,total:440}];return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Data Masking Manager"}),e.jsx("p",{className:"text-zinc-400 text-sm mt-1",children:"Configure and enforce data masking policies across all environments"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 text-sm bg-zinc-800 hover:bg-zinc-700 rounded-lg text-zinc-300 transition-colors",children:"Run Scan"}),e.jsx("button",{className:"px-3 py-1.5 text-sm bg-indigo-600 hover:bg-indigo-500 rounded-lg text-white transition-colors",children:"+ New Rule"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 border border-zinc-800",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Active Rules"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-400",children:f})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 border border-zinc-800",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Protected Fields"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:N})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 border border-zinc-800",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Total Executions"}),e.jsxs("div",{className:"text-2xl font-bold text-indigo-400",children:[(y/1e6).toFixed(1),"M"]})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 border border-zinc-800",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Open Violations"}),e.jsx("div",{className:a("text-2xl font-bold",p>0?"text-rose-400":"text-emerald-400"),children:p})]})]}),e.jsx("div",{className:"flex gap-1 border-b border-zinc-800 mb-6",children:z.map(t=>e.jsx("button",{onClick:()=>{c(t.id),o(null)},className:a("px-4 py-2 text-sm font-medium transition-colors border-b-2 -mb-px",i===t.id?"border-indigo-500 text-white":"border-transparent text-zinc-400 hover:text-zinc-200"),children:t.label},t.id))}),i==="rules"&&!s&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsxs("select",{value:x,onChange:t=>h(t.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-1.5 text-sm text-zinc-200",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"draft",children:"Draft"})]}),e.jsxs("select",{value:m,onChange:t=>g(t.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-1.5 text-sm text-zinc-200",children:[e.jsx("option",{value:"all",children:"All Sensitivity"}),e.jsx("option",{value:"pii",children:"PII"}),e.jsx("option",{value:"phi",children:"PHI"}),e.jsx("option",{value:"pci",children:"PCI"}),e.jsx("option",{value:"financial",children:"Financial"})]})]}),e.jsx("div",{className:"space-y-3",children:j.map(t=>e.jsxs("div",{onClick:()=>o(t),className:"bg-zinc-900 rounded-xl p-4 border border-zinc-800 hover:border-zinc-600 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("span",{className:"font-semibold text-zinc-100",children:t.name}),e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full capitalize",v(t.status)),children:t.status}),e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full capitalize",d(t.sensitivity)),children:t.sensitivity.toUpperCase()}),e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full capitalize",b(t.strategy)),children:t.strategy.replace("-"," ")})]}),e.jsx("div",{className:"text-xs text-zinc-400",children:t.description})]}),e.jsxs("div",{className:"text-right text-xs text-zinc-500 flex-shrink-0 ml-4",children:[e.jsxs("div",{children:[t.appliedTo.length," field",t.appliedTo.length!==1?"s":""]}),e.jsxs("div",{children:[t.executionCount.toLocaleString()," execs"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 p-2 bg-zinc-800 rounded-lg text-xs",children:[e.jsx("span",{className:"text-zinc-500",children:"Example:"}),e.jsx("span",{className:"text-zinc-400 font-mono",children:t.example.original}),e.jsx("span",{className:"text-zinc-600",children:"→"}),e.jsx("span",{className:"text-emerald-400 font-mono",children:t.example.masked})]})]},t.id))})]}),i==="rules"&&s&&e.jsxs("div",{children:[e.jsx("button",{onClick:()=>o(null),className:"flex items-center gap-1 text-sm text-zinc-400 hover:text-zinc-200 mb-4 transition-colors",children:"← Back to rules"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-5 mb-5",children:[e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:s.name}),e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full",v(s.status)),children:s.status})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full capitalize",d(s.sensitivity)),children:s.sensitivity.toUpperCase()}),e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full capitalize",b(s.strategy)),children:s.strategy.replace("-"," ")})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 text-xs bg-zinc-700 hover:bg-zinc-600 rounded-lg text-zinc-300 transition-colors",children:"Edit"}),s.status!=="active"&&e.jsx("button",{className:"px-3 py-1.5 text-xs bg-emerald-600 hover:bg-emerald-500 rounded-lg text-white transition-colors",children:"Activate"})]})]}),e.jsx("p",{className:"text-sm text-zinc-300 mb-4",children:s.description}),e.jsx("div",{className:"space-y-2 text-xs",children:[{label:"Created by",value:s.createdBy},{label:"Created",value:s.createdAt},{label:"Last updated",value:s.updatedAt},{label:"Last executed",value:s.lastExecuted??"Never"},{label:"Total executions",value:s.executionCount.toLocaleString()},{label:"Environments",value:s.environments.join(", ")||"None"}].map(t=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-zinc-500",children:t.label}),e.jsx("span",{className:"text-zinc-300",children:t.value})]},t.label))})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800",children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-300 mb-4",children:"Masking Example"}),e.jsxs("div",{className:"space-y-4 mb-5",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Original (sensitive)"}),e.jsx("div",{className:"bg-rose-500/10 border border-rose-500/20 rounded-lg px-3 py-2 font-mono text-sm text-rose-300",children:s.example.original})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"text-zinc-600 text-lg",children:"↓"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Masked output"}),e.jsx("div",{className:"bg-emerald-500/10 border border-emerald-500/20 rounded-lg px-3 py-2 font-mono text-sm text-emerald-300",children:s.example.masked})]})]}),e.jsxs("div",{className:"text-xs text-zinc-500",children:["Strategy: ",e.jsx("span",{className:"text-zinc-300 capitalize",children:s.strategy.replace("-"," ")})]}),e.jsxs("div",{className:"text-xs text-zinc-500 mt-1",children:["Field types: ",e.jsx("span",{className:"text-zinc-300",children:s.fieldTypes.join(", ")})]})]})]}),s.appliedTo.length>0&&e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800",children:[e.jsxs("h3",{className:"text-sm font-medium text-zinc-300 mb-4",children:["Applied Fields (",s.appliedTo.length,")"]}),e.jsx("div",{className:"space-y-2",children:s.appliedTo.map((t,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-zinc-800 rounded-lg",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-mono text-sm text-zinc-200",children:[t.database,".",t.table,".",t.name]}),e.jsx("span",{className:a("text-xs px-1.5 py-0.5 rounded-full",d(t.sensitivity)),children:t.sensitivity.toUpperCase()})]})}),e.jsxs("div",{className:"text-sm text-zinc-400",children:[t.rowCount.toLocaleString()," rows"]})]},n))})]})]}),i==="scans"&&e.jsx("div",{className:"space-y-3",children:_.map(t=>e.jsxs("div",{className:a("bg-zinc-900 rounded-xl p-4 border",t.status==="failed"?"border-rose-500/30":"border-zinc-800"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-zinc-100",children:t.name}),e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full capitalize",S(t.status)),children:t.status})]}),e.jsxs("div",{className:"text-xs text-zinc-500",children:["Databases: ",t.databases.join(", ")]})]}),e.jsxs("div",{className:"text-right text-xs text-zinc-500",children:[e.jsxs("div",{children:["Started: ",t.startedAt]}),t.completedAt&&e.jsxs("div",{children:["Completed: ",t.completedAt]})]})]}),t.status==="completed"&&e.jsxs("div",{className:"grid grid-cols-4 gap-3 text-xs mt-3 pt-3 border-t border-zinc-800",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-white",children:t.fieldsDiscovered.toLocaleString()}),e.jsx("div",{className:"text-zinc-500",children:"fields found"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-rose-400",children:t.fieldsMatched.toLocaleString()}),e.jsx("div",{className:"text-zinc-500",children:"sensitive"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:a("text-lg font-bold",t.coverage>=95?"text-emerald-400":t.coverage>=80?"text-amber-400":"text-rose-400"),children:[t.coverage,"%"]}),e.jsx("div",{className:"text-zinc-500",children:"coverage"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-indigo-400",children:t.rulesApplied}),e.jsx("div",{className:"text-zinc-500",children:"rules applied"})]})]})]},t.id))}),i==="violations"&&e.jsx("div",{className:"space-y-3",children:u.map(t=>e.jsx("div",{className:a("bg-zinc-900 rounded-xl p-4 border",t.status==="open"?"border-rose-500/30":"border-zinc-800"),children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"font-mono text-sm text-zinc-200",children:[t.database,".",t.table,".",t.fieldName]}),e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full",d(t.sensitivity)),children:t.sensitivity.toUpperCase()}),e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full capitalize",w(t.status)),children:t.status})]}),e.jsxs("div",{className:"text-xs text-zinc-500",children:["Environment: ",t.environment," · Discovered: ",t.discoveredAt]}),t.ruleId&&e.jsxs("div",{className:"text-xs text-indigo-400 mt-0.5",children:["Rule applicable: ",t.ruleId]}),!t.ruleId&&e.jsx("div",{className:"text-xs text-amber-400 mt-0.5",children:"No masking rule assigned"})]}),t.status==="open"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-2 py-1 text-xs bg-indigo-600 hover:bg-indigo-500 rounded text-white transition-colors",children:"Apply Rule"}),e.jsx("button",{className:"px-2 py-1 text-xs bg-zinc-700 hover:bg-zinc-600 rounded text-zinc-300 transition-colors",children:"Accept"})]})]})},t.id))}),i==="coverage"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800",children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-300 mb-4",children:"Masking Coverage by Database"}),e.jsx("div",{className:"space-y-4",children:A.map(t=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-zinc-200",children:t.name}),e.jsxs("span",{className:"text-zinc-500",children:[t.sensitive," sensitive / ",t.total," total fields"]})]}),e.jsxs("span",{className:a(t.covered===100?"text-emerald-400":t.covered>=90?"text-amber-400":t.covered===0?"text-rose-400":"text-amber-400"),children:[t.covered,"%"]})]}),e.jsx("div",{className:"h-3 bg-zinc-700 rounded-full overflow-hidden",children:e.jsx("div",{className:a("h-full rounded-full",t.covered===100?"bg-emerald-500":t.covered>=80?"bg-amber-500":t.covered===0?"bg-rose-500":"bg-amber-500"),style:{width:`${t.covered}%`}})})]},t.name))})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800",children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-300 mb-4",children:"Sensitivity Distribution"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:["pii","phi","pci","financial","confidential","internal"].map(t=>{const n=l.filter(C=>C.sensitivity===t).length;return e.jsxs("div",{className:"bg-zinc-800 rounded-lg p-3 text-center",children:[e.jsx("span",{className:a("text-xs px-2 py-0.5 rounded-full",d(t)),children:t.toUpperCase()}),e.jsx("div",{className:"text-2xl font-bold text-white mt-2",children:n}),e.jsx("div",{className:"text-xs text-zinc-500",children:"rules"})]},t)})})]})]})]})}export{T as default};
