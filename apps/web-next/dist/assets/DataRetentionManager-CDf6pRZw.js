import{r as m,j as e,c as t}from"./index-rWtyeRSA.js";const p={pii:"bg-rose-500/20 text-rose-400",financial:"bg-amber-500/20 text-amber-400",logs:"bg-zinc-500/20 text-zinc-400",metrics:"bg-sky-500/20 text-sky-400",backups:"bg-indigo-500/20 text-indigo-400","user-content":"bg-violet-500/20 text-violet-400"},g={delete:"bg-rose-500/20 text-rose-400",archive:"bg-indigo-500/20 text-indigo-400",anonymize:"bg-amber-500/20 text-amber-400",compress:"bg-sky-500/20 text-sky-400"},w={active:"bg-emerald-500/20 text-emerald-400",expiring:"bg-amber-500/20 text-amber-400",expired:"bg-rose-500/20 text-rose-400",exempt:"bg-zinc-500/20 text-zinc-400"},z={running:"bg-sky-500/20 text-sky-400",completed:"bg-emerald-500/20 text-emerald-400",failed:"bg-rose-500/20 text-rose-400",queued:"bg-zinc-500/20 text-zinc-400"},R={running:"bg-sky-500/20 text-sky-400",idle:"bg-zinc-500/20 text-zinc-400",failed:"bg-rose-500/20 text-rose-400",scheduled:"bg-amber-500/20 text-amber-400"},l=[{id:"pol1",name:"User PII 90-Day Purge",dataClass:"pii",retentionDays:90,action:"delete",scope:"users.profile_events",owner:"Privacy Team",enabled:!0,description:"Deletes PII fields from profile_events after 90 days per GDPR Art. 17.",lastRun:"2025-02-21 02:00",nextRun:"2025-02-22 02:00",affectedRows:14820,storageGB:2.1},{id:"pol2",name:"Application Logs 30-Day Archive",dataClass:"logs",retentionDays:30,action:"archive",scope:"logs.*",owner:"Platform Team",enabled:!0,description:"Moves application logs to cold storage after 30 days. Retained 1 year in cold.",lastRun:"2025-02-21 03:00",nextRun:"2025-02-22 03:00",affectedRows:42e5,storageGB:88.4},{id:"pol3",name:"Metrics 13-Month Rollup",dataClass:"metrics",retentionDays:395,action:"compress",scope:"metrics.raw",owner:"Observability Team",enabled:!0,description:"Rolls up raw metric points older than 13 months to hourly resolution.",lastRun:"2025-01-31 04:00",nextRun:"2025-03-31 04:00",affectedRows:89e4,storageGB:14.7},{id:"pol4",name:"Financial Records 7-Year Hold",dataClass:"financial",retentionDays:2555,action:"archive",scope:"billing.*",owner:"Finance Team",enabled:!0,description:"Archives financial records for 7-year regulatory compliance.",lastRun:"2024-12-31 05:00",nextRun:"2025-12-31 05:00",affectedRows:54e4,storageGB:8.2},{id:"pol5",name:"User Content Anonymization",dataClass:"user-content",retentionDays:180,action:"anonymize",scope:"content.submissions",owner:"Privacy Team",enabled:!1,description:"Anonymizes deleted user content after 180 days.",lastRun:"2025-02-01 06:00",nextRun:"N/A (disabled)",affectedRows:23e3,storageGB:1.8},{id:"pol6",name:"Backup Rotation 90-Day",dataClass:"backups",retentionDays:90,action:"delete",scope:"backups.daily",owner:"Infra Team",enabled:!0,description:"Deletes daily backup snapshots older than 90 days.",lastRun:"2025-02-21 07:00",nextRun:"2025-02-22 07:00",affectedRows:90,storageGB:320}],S=[{id:"ds1",name:"PostgreSQL prod",type:"Relational",totalGB:480,expiringGB:12.4,expiredGB:3.2,policies:3,scanStatus:"idle",lastScanned:"1h ago"},{id:"ds2",name:"Elasticsearch logs",type:"Search/Analytics",totalGB:1200,expiringGB:92,expiredGB:45.1,policies:2,scanStatus:"running",lastScanned:"running"},{id:"ds3",name:"S3 cold storage",type:"Object Store",totalGB:8400,expiringGB:340,expiredGB:120,policies:2,scanStatus:"idle",lastScanned:"6h ago"},{id:"ds4",name:"ClickHouse metrics",type:"Analytics",totalGB:620,expiringGB:18.2,expiredGB:0,policies:1,scanStatus:"scheduled",lastScanned:"12h ago"},{id:"ds5",name:"Redis sessions",type:"Cache",totalGB:24,expiringGB:2.1,expiredGB:.4,policies:1,scanStatus:"idle",lastScanned:"30m ago"}],o=[{id:"r1",dataStore:"PostgreSQL prod",dataClass:"pii",recordCount:14820,oldestRecord:"2024-10-01",expiresOn:"2025-01-01",status:"expired",policyId:"pol1",policyName:"User PII 90-Day Purge"},{id:"r2",dataStore:"Elasticsearch logs",dataClass:"logs",recordCount:42e5,oldestRecord:"2025-01-21",expiresOn:"2025-02-20",status:"expiring",policyId:"pol2",policyName:"Application Logs 30-Day Archive"},{id:"r3",dataStore:"ClickHouse metrics",dataClass:"metrics",recordCount:89e4,oldestRecord:"2024-01-01",expiresOn:"2025-02-28",status:"expiring",policyId:"pol3",policyName:"Metrics 13-Month Rollup"},{id:"r4",dataStore:"PostgreSQL prod",dataClass:"financial",recordCount:54e4,oldestRecord:"2018-01-01",expiresOn:"2025-01-01",status:"expired",policyId:"pol4",policyName:"Financial Records 7-Year Hold"},{id:"r5",dataStore:"S3 cold storage",dataClass:"backups",recordCount:90,oldestRecord:"2024-11-24",expiresOn:"2025-02-24",status:"expiring",policyId:"pol6",policyName:"Backup Rotation 90-Day"},{id:"r6",dataStore:"S3 cold storage",dataClass:"user-content",recordCount:23e3,oldestRecord:"2024-08-01",expiresOn:"2025-02-01",status:"expired",policyId:"pol5",policyName:"User Content Anonymization"}],C=[{id:"j1",policyName:"User PII 90-Day Purge",dataStore:"PostgreSQL prod",startTime:"2025-02-22 02:00",endTime:"2025-02-22 02:04",status:"completed",rowsProcessed:14820,rowsDeleted:14820,gbFreed:2.1,error:null},{id:"j2",policyName:"Application Logs 30-Day Archive",dataStore:"Elasticsearch logs",startTime:"2025-02-22 03:00",endTime:null,status:"running",rowsProcessed:21e5,rowsDeleted:0,gbFreed:0,error:null},{id:"j3",policyName:"Backup Rotation 90-Day",dataStore:"S3 cold storage",startTime:"2025-02-21 07:00",endTime:"2025-02-21 07:12",status:"completed",rowsProcessed:90,rowsDeleted:90,gbFreed:320,error:null},{id:"j4",policyName:"User Content Anonymization",dataStore:"PostgreSQL prod",startTime:"2025-02-01 06:00",endTime:"2025-02-01 06:31",status:"failed",rowsProcessed:12e3,rowsDeleted:0,gbFreed:0,error:"Foreign key constraint violation on content.replies"},{id:"j5",policyName:"Metrics 13-Month Rollup",dataStore:"ClickHouse metrics",startTime:"2025-01-31 04:00",endTime:"2025-01-31 04:45",status:"completed",rowsProcessed:89e4,rowsDeleted:0,gbFreed:9.2,error:null}];function r(i){return i>=1e6?`${(i/1e6).toFixed(1)}M`:i>=1e3?`${(i/1e3).toFixed(0)}k`:String(i)}function D(){const[i,h]=m.useState("overview"),[a,x]=m.useState(null),[d,u]=m.useState("all"),b=d==="all"?l:l.filter(s=>s.dataClass===d),N=o.filter(s=>s.status==="expired").length,f=o.filter(s=>s.status==="expiring").length,y=o.reduce((s,c)=>{const n=l.find(v=>v.id===c.policyId);return c.status==="expired"?s+((n==null?void 0:n.storageGB)??0):s},0),j=[{id:"overview",label:"Overview"},{id:"policies",label:"Policies"},{id:"records",label:"Inventory"},{id:"jobs",label:"Deletion Jobs"}];return e.jsx("div",{className:"min-h-screen bg-zinc-950 text-white p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Data Retention Manager"}),e.jsx("p",{className:"text-zinc-400 text-sm mt-1",children:"Lifecycle policies, expiry tracking, and compliance records"})]}),e.jsx("button",{className:"px-4 py-2 rounded-lg bg-indigo-600 hover:bg-indigo-500 text-sm font-medium transition-colors",children:"+ New Policy"})]}),e.jsx("div",{className:"flex gap-1 border-b border-zinc-800",children:j.map(s=>e.jsx("button",{onClick:()=>{h(s.id),x(null)},className:t("px-4 py-2 text-sm font-medium border-b-2 transition-colors",i===s.id?"border-indigo-500 text-white":"border-transparent text-zinc-400 hover:text-zinc-200"),children:s.label},s.id))}),i==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"Active Policies",value:l.filter(s=>s.enabled).length,color:"text-emerald-400"},{label:"Expired Records",value:N,color:"text-rose-400"},{label:"Expiring Soon",value:f,color:"text-amber-400"},{label:"Reclaimable GB",value:`${y.toFixed(1)}`,color:"text-sky-400"}].map(s=>e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs text-zinc-500 uppercase tracking-wider",children:s.label}),e.jsx("p",{className:t("text-3xl font-bold mt-1",s.color),children:s.value})]},s.label))}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-zinc-300 mb-4",children:"Data Store Summary"}),e.jsx("div",{className:"space-y-3",children:S.map(s=>{const c=Math.round(s.expiringGB/s.totalGB*100),n=Math.round(s.expiredGB/s.totalGB*100);return e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-36 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-white truncate",children:s.name}),e.jsx("p",{className:"text-xs text-zinc-500",children:s.type})]}),e.jsxs("div",{className:"flex-1 bg-zinc-800 rounded-full h-2 relative",children:[e.jsx("div",{className:"absolute left-0 top-0 h-2 rounded-full bg-amber-500 opacity-70",style:{width:`${c}%`}}),e.jsx("div",{className:"absolute left-0 top-0 h-2 rounded-full bg-rose-500",style:{width:`${n}%`}})]}),e.jsxs("div",{className:"text-xs text-zinc-400 w-20 text-right",children:[s.totalGB," GB"]}),e.jsx("span",{className:t("text-xs px-1.5 py-0.5 rounded",R[s.scanStatus]),children:s.scanStatus}),e.jsxs("span",{className:"text-xs text-zinc-600 w-20 text-right",children:["Scanned ",s.lastScanned]})]},s.id)})}),e.jsxs("div",{className:"flex gap-4 mt-4 pt-3 border-t border-zinc-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-1.5 rounded-full bg-amber-500 opacity-70"}),e.jsx("span",{className:"text-xs text-zinc-400",children:"Expiring"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-1.5 rounded-full bg-rose-500"}),e.jsx("span",{className:"text-xs text-zinc-400",children:"Expired"})]})]})]}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-zinc-300 mb-4",children:"Policy Overview"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:l.map(s=>e.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3 flex items-center gap-3",children:[e.jsx("div",{className:t("w-2 h-2 rounded-full flex-shrink-0",s.enabled?"bg-emerald-400":"bg-zinc-500")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-white truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-zinc-500",children:[s.scope," · ",s.retentionDays,"d"]})]}),e.jsxs("div",{className:"flex gap-1.5 flex-shrink-0",children:[e.jsx("span",{className:t("text-xs px-1.5 py-0.5 rounded",p[s.dataClass]),children:s.dataClass}),e.jsx("span",{className:t("text-xs px-1.5 py-0.5 rounded",g[s.action]),children:s.action})]})]},s.id))})]})]}),i==="policies"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>u("all"),className:t("px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",d==="all"?"bg-indigo-600 text-white":"bg-zinc-800 text-zinc-400 hover:text-zinc-200"),children:"All"}),["pii","financial","logs","metrics","backups","user-content"].map(s=>e.jsx("button",{onClick:()=>u(s),className:t("px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",d===s?"bg-indigo-600 text-white":"bg-zinc-800 text-zinc-400 hover:text-zinc-200"),children:s},s))]}),a?e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5 space-y-5",children:[e.jsx("button",{onClick:()=>x(null),className:"text-zinc-400 hover:text-white text-sm",children:"← Back"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:a.name}),e.jsx("span",{className:t("text-xs px-2 py-0.5 rounded-full font-medium",a.enabled?"bg-emerald-500/20 text-emerald-400":"bg-zinc-500/20 text-zinc-400"),children:a.enabled?"enabled":"disabled"})]}),e.jsx("p",{className:"text-sm text-zinc-400",children:a.description}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"Data Class",value:a.dataClass},{label:"Action",value:a.action},{label:"Retention",value:`${a.retentionDays} days`},{label:"Scope",value:a.scope},{label:"Owner",value:a.owner},{label:"Affected Rows",value:r(a.affectedRows)},{label:"Storage",value:`${a.storageGB} GB`},{label:"Last Run",value:a.lastRun}].map(s=>e.jsxs("div",{className:"bg-zinc-800/60 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-zinc-500",children:s.label}),e.jsx("p",{className:"text-sm font-medium text-white mt-0.5",children:s.value})]},s.label))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{className:"px-4 py-2 bg-rose-600 hover:bg-rose-500 rounded-lg text-sm font-medium transition-colors",children:"Run Now"}),e.jsx("button",{className:"px-4 py-2 bg-zinc-700 hover:bg-zinc-600 rounded-lg text-sm font-medium transition-colors",children:a.enabled?"Disable":"Enable"})]})]}):e.jsx("div",{className:"space-y-3",children:b.map(s=>e.jsxs("button",{onClick:()=>x(s),className:"w-full text-left bg-zinc-900 border border-zinc-800 hover:border-zinc-600 rounded-xl p-4 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:t("w-2.5 h-2.5 rounded-full flex-shrink-0",s.enabled?"bg-emerald-400":"bg-zinc-500")}),e.jsx("span",{className:"text-sm font-semibold text-white",children:s.name})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:t("text-xs px-2 py-0.5 rounded",p[s.dataClass]),children:s.dataClass}),e.jsx("span",{className:t("text-xs px-2 py-0.5 rounded",g[s.action]),children:s.action})]})]}),e.jsxs("div",{className:"flex gap-4 text-xs text-zinc-500 ml-5",children:[e.jsx("span",{children:s.scope}),e.jsxs("span",{children:[s.retentionDays,"d retention"]}),e.jsxs("span",{children:[r(s.affectedRows)," rows"]}),e.jsxs("span",{children:[s.storageGB," GB"]}),e.jsxs("span",{children:["Next: ",s.nextRun]})]})]},s.id))})]}),i==="records"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-zinc-400",children:"Data inventory by policy scope and expiry status"}),o.map(s=>e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:t("text-xs px-2 py-0.5 rounded font-medium",w[s.status]),children:s.status}),e.jsx("span",{className:"text-sm font-semibold text-white",children:s.dataStore}),e.jsx("span",{className:t("text-xs px-1.5 py-0.5 rounded",p[s.dataClass]),children:s.dataClass})]}),e.jsx("span",{className:"text-xs text-zinc-500",children:s.policyName})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs text-zinc-400",children:[e.jsxs("span",{children:["Records: ",r(s.recordCount)]}),e.jsxs("span",{children:["Oldest: ",s.oldestRecord]}),e.jsxs("span",{className:s.status==="expired"?"text-rose-400":s.status==="expiring"?"text-amber-400":"",children:["Expires: ",s.expiresOn]})]})]},s.id))]}),i==="jobs"&&e.jsx("div",{className:"space-y-3",children:C.map(s=>e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:t("text-xs px-2 py-0.5 rounded font-medium",z[s.status]),children:s.status}),e.jsx("span",{className:"text-sm font-semibold text-white",children:s.policyName})]}),e.jsx("span",{className:"text-xs text-zinc-500",children:s.dataStore})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3 mb-2",children:[e.jsxs("div",{className:"bg-zinc-800/50 rounded p-2",children:[e.jsx("p",{className:"text-xs text-zinc-500",children:"Processed"}),e.jsx("p",{className:"text-sm font-medium text-white",children:r(s.rowsProcessed)})]}),e.jsxs("div",{className:"bg-zinc-800/50 rounded p-2",children:[e.jsx("p",{className:"text-xs text-zinc-500",children:"Deleted"}),e.jsx("p",{className:"text-sm font-medium text-rose-400",children:r(s.rowsDeleted)})]}),e.jsxs("div",{className:"bg-zinc-800/50 rounded p-2",children:[e.jsx("p",{className:"text-xs text-zinc-500",children:"GB Freed"}),e.jsx("p",{className:"text-sm font-medium text-emerald-400",children:s.gbFreed})]}),e.jsxs("div",{className:"bg-zinc-800/50 rounded p-2",children:[e.jsx("p",{className:"text-xs text-zinc-500",children:"Duration"}),e.jsx("p",{className:"text-sm font-medium text-zinc-300",children:s.endTime?`${Math.round((new Date(s.endTime).getTime()-new Date(s.startTime).getTime())/6e4)}min`:"running"})]})]}),s.error&&e.jsx("div",{className:"mt-2 bg-rose-500/10 border border-rose-500/20 rounded p-2",children:e.jsxs("p",{className:"text-xs text-rose-400 font-medium",children:["Error: ",s.error]})}),s.status==="running"&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-zinc-500 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Math.round(s.rowsProcessed/42e5*100),"%"]})]}),e.jsx("div",{className:"bg-zinc-800 rounded-full h-1.5",children:e.jsx("div",{className:"h-1.5 rounded-full bg-sky-500",style:{width:`${Math.round(s.rowsProcessed/42e5*100)}%`}})})]})]},s.id))})]})})}export{D as default};
