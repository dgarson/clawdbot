import{r as l,j as e,c as n}from"./index-CiPVXHVM.js";const N=[{name:"users",schema:"public",rowCount:48291,columns:[{name:"id",type:"uuid",nullable:!1,isPK:!0,isFK:!1},{name:"email",type:"varchar(255)",nullable:!1,isPK:!1,isFK:!1},{name:"name",type:"varchar(100)",nullable:!0,isPK:!1,isFK:!1},{name:"plan",type:"varchar(20)",nullable:!1,isPK:!1,isFK:!1},{name:"created_at",type:"timestamptz",nullable:!1,isPK:!1,isFK:!1},{name:"deleted_at",type:"timestamptz",nullable:!0,isPK:!1,isFK:!1}]},{name:"orders",schema:"public",rowCount:312449,columns:[{name:"id",type:"uuid",nullable:!1,isPK:!0,isFK:!1},{name:"user_id",type:"uuid",nullable:!1,isPK:!1,isFK:!0},{name:"amount",type:"numeric(10,2)",nullable:!1,isPK:!1,isFK:!1},{name:"status",type:"varchar(20)",nullable:!1,isPK:!1,isFK:!1},{name:"created_at",type:"timestamptz",nullable:!1,isPK:!1,isFK:!1}]},{name:"events",schema:"analytics",rowCount:9841200,columns:[{name:"id",type:"bigint",nullable:!1,isPK:!0,isFK:!1},{name:"session_id",type:"uuid",nullable:!1,isPK:!1,isFK:!1},{name:"type",type:"varchar(50)",nullable:!1,isPK:!1,isFK:!1},{name:"properties",type:"jsonb",nullable:!0,isPK:!1,isFK:!1},{name:"ts",type:"timestamptz",nullable:!1,isPK:!1,isFK:!1}]},{name:"audit_logs",schema:"public",rowCount:1240580,columns:[{name:"id",type:"bigint",nullable:!1,isPK:!0,isFK:!1},{name:"actor_id",type:"uuid",nullable:!0,isPK:!1,isFK:!0},{name:"action",type:"varchar(100)",nullable:!1,isPK:!1,isFK:!1},{name:"resource",type:"text",nullable:!1,isPK:!1,isFK:!1},{name:"ip",type:"inet",nullable:!0,isPK:!1,isFK:!1},{name:"created_at",type:"timestamptz",nullable:!1,isPK:!1,isFK:!1}]},{name:"api_keys",schema:"public",rowCount:8903,columns:[{name:"id",type:"uuid",nullable:!1,isPK:!0,isFK:!1},{name:"user_id",type:"uuid",nullable:!1,isPK:!1,isFK:!0},{name:"name",type:"varchar(100)",nullable:!1,isPK:!1,isFK:!1},{name:"key_hash",type:"varchar(64)",nullable:!1,isPK:!1,isFK:!1},{name:"last_used",type:"timestamptz",nullable:!0,isPK:!1,isFK:!1},{name:"revoked_at",type:"timestamptz",nullable:!0,isPK:!1,isFK:!1}]}],R={columns:["id","email","plan","created_at","order_count","total_spend"],rows:[["usr_9kX2","alice@corp.io","enterprise","2024-01-15",42,12840.5],["usr_8xT1","bob@example.com","pro","2024-02-03",18,2340],["usr_7kW2","carol@nova.ai","enterprise","2024-03-11",61,22100],["usr_6jT9","dave@acme.com","starter","2024-04-22",5,250],["usr_5nRt","eve@corp.io","pro","2024-05-01",29,4890.75],["usr_4mQp","frank@veritas.io","pro","2024-05-18",12,1200],["usr_3kLm","grace@novo.labs","enterprise","2024-06-02",88,31200],["usr_2xR8","henry@corp.io","starter","2024-06-30",3,99]],duration:142,rowsAffected:8},j=[{id:"sq1",name:"Top Spenders",sql:`SELECT u.id, u.email, u.plan, COUNT(o.id) as order_count, SUM(o.amount) as total_spend
FROM users u
JOIN orders o ON o.user_id = u.id
WHERE u.deleted_at IS NULL
GROUP BY u.id, u.email, u.plan
ORDER BY total_spend DESC
LIMIT 50;`,lastRun:"2 hours ago",tags:["revenue","users"]},{id:"sq2",name:"Recent Failed Orders",sql:`SELECT id, user_id, amount, created_at
FROM orders
WHERE status = 'failed'
  AND created_at > NOW() - INTERVAL '7 days'
ORDER BY created_at DESC;`,lastRun:"Yesterday",tags:["orders","ops"]},{id:"sq3",name:"Daily Active Users",sql:`SELECT DATE(created_at) as day, COUNT(DISTINCT session_id) as dau
FROM analytics.events
WHERE ts > NOW() - INTERVAL '30 days'
  AND type = 'session_start'
GROUP BY day
ORDER BY day DESC;`,lastRun:"3 days ago",tags:["analytics"]},{id:"sq4",name:"Expiring API Keys",sql:`SELECT ak.id, ak.name, u.email, ak.last_used
FROM api_keys ak
JOIN users u ON u.id = ak.user_id
WHERE ak.revoked_at IS NULL
  AND (ak.last_used < NOW() - INTERVAL '90 days' OR ak.last_used IS NULL)
ORDER BY ak.last_used ASC NULLS FIRST;`,lastRun:"1 week ago",tags:["security","api"]},{id:"sq5",name:"Audit: Admin Actions",sql:`SELECT actor_id, action, resource, ip, created_at
FROM audit_logs
WHERE action LIKE 'admin.%'
  AND created_at > NOW() - INTERVAL '24 hours'
ORDER BY created_at DESC;`,lastRun:"6 hours ago",tags:["audit","security"]}],_=[{sql:"SELECT * FROM users LIMIT 10;",ts:"07:38:14",duration:12,rows:10},{sql:"SELECT COUNT(*) FROM orders WHERE status = 'failed';",ts:"07:22:01",duration:340,rows:1},{sql:"EXPLAIN ANALYZE SELECT * FROM events WHERE ts > NOW() - INTERVAL '1 hour';",ts:"07:15:44",duration:88,rows:24},{sql:"SELECT id, email FROM users WHERE deleted_at IS NULL ORDER BY created_at DESC LIMIT 100;",ts:"06:58:02",duration:67,rows:100},{sql:"UPDATE orders SET status = 'cancelled' WHERE id = 'ord_7mNp';",ts:"06:44:11",duration:8,rows:1}];function C(){const[r,c]=l.useState("editor"),[o,x]=l.useState(j[0].sql),[d,h]=l.useState(null),[m,b]=l.useState(!1),[t,g]=l.useState(null),[u,y]=l.useState(null),[i,v]=l.useState(null),z=[{id:"editor",label:"Query Editor",emoji:"âœï¸"},{id:"schema",label:"Schema",emoji:"ðŸ—„ï¸"},{id:"saved",label:"Saved",emoji:"ðŸ’¾"},{id:"history",label:"History",emoji:"ðŸ•"}],E=()=>{b(!0),setTimeout(()=>{h(R),b(!1)},800)},w={uuid:"text-indigo-300",bigint:"text-amber-300",varchar:"text-emerald-300",text:"text-emerald-300",numeric:"text-sky-300",timestamptz:"text-purple-300",jsonb:"text-orange-300",inet:"text-cyan-300"},f=s=>{const a=s.split("(")[0];return w[a]??"text-zinc-300"};return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Database Query Builder"}),e.jsxs("p",{className:"text-zinc-400 text-sm mt-0.5",children:["Connected: ",e.jsx("span",{className:"text-emerald-400",children:"postgres://db.prod.internal:5432/clawdbot"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{className:"bg-zinc-800 border border-zinc-700 text-white text-sm rounded px-3 py-1.5 focus:outline-none",children:[e.jsx("option",{children:"production"}),e.jsx("option",{children:"staging"}),e.jsx("option",{children:"development"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs bg-emerald-400/10 border border-emerald-500/30 text-emerald-400 px-3 py-1.5 rounded",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-400"})," Connected"]})]})]}),e.jsx("div",{className:"flex gap-1 mb-6 bg-zinc-900 p-1 rounded-lg border border-zinc-800 w-fit",children:z.map(s=>e.jsxs("button",{onClick:()=>c(s.id),className:n("px-4 py-2 text-sm rounded-md transition-colors",r===s.id?"bg-indigo-500 text-white":"text-zinc-400 hover:text-white hover:bg-zinc-800"),children:[s.emoji," ",s.label]},s.id))}),r==="editor"&&e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-zinc-400 mb-3 uppercase tracking-wider",children:"Tables"}),e.jsx("div",{className:"space-y-1",children:N.map(s=>e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>y(u===s.name?null:s.name),className:"w-full flex items-center justify-between text-left px-2 py-1.5 rounded hover:bg-zinc-800 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-zinc-500 text-xs",children:u===s.name?"â–¼":"â–¶"}),e.jsx("span",{className:"text-sm text-white",children:s.name})]}),e.jsxs("span",{className:"text-xs text-zinc-500",children:[(s.rowCount/1e3).toFixed(0),"K"]})]}),u===s.name&&e.jsx("div",{className:"ml-4 mt-1 space-y-0.5 pb-1",children:s.columns.map(a=>e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-0.5",children:[e.jsx("span",{className:"text-xs text-zinc-600",children:a.isPK?"ðŸ”‘":a.isFK?"ðŸ”—":"Â·"}),e.jsx("span",{className:"text-xs text-zinc-300",children:a.name}),e.jsx("span",{className:n("text-xs ml-auto",f(a.type)),children:a.type.split("(")[0]})]},a.name))})]},s.name))})]})}),e.jsxs("div",{className:"col-span-3 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:E,disabled:m,className:n("flex items-center gap-2 px-4 py-2 rounded text-sm font-medium transition-colors",m?"bg-zinc-700 text-zinc-400 cursor-not-allowed":"bg-indigo-500 text-white hover:bg-indigo-600"),children:m?"â³ Running...":"â–¶ Run Query"}),e.jsx("button",{className:"text-sm px-3 py-2 border border-zinc-700 text-zinc-400 rounded hover:bg-zinc-800 transition-colors",children:"ðŸ’¾ Save"}),e.jsx("button",{className:"text-sm px-3 py-2 border border-zinc-700 text-zinc-400 rounded hover:bg-zinc-800 transition-colors",children:"ðŸ“‹ Format"}),e.jsx("button",{onClick:()=>h(null),className:"text-sm px-3 py-2 border border-zinc-700 text-zinc-400 rounded hover:bg-zinc-800 transition-colors",children:"âœ• Clear"}),e.jsx("div",{className:"ml-auto text-xs text-zinc-500",children:"Cmd+Enter to run"})]}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-zinc-800/50 border-b border-zinc-800",children:[e.jsx("span",{className:"text-xs text-zinc-400",children:"SQL"}),e.jsxs("div",{className:"ml-auto flex gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-rose-500/60"}),e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-amber-500/60"}),e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-emerald-500/60"})]})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"px-3 py-3 text-xs font-mono text-zinc-600 text-right select-none border-r border-zinc-800 bg-zinc-900/50",children:o.split(`
`).map((s,a)=>e.jsx("div",{className:"leading-6",children:a+1},a))}),e.jsx("textarea",{value:o,onChange:s=>x(s.target.value),className:"flex-1 bg-transparent px-4 py-3 text-sm font-mono text-zinc-100 resize-none focus:outline-none leading-6 min-h-[200px]",spellCheck:!1,rows:Math.max(8,o.split(`
`).length+1)})]})]}),d&&e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-4 px-4 py-2 border-b border-zinc-800 bg-zinc-800/30",children:[e.jsx("span",{className:"text-xs text-zinc-400",children:"Results"}),e.jsxs("span",{className:"text-xs text-emerald-400",children:[d.rowsAffected," rows"]}),e.jsxs("span",{className:"text-xs text-zinc-500",children:[d.duration,"ms"]}),e.jsx("button",{className:"ml-auto text-xs text-indigo-400 hover:text-indigo-300",children:"â¬‡ Export CSV"})]}),e.jsx("div",{className:"overflow-x-auto max-h-80",children:e.jsxs("table",{className:"w-full text-xs font-mono",children:[e.jsx("thead",{className:"sticky top-0 bg-zinc-800",children:e.jsx("tr",{children:d.columns.map(s=>e.jsx("th",{className:"px-3 py-2 text-left text-zinc-400 font-medium whitespace-nowrap border-b border-zinc-700",children:s},s))})}),e.jsx("tbody",{className:"divide-y divide-zinc-800",children:d.rows.map((s,a)=>e.jsx("tr",{className:"hover:bg-zinc-800/30 transition-colors",children:s.map((p,K)=>e.jsx("td",{className:n("px-3 py-2 whitespace-nowrap",p===null?"text-zinc-600 italic":"text-zinc-300"),children:p===null?"NULL":String(p)},K))},a))})]})})]})]})]}),r==="schema"&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx("div",{className:"col-span-1 space-y-2",children:N.map(s=>e.jsxs("button",{onClick:()=>g(s),className:n("w-full bg-zinc-900 border rounded-lg p-3 text-left hover:border-zinc-600 transition-colors",(t==null?void 0:t.name)===s.name?"border-indigo-500/50":"border-zinc-800"),children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsxs("span",{className:"text-sm font-medium text-white",children:[s.schema,".",s.name]})}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-zinc-500",children:[e.jsxs("span",{children:[s.columns.length," cols"]}),e.jsxs("span",{children:[s.rowCount.toLocaleString()," rows"]})]})]},s.name))}),e.jsx("div",{className:"col-span-2",children:t?e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-zinc-800 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.schema,".",t.name]}),e.jsxs("span",{className:"text-xs text-zinc-400",children:[t.rowCount.toLocaleString()," rows"]})]}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-zinc-800 text-xs text-zinc-400",children:[e.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Column"}),e.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Type"}),e.jsx("th",{className:"px-4 py-2 text-center font-medium",children:"Nullable"}),e.jsx("th",{className:"px-4 py-2 text-center font-medium",children:"PK"}),e.jsx("th",{className:"px-4 py-2 text-center font-medium",children:"FK"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-800",children:t.columns.map(s=>e.jsxs("tr",{className:"hover:bg-zinc-800/30",children:[e.jsx("td",{className:"px-4 py-2.5 text-white font-medium font-mono text-xs",children:s.name}),e.jsx("td",{className:n("px-4 py-2.5 font-mono text-xs",f(s.type)),children:s.type}),e.jsx("td",{className:"px-4 py-2.5 text-center text-xs",children:s.nullable?e.jsx("span",{className:"text-amber-400",children:"yes"}):e.jsx("span",{className:"text-zinc-500",children:"no"})}),e.jsx("td",{className:"px-4 py-2.5 text-center",children:s.isPK?e.jsx("span",{className:"text-amber-400",children:"ðŸ”‘"}):e.jsx("span",{className:"text-zinc-700",children:"â€”"})}),e.jsx("td",{className:"px-4 py-2.5 text-center",children:s.isFK?e.jsx("span",{className:"text-indigo-400",children:"ðŸ”—"}):e.jsx("span",{className:"text-zinc-700",children:"â€”"})})]},s.name))})]})]}):e.jsx("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-10 text-center text-zinc-500 text-sm",children:"Select a table to view schema"})})]}),r==="saved"&&e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsx("div",{className:"col-span-2 space-y-3",children:j.map(s=>e.jsxs("button",{onClick:()=>v(s),className:n("w-full bg-zinc-900 border rounded-lg p-4 text-left hover:border-zinc-600 transition-colors",(i==null?void 0:i.id)===s.id?"border-indigo-500/50":"border-zinc-800"),children:[e.jsx("div",{className:"text-sm font-medium text-white mb-1",children:s.name}),e.jsxs("div",{className:"text-xs text-zinc-500 mb-2",children:["Last run ",s.lastRun]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.tags.map(a=>e.jsx("span",{className:"text-xs bg-indigo-500/10 border border-indigo-500/20 text-indigo-300 px-2 py-0.5 rounded",children:a},a))})]},s.id))}),e.jsx("div",{className:"col-span-3",children:i?e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-zinc-800",children:[e.jsx("span",{className:"text-sm font-semibold text-white",children:i.name}),e.jsx("button",{onClick:()=>{x(i.sql),c("editor")},className:"text-xs px-3 py-1.5 bg-indigo-500 text-white rounded hover:bg-indigo-600 transition-colors",children:"Open in Editor"})]}),e.jsx("pre",{className:"p-4 text-xs font-mono text-zinc-200 leading-relaxed overflow-x-auto whitespace-pre-wrap",children:i.sql})]}):e.jsx("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-10 text-center text-zinc-500 text-sm",children:"Select a saved query to preview"})})]}),r==="history"&&e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-zinc-800 text-xs text-zinc-400",children:"Recent queries (today)"}),e.jsx("div",{className:"divide-y divide-zinc-800",children:_.map((s,a)=>e.jsxs("div",{className:"px-4 py-3 hover:bg-zinc-800/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx("span",{className:"text-xs text-zinc-500 font-mono",children:s.ts}),e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[e.jsxs("span",{className:n(s.duration>200?"text-amber-400":"text-zinc-400"),children:[s.duration,"ms"]}),e.jsxs("span",{className:"text-zinc-400",children:[s.rows," rows"]}),e.jsx("button",{onClick:()=>{x(s.sql),c("editor")},className:"text-indigo-400 hover:text-indigo-300",children:"Re-run â†’"})]})]}),e.jsx("pre",{className:"text-xs font-mono text-zinc-300 truncate",children:s.sql})]},a))})]})]})}export{C as default};
