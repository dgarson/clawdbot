import{r as u,j as e,c as l}from"./index-v5gn4Pco.js";const t=[{id:"t1",name:"users",schema:"public",rows:284921,size:"142 MB",description:"Core user accounts and profile data",columns:[{name:"id",type:"uuid",nullable:!1,default:"gen_random_uuid()",primary:!0,unique:!0,indexed:!0,fk:null,comment:"Primary key"},{name:"email",type:"varchar",nullable:!1,default:null,primary:!1,unique:!0,indexed:!0,fk:null,comment:"User email address"},{name:"hashed_password",type:"varchar",nullable:!1,default:null,primary:!1,unique:!1,indexed:!1,fk:null,comment:null},{name:"name",type:"varchar",nullable:!0,default:null,primary:!1,unique:!1,indexed:!1,fk:null,comment:null},{name:"plan",type:"varchar",nullable:!1,default:"'free'",primary:!1,unique:!1,indexed:!0,fk:null,comment:"Subscription tier"},{name:"org_id",type:"uuid",nullable:!0,default:null,primary:!1,unique:!1,indexed:!0,fk:{table:"organizations",column:"id"},comment:null},{name:"created_at",type:"timestamp",nullable:!1,default:"now()",primary:!1,unique:!1,indexed:!0,fk:null,comment:null},{name:"last_login",type:"timestamp",nullable:!0,default:null,primary:!1,unique:!1,indexed:!1,fk:null,comment:null},{name:"metadata",type:"jsonb",nullable:!0,default:null,primary:!1,unique:!1,indexed:!1,fk:null,comment:null}],indexes:[{name:"users_pkey",columns:["id"],unique:!0,type:"btree",size:"8 MB"},{name:"users_email_idx",columns:["email"],unique:!0,type:"btree",size:"12 MB"},{name:"users_org_id_idx",columns:["org_id"],unique:!1,type:"btree",size:"6 MB"},{name:"users_plan_created_idx",columns:["plan","created_at"],unique:!1,type:"btree",size:"9 MB"}]},{id:"t2",name:"organizations",schema:"public",rows:12431,size:"18 MB",description:"Organization/team accounts",columns:[{name:"id",type:"uuid",nullable:!1,default:"gen_random_uuid()",primary:!0,unique:!0,indexed:!0,fk:null,comment:null},{name:"name",type:"varchar",nullable:!1,default:null,primary:!1,unique:!1,indexed:!0,fk:null,comment:null},{name:"slug",type:"varchar",nullable:!1,default:null,primary:!1,unique:!0,indexed:!0,fk:null,comment:"URL-safe identifier"},{name:"plan",type:"varchar",nullable:!1,default:"'free'",primary:!1,unique:!1,indexed:!1,fk:null,comment:null},{name:"created_at",type:"timestamp",nullable:!1,default:"now()",primary:!1,unique:!1,indexed:!0,fk:null,comment:null},{name:"settings",type:"jsonb",nullable:!0,default:"'{}'",primary:!1,unique:!1,indexed:!1,fk:null,comment:null}],indexes:[{name:"organizations_pkey",columns:["id"],unique:!0,type:"btree",size:"1 MB"},{name:"organizations_slug_idx",columns:["slug"],unique:!0,type:"btree",size:"2 MB"}]},{id:"t3",name:"sessions",schema:"public",rows:4821023,size:"891 MB",description:"User session tokens",columns:[{name:"token",type:"varchar",nullable:!1,default:null,primary:!0,unique:!0,indexed:!0,fk:null,comment:"Session JWT token"},{name:"user_id",type:"uuid",nullable:!1,default:null,primary:!1,unique:!1,indexed:!0,fk:{table:"users",column:"id"},comment:null},{name:"created_at",type:"timestamp",nullable:!1,default:"now()",primary:!1,unique:!1,indexed:!1,fk:null,comment:null},{name:"expires_at",type:"timestamp",nullable:!1,default:null,primary:!1,unique:!1,indexed:!0,fk:null,comment:null},{name:"ip_address",type:"varchar",nullable:!0,default:null,primary:!1,unique:!1,indexed:!1,fk:null,comment:null},{name:"user_agent",type:"text",nullable:!0,default:null,primary:!1,unique:!1,indexed:!1,fk:null,comment:null}],indexes:[{name:"sessions_pkey",columns:["token"],unique:!0,type:"btree",size:"89 MB"},{name:"sessions_user_id_idx",columns:["user_id"],unique:!1,type:"btree",size:"67 MB"},{name:"sessions_expires_at_idx",columns:["expires_at"],unique:!1,type:"btree",size:"71 MB"}]},{id:"t4",name:"api_keys",schema:"public",rows:89234,size:"24 MB",description:"API key credentials",columns:[{name:"id",type:"uuid",nullable:!1,default:"gen_random_uuid()",primary:!0,unique:!0,indexed:!0,fk:null,comment:null},{name:"user_id",type:"uuid",nullable:!1,default:null,primary:!1,unique:!1,indexed:!0,fk:{table:"users",column:"id"},comment:null},{name:"key_hash",type:"varchar",nullable:!1,default:null,primary:!1,unique:!0,indexed:!0,fk:null,comment:"bcrypt hash of key"},{name:"name",type:"varchar",nullable:!1,default:null,primary:!1,unique:!1,indexed:!1,fk:null,comment:null},{name:"last_used",type:"timestamp",nullable:!0,default:null,primary:!1,unique:!1,indexed:!1,fk:null,comment:null},{name:"scopes",type:"text",nullable:!1,default:null,primary:!1,unique:!1,indexed:!1,fk:null,comment:"Comma-separated permission scopes"},{name:"expires_at",type:"timestamp",nullable:!0,default:null,primary:!1,unique:!1,indexed:!0,fk:null,comment:null},{name:"created_at",type:"timestamp",nullable:!1,default:"now()",primary:!1,unique:!1,indexed:!1,fk:null,comment:null}],indexes:[{name:"api_keys_pkey",columns:["id"],unique:!0,type:"btree",size:"3 MB"},{name:"api_keys_key_hash_idx",columns:["key_hash"],unique:!0,type:"btree",size:"4 MB"},{name:"api_keys_user_id_idx",columns:["user_id"],unique:!1,type:"btree",size:"3 MB"}]},{id:"t5",name:"audit_events",schema:"public",rows:82341023,size:"14.2 GB",description:"Immutable audit log",columns:[{name:"id",type:"bigint",nullable:!1,default:"nextval('audit_events_id_seq')",primary:!0,unique:!0,indexed:!0,fk:null,comment:null},{name:"user_id",type:"uuid",nullable:!0,default:null,primary:!1,unique:!1,indexed:!0,fk:{table:"users",column:"id"},comment:null},{name:"action",type:"varchar",nullable:!1,default:null,primary:!1,unique:!1,indexed:!0,fk:null,comment:null},{name:"resource_type",type:"varchar",nullable:!0,default:null,primary:!1,unique:!1,indexed:!0,fk:null,comment:null},{name:"resource_id",type:"uuid",nullable:!0,default:null,primary:!1,unique:!1,indexed:!0,fk:null,comment:null},{name:"ip_address",type:"varchar",nullable:!0,default:null,primary:!1,unique:!1,indexed:!1,fk:null,comment:null},{name:"payload",type:"jsonb",nullable:!0,default:null,primary:!1,unique:!1,indexed:!1,fk:null,comment:null},{name:"created_at",type:"timestamp",nullable:!1,default:"now()",primary:!1,unique:!1,indexed:!0,fk:null,comment:null}],indexes:[{name:"audit_events_pkey",columns:["id"],unique:!0,type:"btree",size:"1.2 GB"},{name:"audit_events_user_created_idx",columns:["user_id","created_at"],unique:!1,type:"btree",size:"890 MB"},{name:"audit_events_action_idx",columns:["action"],unique:!1,type:"btree",size:"710 MB"},{name:"audit_events_created_at_idx",columns:["created_at"],unique:!1,type:"btree",size:"640 MB"}]}],h=[{from:"users",fromCol:"org_id",to:"organizations",toCol:"id",constraint:"users_org_id_fkey",onDelete:"SET NULL"},{from:"sessions",fromCol:"user_id",to:"users",toCol:"id",constraint:"sessions_user_id_fkey",onDelete:"CASCADE"},{from:"api_keys",fromCol:"user_id",to:"users",toCol:"id",constraint:"api_keys_user_id_fkey",onDelete:"CASCADE"},{from:"audit_events",fromCol:"user_id",to:"users",toCol:"id",constraint:"audit_events_user_id_fkey",onDelete:"SET NULL"}],o=[{id:"m1",version:"20260222143012",name:"add_user_metadata_column",appliedAt:"2h ago",duration:"142ms",author:"platform-team",status:"applied",changes:["ALTER TABLE users ADD COLUMN metadata jsonb","CREATE INDEX users_metadata_gin ON users USING gin(metadata)"]},{id:"m2",version:"20260220091234",name:"create_audit_events_table",appliedAt:"2d ago",duration:"4.2s",author:"security-team",status:"applied",changes:["CREATE TABLE audit_events (...)","CREATE SEQUENCE audit_events_id_seq"]},{id:"m3",version:"20260218153445",name:"add_api_key_scopes",appliedAt:"4d ago",duration:"891ms",author:"platform-team",status:"applied",changes:["ALTER TABLE api_keys ADD COLUMN scopes text NOT NULL DEFAULT 'read'"]},{id:"m4",version:"20260222180000",name:"add_org_settings_index",appliedAt:null,duration:null,author:"luis",status:"pending",changes:["CREATE INDEX org_settings_gin ON organizations USING gin(settings)"]},{id:"m5",version:"20260215120000",name:"remove_legacy_auth_table",appliedAt:"7d ago",duration:"23ms",author:"platform-team",status:"applied",changes:["DROP TABLE IF EXISTS legacy_auth_tokens","DROP INDEX IF EXISTS legacy_auth_tokens_pkey"]}],_={int:"text-sky-400",bigint:"text-sky-400",varchar:"text-emerald-400",text:"text-emerald-400",bool:"text-amber-400",timestamp:"text-violet-400",uuid:"text-indigo-400",jsonb:"text-orange-400",decimal:"text-sky-400",float:"text-sky-400",date:"text-violet-400",bytea:"text-zinc-400"};function j(){const[i,x]=u.useState("tables"),[n,m]=u.useState(t[0]),[r,p]=u.useState(null),f=[{id:"tables",label:"Tables",emoji:"ðŸ—„ï¸"},{id:"indexes",label:"Indexes",emoji:"ðŸ”Ž"},{id:"relations",label:"Relations",emoji:"ðŸ”—"},{id:"migrations",label:"Migrations",emoji:"ðŸš€"}],b=t.reduce((s,a)=>s+a.rows,0),y=t.reduce((s,a)=>s+a.indexes.length,0);return e.jsxs("div",{className:"flex flex-col h-full bg-zinc-950 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-zinc-800",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold tracking-tight",children:"Database Schema Explorer"}),e.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:"PostgreSQL 16 Â· prod-db-primary Â· schema: public"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 rounded bg-emerald-500/10 border border-emerald-500/30",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-400"}),e.jsx("span",{className:"text-xs text-emerald-400 font-medium",children:"Connected"})]})})]}),e.jsx("div",{className:"grid grid-cols-4 gap-0 border-b border-zinc-800",children:[{label:"Tables",value:String(t.length),sub:"in public schema"},{label:"Total Rows",value:b.toLocaleString(),sub:"across all tables"},{label:"Total Indexes",value:String(y),sub:"covering all tables"},{label:"Pending Migrations",value:String(o.filter(s=>s.status==="pending").length),sub:"awaiting apply"}].map((s,a)=>e.jsxs("div",{className:"px-6 py-3 border-r border-zinc-800 last:border-r-0",children:[e.jsx("div",{className:"text-xl font-bold text-white",children:s.value}),e.jsx("div",{className:"text-xs font-medium text-zinc-400 mt-0.5",children:s.label}),e.jsx("div",{className:"text-xs text-zinc-600 mt-0.5",children:s.sub})]},a))}),e.jsx("div",{className:"flex border-b border-zinc-800 px-6",children:f.map(s=>e.jsxs("button",{onClick:()=>x(s.id),className:l("flex items-center gap-1.5 px-4 py-3 text-sm font-medium border-b-2 transition-colors",i===s.id?"border-indigo-500 text-white":"border-transparent text-zinc-500 hover:text-zinc-300"),children:[e.jsx("span",{children:s.emoji}),s.label]},s.id))}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[i==="tables"&&e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-64 border-r border-zinc-800 overflow-y-auto",children:[e.jsxs("div",{className:"p-2 text-xs text-zinc-500 uppercase tracking-wider border-b border-zinc-800 px-4 py-2",children:["Tables (",t.length,")"]}),t.map(s=>e.jsxs("button",{onClick:()=>m(s),className:l("w-full text-left px-4 py-3 border-b border-zinc-800/50 hover:bg-zinc-900 transition-colors",(n==null?void 0:n.id)===s.id&&"bg-zinc-800"),children:[e.jsx("div",{className:"text-sm font-mono text-zinc-200",children:s.name}),e.jsxs("div",{className:"text-xs text-zinc-500 mt-0.5",children:[s.columns.length," cols Â· ",s.rows.toLocaleString()," rows"]})]},s.id))]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:n?e.jsxs("div",{children:[e.jsxs("div",{className:"px-6 py-4 border-b border-zinc-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h2",{className:"font-mono text-sm font-semibold text-white",children:[n.schema,".",n.name]}),e.jsx("span",{className:"text-xs text-zinc-500",children:n.size}),e.jsxs("span",{className:"text-xs text-zinc-500",children:[n.rows.toLocaleString()," rows"]})]}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:n.description})]}),e.jsxs("table",{className:"w-full text-xs font-mono",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-zinc-800 bg-zinc-900/50",children:[e.jsx("th",{className:"text-left px-4 py-2.5 text-zinc-500 font-medium",children:"Column"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-zinc-500 font-medium",children:"Type"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-zinc-500 font-medium",children:"Nullable"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-zinc-500 font-medium",children:"Default"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-zinc-500 font-medium",children:"Constraints"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-zinc-500 font-medium",children:"References"})]})}),e.jsx("tbody",{children:n.columns.map(s=>e.jsxs("tr",{className:l("border-b border-zinc-800/50 hover:bg-zinc-900/30 transition-colors",s.primary&&"bg-indigo-500/3"),children:[e.jsx("td",{className:"px-4 py-2.5",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[s.primary&&e.jsx("span",{className:"text-yellow-400 text-xs",title:"Primary key",children:"ðŸ”‘"}),s.unique&&!s.primary&&e.jsx("span",{className:"text-sky-400 text-xs",title:"Unique",children:"U"}),s.indexed&&!s.primary&&!s.unique&&e.jsx("span",{className:"text-zinc-600 text-xs",title:"Indexed",children:"I"}),e.jsx("span",{className:l("font-medium",s.primary?"text-white":"text-zinc-200"),children:s.name})]})}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsx("span",{className:_[s.type],children:s.type})}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsx("span",{className:s.nullable?"text-zinc-500":"text-zinc-400",children:s.nullable?"YES":"NO"})}),e.jsx("td",{className:"px-4 py-2.5 text-zinc-500",children:s.default||"â€”"}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsxs("div",{className:"flex gap-1",children:[s.primary&&e.jsx("span",{className:"px-1 py-0.5 bg-yellow-500/10 text-yellow-400 rounded text-xs",children:"PK"}),s.unique&&!s.primary&&e.jsx("span",{className:"px-1 py-0.5 bg-sky-500/10 text-sky-400 rounded text-xs",children:"UQ"}),s.indexed&&!s.primary&&e.jsx("span",{className:"px-1 py-0.5 bg-zinc-700/40 text-zinc-400 rounded text-xs",children:"IDX"}),s.fk&&e.jsx("span",{className:"px-1 py-0.5 bg-indigo-500/10 text-indigo-400 rounded text-xs",children:"FK"})]})}),e.jsx("td",{className:"px-4 py-2.5 text-zinc-500",children:s.fk?e.jsxs("button",{className:"text-indigo-400 hover:text-indigo-300 transition-colors",onClick:()=>{const a=t.find(d=>{var c;return d.name===((c=s.fk)==null?void 0:c.table)});a&&m(a)},children:[s.fk.table,".",s.fk.column]}):"â€”"})]},s.name))})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-zinc-600 text-sm",children:"Select a table"})})]}),i==="indexes"&&e.jsx("div",{className:"p-6",children:t.map(s=>e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-mono text-sm font-medium text-zinc-300 mb-2",children:s.name}),e.jsx("div",{className:"space-y-1",children:s.indexes.map(a=>e.jsxs("div",{className:"bg-zinc-900 rounded border border-zinc-800 px-4 py-3 flex items-center gap-4 text-xs font-mono",children:[e.jsx("span",{className:"text-zinc-400 font-medium w-64 shrink-0",children:a.name}),e.jsx("span",{className:"text-sky-400",children:a.type.toUpperCase()}),e.jsx("span",{className:l("px-1.5 py-0.5 rounded",a.unique?"bg-yellow-500/10 text-yellow-400":"bg-zinc-700/30 text-zinc-500"),children:a.unique?"UNIQUE":""}),e.jsxs("span",{className:"text-zinc-300",children:["(",a.columns.join(", "),")"]}),e.jsx("span",{className:"ml-auto text-zinc-600",children:a.size})]},a.name))})]},s.id))}),i==="relations"&&e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-2",children:h.map(s=>e.jsxs("div",{className:"bg-zinc-900 rounded-lg border border-zinc-800 p-4 flex items-center gap-4 font-mono text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 text-zinc-200",children:[e.jsx("span",{className:"font-medium",children:s.from}),e.jsx("span",{className:"text-zinc-600",children:"."}),e.jsx("span",{className:"text-indigo-400",children:s.fromCol})]}),e.jsx("div",{className:"flex items-center gap-2 text-zinc-500",children:e.jsx("span",{children:"â”€â”€â”€ FK â”€â”€â†’"})}),e.jsxs("div",{className:"flex items-center gap-2 text-zinc-200",children:[e.jsx("span",{className:"font-medium",children:s.to}),e.jsx("span",{className:"text-zinc-600",children:"."}),e.jsx("span",{className:"text-emerald-400",children:s.toCol})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-4 text-zinc-500",children:[e.jsx("span",{className:"text-zinc-600",children:s.constraint}),e.jsxs("span",{className:l("px-2 py-0.5 rounded",s.onDelete==="CASCADE"?"bg-rose-500/10 text-rose-400":s.onDelete==="SET NULL"?"bg-amber-500/10 text-amber-400":"bg-zinc-700/30 text-zinc-400"),children:["ON DELETE ",s.onDelete]})]})]},s.constraint))})}),i==="migrations"&&e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-2",children:o.map(s=>e.jsxs("div",{className:l("rounded-lg border transition-colors",s.status==="pending"?"bg-amber-500/5 border-amber-500/20":s.status==="failed"?"bg-rose-500/5 border-rose-500/20":"bg-zinc-900 border-zinc-800"),children:[e.jsxs("div",{className:"px-5 py-3 flex items-center gap-4 cursor-pointer",onClick:()=>p(r===s.id?null:s.id),children:[e.jsx("span",{className:l("text-xs font-medium px-2 py-0.5 rounded border",s.status==="applied"?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":s.status==="pending"?"bg-amber-500/10 border-amber-500/30 text-amber-400":"bg-rose-500/10 border-rose-500/30 text-rose-400"),children:s.status}),e.jsx("span",{className:"font-mono text-xs text-zinc-500",children:s.version}),e.jsx("span",{className:"font-mono text-sm text-zinc-200",children:s.name}),e.jsx("span",{className:"ml-auto text-xs text-zinc-500",children:s.appliedAt||"Not applied"}),e.jsx("span",{className:"text-xs text-zinc-600",children:s.duration||"â€”"}),e.jsx("span",{className:"text-xs text-zinc-600",children:s.author}),e.jsx("span",{className:"text-zinc-500 text-xs",children:r===s.id?"â–²":"â–¼"})]}),r===s.id&&e.jsxs("div",{className:"px-5 py-3 border-t border-zinc-800 font-mono text-xs space-y-1",children:[s.changes.map((a,d)=>e.jsxs("div",{className:"text-zinc-400",children:[e.jsx("span",{className:"text-emerald-400",children:"+"})," ",a]},d)),s.status==="pending"&&e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 text-xs bg-emerald-600 hover:bg-emerald-500 rounded text-white transition-colors font-sans",children:"Apply Migration"}),e.jsx("button",{className:"px-3 py-1.5 text-xs bg-zinc-800 border border-zinc-700 rounded text-zinc-300 hover:bg-zinc-700 transition-colors font-sans",children:"Dry Run"})]})]})]},s.id))})})]})]})}export{j as default};
