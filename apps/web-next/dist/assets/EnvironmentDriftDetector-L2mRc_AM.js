import{r as b,j as e,c as g,R as G}from"./index-CYvdMGBM.js";const W=[{id:"d001",key:"DATABASE_CONNECTION_POOL_SIZE",category:"database",severity:"critical",status:"drifted",values:{dev:"10",staging:"25",prod:"100"},detectedAt:"2026-02-22T04:15:00Z",lastChangedBy:"sarah.chen@company.com",description:"Connection pool size differs significantly across environments, risking prod performance degradation during load.",expectedValue:"100"},{id:"d002",key:"REDIS_CLUSTER_ENABLED",category:"cache",severity:"critical",status:"drifted",values:{dev:"false",staging:"false",prod:"true"},detectedAt:"2026-02-21T18:45:00Z",lastChangedBy:"ops-bot@company.com",description:"Redis clustering is disabled in dev/staging but enabled in prod â€” cluster-related bugs will only surface in production.",expectedValue:"true"},{id:"d003",key:"JWT_EXPIRY_SECONDS",category:"auth",severity:"critical",status:"drifted",values:{dev:"86400",staging:"3600",prod:"900"},detectedAt:"2026-02-22T01:30:00Z",lastChangedBy:"alex.rodriguez@company.com",description:"JWT expiry times vary wildly â€” dev sessions last 24h while prod expires in 15 min, masking auth timeout bugs during development.",expectedValue:"900"},{id:"d004",key:"API_RATE_LIMIT_RPM",category:"api",severity:"warning",status:"drifted",values:{dev:"10000",staging:"5000",prod:"1000"},detectedAt:"2026-02-21T22:10:00Z",lastChangedBy:"platform-team@company.com",description:"Rate limiting thresholds don't match â€” services tested under lenient limits may fail under production restrictions.",expectedValue:"1000"},{id:"d005",key:"FEATURE_FLAG_DARK_MODE",category:"feature-flags",severity:"info",status:"drifted",values:{dev:"true",staging:"true",prod:"false"},detectedAt:"2026-02-20T14:00:00Z",lastChangedBy:"product-team@company.com",description:"Dark mode feature flag not yet enabled in production â€” pending UX sign-off.",expectedValue:"false"},{id:"d006",key:"LOG_LEVEL",category:"logging",severity:"warning",status:"drifted",values:{dev:"debug",staging:"info",prod:"warn"},detectedAt:"2026-02-19T09:00:00Z",lastChangedBy:"dev-ops@company.com",description:"Log verbosity levels differ â€” debug logs in dev may mask performance issues not visible in prod.",expectedValue:"warn"},{id:"d007",key:"SMTP_TLS_ENABLED",category:"networking",severity:"critical",status:"drifted",values:{dev:"false",staging:"true",prod:"true"},detectedAt:"2026-02-22T03:45:00Z",lastChangedBy:"security-team@company.com",description:"TLS disabled in dev â€” email security behavior untested against production configuration.",expectedValue:"true"},{id:"d008",key:"S3_BUCKET_VERSIONING",category:"api",severity:"warning",status:"drifted",values:{dev:"false",staging:"false",prod:"true"},detectedAt:"2026-02-21T11:20:00Z",lastChangedBy:"infra-bot@company.com",description:"S3 versioning enabled only in prod â€” data recovery scenarios cannot be tested in lower environments.",expectedValue:"true"},{id:"d009",key:"MAX_UPLOAD_SIZE_MB",category:"api",severity:"info",status:"resolved",values:{dev:"50",staging:"50",prod:"50"},detectedAt:"2026-02-18T10:30:00Z",lastChangedBy:"backend-team@company.com",description:"Upload size limits now standardized across all environments.",expectedValue:"50"},{id:"d010",key:"CORS_ALLOWED_ORIGINS",category:"networking",severity:"warning",status:"drifted",values:{dev:"*",staging:"https://staging.example.com",prod:"https://example.com"},detectedAt:"2026-02-20T16:30:00Z",lastChangedBy:"security-team@company.com",description:"Wildcard CORS in dev doesn't reflect production restrictions â€” CORS bugs will only surface in production.",expectedValue:"https://example.com"},{id:"d011",key:"DB_QUERY_TIMEOUT_MS",category:"database",severity:"warning",status:"drifted",values:{dev:"30000",staging:"10000",prod:"5000"},detectedAt:"2026-02-21T07:15:00Z",lastChangedBy:"dba-team@company.com",description:"Query timeouts are much looser in dev â€” slow queries won't be caught during development.",expectedValue:"5000"},{id:"d012",key:"FEATURE_FLAG_AI_SEARCH",category:"feature-flags",severity:"info",status:"drifted",values:{dev:"true",staging:"false",prod:"false"},detectedAt:"2026-02-22T00:00:00Z",lastChangedBy:"ai-team@company.com",description:"AI search feature in active dev â€” not ready for staging or production rollout.",expectedValue:"false"},{id:"d013",key:"SECRET_ROTATION_INTERVAL_DAYS",category:"secrets",severity:"critical",status:"drifted",values:{dev:"365",staging:"90",prod:"30"},detectedAt:"2026-02-21T14:00:00Z",lastChangedBy:"security-bot@company.com",description:"Secret rotation intervals differ greatly â€” dev secrets outlast prod rotation policy by 12x.",expectedValue:"30"},{id:"d014",key:"CACHE_TTL_SECONDS",category:"cache",severity:"warning",status:"ignored",values:{dev:"60",staging:"300",prod:"3600"},detectedAt:"2026-02-19T13:00:00Z",lastChangedBy:"cache-team@company.com",description:"Cache TTL intentionally lower in dev for faster iteration â€” marked as ignored drift.",expectedValue:"3600"},{id:"d015",key:"OAUTH_PKCE_REQUIRED",category:"auth",severity:"critical",status:"drifted",values:{dev:"false",staging:"false",prod:"true"},detectedAt:"2026-02-21T20:00:00Z",lastChangedBy:"security-team@company.com",description:"PKCE enforcement disabled in dev/staging â€” OAuth flow security untested against production requirements.",expectedValue:"true"},{id:"d016",key:"ENABLE_REQUEST_SIGNING",category:"api",severity:"critical",status:"drifted",values:{dev:"false",staging:"true",prod:"true"},detectedAt:"2026-02-20T10:00:00Z",lastChangedBy:"platform-team@company.com",description:"Request signing disabled in dev â€” API authentication bugs won't be caught before production.",expectedValue:"true"},{id:"d017",key:"DB_REPLICA_READ_ENABLED",category:"database",severity:"warning",status:"drifted",values:{dev:"false",staging:"false",prod:"true"},detectedAt:"2026-02-19T15:30:00Z",lastChangedBy:"dba-team@company.com",description:"Read replicas enabled in prod only â€” replica lag issues untestable in lower environments.",expectedValue:"true"},{id:"d018",key:"ALERT_WEBHOOK_URL",category:"networking",severity:"info",status:"drifted",values:{dev:"https://hooks.dev.example.com/alerts",staging:"https://hooks.staging.example.com/alerts",prod:"https://hooks.example.com/alerts"},detectedAt:"2026-02-18T08:00:00Z",lastChangedBy:"platform-team@company.com",description:"Webhook URLs differ by environment â€” this is expected and intentional.",expectedValue:"https://hooks.example.com/alerts"}],$=[{id:"h001",timestamp:"2026-02-22T04:15:00Z",actor:"sarah.chen@company.com",environment:"staging",configKey:"DATABASE_CONNECTION_POOL_SIZE",oldValue:"10",newValue:"25",severity:"critical",action:"changed",comment:"Increasing pool size to handle load test requirements for Q1 launch."},{id:"h002",timestamp:"2026-02-22T03:45:00Z",actor:"security-team@company.com",environment:"dev",configKey:"SMTP_TLS_ENABLED",oldValue:"true",newValue:"false",severity:"critical",action:"changed",comment:"Disabled TLS in dev for local mail testing with Mailhog."},{id:"h003",timestamp:"2026-02-22T01:30:00Z",actor:"alex.rodriguez@company.com",environment:"dev",configKey:"JWT_EXPIRY_SECONDS",oldValue:"3600",newValue:"86400",severity:"critical",action:"changed",comment:"Extended JWT expiry in dev to avoid constant re-login during feature development."},{id:"h004",timestamp:"2026-02-22T00:00:00Z",actor:"ai-team@company.com",environment:"dev",configKey:"FEATURE_FLAG_AI_SEARCH",oldValue:"false",newValue:"true",severity:"info",action:"changed",comment:"Enabling AI search in dev for experimental integration testing."},{id:"h005",timestamp:"2026-02-21T22:10:00Z",actor:"platform-team@company.com",environment:"prod",configKey:"API_RATE_LIMIT_RPM",oldValue:"2000",newValue:"1000",severity:"warning",action:"changed",comment:"Tightening rate limits to protect prod from potential abuse patterns."},{id:"h006",timestamp:"2026-02-21T20:00:00Z",actor:"security-team@company.com",environment:"prod",configKey:"OAUTH_PKCE_REQUIRED",oldValue:"false",newValue:"true",severity:"critical",action:"changed",comment:"Enabling PKCE enforcement per security audit recommendation #SEC-2024-091."},{id:"h007",timestamp:"2026-02-21T18:45:00Z",actor:"ops-bot@company.com",environment:"prod",configKey:"REDIS_CLUSTER_ENABLED",oldValue:"false",newValue:"true",severity:"critical",action:"changed",comment:"Automated cluster migration completed â€” enabling cluster mode in production."},{id:"h008",timestamp:"2026-02-21T14:00:00Z",actor:"security-bot@company.com",environment:"prod",configKey:"SECRET_ROTATION_INTERVAL_DAYS",oldValue:"90",newValue:"30",severity:"critical",action:"changed",comment:"Compliance requirement: secret rotation must be â‰¤30 days per SOC2 audit findings."},{id:"h009",timestamp:"2026-02-21T11:20:00Z",actor:"infra-bot@company.com",environment:"prod",configKey:"S3_BUCKET_VERSIONING",oldValue:"false",newValue:"true",severity:"warning",action:"changed",comment:"Enabling versioning for disaster recovery compliance requirement."},{id:"h010",timestamp:"2026-02-21T07:15:00Z",actor:"dba-team@company.com",environment:"prod",configKey:"DB_QUERY_TIMEOUT_MS",oldValue:"10000",newValue:"5000",severity:"warning",action:"changed",comment:"Stricter query timeouts to prevent runaway queries in production."},{id:"h011",timestamp:"2026-02-20T16:30:00Z",actor:"security-team@company.com",environment:"staging",configKey:"CORS_ALLOWED_ORIGINS",oldValue:"*",newValue:"https://staging.example.com",severity:"warning",action:"changed",comment:"Locking down CORS to staging domain â€” mirrors production restrictions."},{id:"h012",timestamp:"2026-02-20T14:00:00Z",actor:"product-team@company.com",environment:"prod",configKey:"FEATURE_FLAG_DARK_MODE",oldValue:"true",newValue:"false",severity:"info",action:"changed",comment:"Reverting dark mode in prod â€” UX issues reported by beta users, needs polish."},{id:"h013",timestamp:"2026-02-20T10:00:00Z",actor:"platform-team@company.com",environment:"staging",configKey:"ENABLE_REQUEST_SIGNING",oldValue:"false",newValue:"true",severity:"critical",action:"changed",comment:"Enabling request signing in staging to mirror production security posture."},{id:"h014",timestamp:"2026-02-19T15:30:00Z",actor:"dba-team@company.com",environment:"prod",configKey:"DB_REPLICA_READ_ENABLED",oldValue:"false",newValue:"true",severity:"warning",action:"changed",comment:"Enabling read replicas for improved read performance in production."},{id:"h015",timestamp:"2026-02-19T13:00:00Z",actor:"cache-team@company.com",environment:"dev",configKey:"CACHE_TTL_SECONDS",oldValue:"3600",newValue:"60",severity:"warning",action:"ignored",comment:"Intentional deviation â€” short TTL in dev enables faster cache invalidation during development."},{id:"h016",timestamp:"2026-02-19T09:00:00Z",actor:"dev-ops@company.com",environment:"prod",configKey:"LOG_LEVEL",oldValue:"info",newValue:"warn",severity:"warning",action:"changed",comment:"Reducing log verbosity in prod to cut Datadog costs by ~40%."},{id:"h017",timestamp:"2026-02-18T10:30:00Z",actor:"backend-team@company.com",environment:"staging",configKey:"MAX_UPLOAD_SIZE_MB",oldValue:"100",newValue:"50",severity:"info",action:"resolved",comment:"Aligning staging with prod upload limits â€” drift resolved."},{id:"h018",timestamp:"2026-02-18T08:00:00Z",actor:"platform-team@company.com",environment:"dev",configKey:"ALERT_WEBHOOK_URL",oldValue:"https://hooks.example.com/alerts",newValue:"https://hooks.dev.example.com/alerts",severity:"info",action:"changed",comment:"Routing dev alerts to dev-specific webhook to avoid noise in prod Slack channel."}],q=[{id:"p001",name:"Critical Auth Security Drift",description:"Alert immediately when authentication or authorization configs differ between staging and prod. Zero tolerance.",enabled:!0,category:"auth",severity:"critical",environments:["staging","prod"],threshold:0,ignorePatterns:[],lastTriggered:"2026-02-22T01:30:00Z",triggerCount:12},{id:"p002",name:"Database Configuration Parity",description:"Ensure database settings (pool size, timeouts, replicas) are consistent between staging and production.",enabled:!0,category:"database",severity:"critical",environments:["staging","prod"],threshold:0,ignorePatterns:["*_DEV_*"],lastTriggered:"2026-02-22T04:15:00Z",triggerCount:8},{id:"p003",name:"API Rate Limit Variance",description:"Warn when API rate limits differ by more than 50% between any two environments.",enabled:!0,category:"api",severity:"warning",environments:["dev","staging","prod"],threshold:50,ignorePatterns:[],lastTriggered:"2026-02-21T22:10:00Z",triggerCount:5},{id:"p004",name:"Feature Flag Sync Tracker",description:"Track feature flags enabled in dev but not yet in production â€” informational, not blocking.",enabled:!0,category:"feature-flags",severity:"info",environments:["dev","prod"],threshold:0,ignorePatterns:["FEATURE_FLAG_*_EXPERIMENTAL"],lastTriggered:"2026-02-22T00:00:00Z",triggerCount:23},{id:"p005",name:"Secret Rotation Compliance",description:"Enforce consistent secret rotation policies across all environments per SOC2 requirements.",enabled:!0,category:"secrets",severity:"critical",environments:["dev","staging","prod"],threshold:0,ignorePatterns:[],lastTriggered:"2026-02-21T14:00:00Z",triggerCount:3},{id:"p006",name:"Network Security Parity",description:"Ensure networking and TLS settings in staging match production security posture.",enabled:!0,category:"networking",severity:"critical",environments:["staging","prod"],threshold:0,ignorePatterns:[],lastTriggered:"2026-02-22T03:45:00Z",triggerCount:6},{id:"p007",name:"Cache TTL Monitoring",description:"Inform when cache TTL deviates by more than 5x between dev and production environments.",enabled:!1,category:"cache",severity:"warning",environments:["dev","staging","prod"],threshold:500,ignorePatterns:["CACHE_TTL_DEV_*"],lastTriggered:null,triggerCount:0},{id:"p008",name:"Log Level Enforcement",description:"Warn when log levels differ between staging and prod â€” staging should mirror prod verbosity.",enabled:!0,category:"logging",severity:"warning",environments:["staging","prod"],threshold:0,ignorePatterns:[],lastTriggered:"2026-02-19T09:00:00Z",triggerCount:4}],Q=[{id:"ir001",pattern:"FEATURE_FLAG_*_EXPERIMENTAL",reason:"Experimental feature flags are expected to differ between environments by product design.",addedBy:"product-team@company.com",addedAt:"2026-02-01T00:00:00Z",matchCount:7,enabled:!0},{id:"ir002",pattern:"LOG_LEVEL_DEV",reason:"Dev log verbosity is intentionally higher for debugging purposes.",addedBy:"dev-ops@company.com",addedAt:"2026-01-15T00:00:00Z",matchCount:1,enabled:!0},{id:"ir003",pattern:"*_LOCAL_*",reason:"Local-only config keys are not expected to match any environment by definition.",addedBy:"platform-team@company.com",addedAt:"2025-12-01T00:00:00Z",matchCount:12,enabled:!0},{id:"ir004",pattern:"CACHE_TTL_*",reason:"Cache TTL differences between dev and prod are acceptable per team agreement (Feb 2026).",addedBy:"cache-team@company.com",addedAt:"2026-02-19T13:00:00Z",matchCount:2,enabled:!1},{id:"ir005",pattern:"ALERT_WEBHOOK_URL",reason:"Webhook URLs differ by environment intentionally â€” each env routes to its own alert channel.",addedBy:"platform-team@company.com",addedAt:"2026-02-18T09:00:00Z",matchCount:1,enabled:!0}];function Z(s){return new Date(s).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function U(s){return new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function R(s){const a=new Date("2026-02-22T06:44:00Z"),o=new Date(s),m=a.getTime()-o.getTime(),c=Math.floor(m/6e4);if(c<1)return"just now";if(c<60)return`${c}m ago`;const d=Math.floor(c/60);return d<24?`${d}h ago`:`${Math.floor(d/24)}d ago`}function k(s){return s==="critical"?"text-rose-400":s==="warning"?"text-amber-400":"text-indigo-400"}function _(s){return s==="critical"?"bg-rose-400/10 border-rose-400/30":s==="warning"?"bg-amber-400/10 border-amber-400/30":"bg-indigo-400/10 border-indigo-400/30"}function K(s){return s==="critical"?"bg-rose-400":s==="warning"?"bg-amber-400":"bg-indigo-400"}function z(s){return s==="dev"?"bg-sky-500/20 text-sky-300 border-sky-500/30":s==="staging"?"bg-amber-500/20 text-amber-300 border-amber-500/30":"bg-emerald-500/20 text-emerald-300 border-emerald-500/30"}function w(s){return s==="dev"?"Dev":s==="staging"?"Staging":"Prod"}function L(s){return{database:"Database",api:"API",auth:"Auth",cache:"Cache","feature-flags":"Feature Flags",networking:"Networking",logging:"Logging",secrets:"Secrets",all:"All"}[s]}function X(s){return s==="changed"?"text-amber-400":s==="resolved"?"text-emerald-400":s==="added"?"text-indigo-400":s==="removed"?"text-rose-400":"text-zinc-400"}function P(s,a){const o=a.filter(u=>u.status==="drifted"),m=o.filter(u=>u.severity==="critical"&&u.values[s]!==null),c=o.filter(u=>u.severity==="warning"&&u.values[s]!==null),d=a.length,x=m.length*15+c.length*5;return Math.max(0,Math.round((d-x/10)/d*100))}function y({children:s,className:a}){return e.jsx("span",{className:g("inline-flex items-center px-2 py-0.5 rounded text-xs font-medium border",a),children:s})}function M({enabled:s,onChange:a}){return e.jsx("button",{onClick:a,className:g("relative inline-flex h-5 w-9 shrink-0 items-center rounded-full border-2 transition-colors duration-200",s?"bg-indigo-500 border-indigo-500":"bg-zinc-700 border-zinc-600"),children:e.jsx("span",{className:g("inline-block h-3.5 w-3.5 rounded-full bg-white shadow transition-transform duration-200",s?"translate-x-[14px]":"translate-x-0.5")})})}function S({label:s,value:a,sub:o,accent:m,barPercent:c}){const d=m==="critical"?"text-rose-400":m==="warning"?"text-amber-400":m==="success"?"text-emerald-400":"text-indigo-400",x=m==="critical"?"bg-rose-500":m==="warning"?"bg-amber-500":m==="success"?"bg-emerald-500":"bg-indigo-500";return e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5 flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-semibold text-zinc-400 uppercase tracking-wider",children:s}),e.jsx("span",{className:g("text-4xl font-bold tabular-nums",d),children:a}),o&&e.jsx("span",{className:"text-xs text-zinc-500",children:o}),c!==void 0&&e.jsx("div",{className:"mt-1 h-1.5 bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:g("h-full rounded-full transition-all duration-700",x),style:{width:`${Math.min(100,Math.max(0,c))}%`}})})]})}function Y({env:s,score:a,driftCount:o,criticalCount:m}){const c=a>=80?"text-emerald-400":a>=60?"text-amber-400":"text-rose-400",d=a>=80?"bg-emerald-500":a>=60?"bg-amber-500":"bg-rose-500",x=a>=80?"Healthy":a>=60?"Degraded":"Critical";return e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(y,{className:z(s),children:w(s)}),e.jsx("span",{className:g("text-xs font-medium",c),children:x})]}),e.jsx("div",{className:g("text-5xl font-bold tabular-nums mb-1",c),children:a}),e.jsx("div",{className:"text-xs text-zinc-500 mb-3",children:"Health score"}),e.jsx("div",{className:"h-2 bg-zinc-800 rounded-full overflow-hidden mb-3",children:e.jsx("div",{className:g("h-full rounded-full transition-all duration-700",d),style:{width:`${a}%`}})}),e.jsxs("div",{className:"flex gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-rose-400 font-semibold",children:m}),e.jsx("span",{className:"text-zinc-500 ml-1",children:"critical"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-amber-400 font-semibold",children:o}),e.jsx("span",{className:"text-zinc-500 ml-1",children:"total drifts"})]})]})]})}function J({envA:s,envB:a,entries:o}){if(s===a)return e.jsx("div",{className:"h-14 flex items-center justify-center bg-zinc-800/30 rounded text-zinc-700 text-xs font-mono select-none",children:"â€•"});const m=o.filter(x=>x.status==="drifted"&&x.values[s]!==x.values[a]),c=m.filter(x=>x.severity==="critical"),d=m.length===0;return e.jsx("div",{className:g("h-14 flex flex-col items-center justify-center rounded border text-xs font-medium transition-all cursor-default select-none",d?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":c.length>0?"bg-rose-500/10 border-rose-500/30 text-rose-400":"bg-amber-500/10 border-amber-500/30 text-amber-400"),children:d?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-lg leading-tight",children:"âœ“"}),e.jsx("span",{className:"text-[10px] opacity-70",children:"In Sync"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-base font-bold leading-tight",children:m.length}),e.jsx("span",{className:"text-[10px] opacity-70",children:c.length>0?`${c.length} critical`:"drifts"})]})})}function ee({entries:s}){const o=["database","api","auth","cache","feature-flags","networking","logging","secrets"].map(c=>({cat:c,drifted:s.filter(d=>d.category===c&&d.status==="drifted").length,total:s.filter(d=>d.category===c).length})).filter(c=>c.total>0).sort((c,d)=>d.drifted-c.drifted),m=Math.max(...o.map(c=>c.drifted),1);return e.jsx("div",{className:"space-y-2",children:o.map(({cat:c,drifted:d,total:x})=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-zinc-400 w-28 shrink-0",children:L(c)}),e.jsxs("div",{className:"flex-1 h-6 bg-zinc-800 rounded overflow-hidden relative",children:[e.jsx("div",{className:g("h-full rounded transition-all duration-700",d===0?"bg-emerald-500/20":"bg-indigo-500"),style:{width:`${Math.max(4,d/m*100)}%`}}),e.jsx("span",{className:"absolute inset-0 flex items-center pl-2 text-xs font-medium text-white/70",children:d>0?`${d} drift${d!==1?"s":""}`:"Clean"})]}),e.jsxs("span",{className:"text-xs text-zinc-500 w-10 text-right shrink-0",children:[d,"/",x]})]},c))})}function te({entries:s}){const o=[3,5,4,8,6,10,s.filter(d=>d.status==="drifted").length],m=["Mon","Tue","Wed","Thu","Fri","Sat","Today"],c=Math.max(...o,1);return e.jsx("div",{children:e.jsx("div",{className:"flex items-end gap-2 h-28",children:o.map((d,x)=>{const u=x===o.length-1,N=d/c*100;return e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end gap-1",children:[e.jsx("span",{className:"text-[10px] text-zinc-500",children:d}),e.jsx("div",{className:g("w-full rounded-t transition-all duration-500",u?"bg-indigo-500":"bg-zinc-700"),style:{height:`${N}%`,minHeight:"4px"}}),e.jsx("span",{className:"text-[9px] text-zinc-600",children:m[x]})]},x)})})})}function se({entries:s}){const a=s.length,o=s.filter(n=>n.status==="drifted").length,m=s.filter(n=>n.status==="drifted"&&n.severity==="critical").length,c=s.filter(n=>n.status==="resolved").length,d=s.filter(n=>n.status==="ignored").length,x=["dev","staging","prod"],u=P("dev",s),N=P("staging",s),j=P("prod",s),f={dev:u,staging:N,prod:j},i=n=>s.filter(l=>l.status==="drifted"&&x.some(v=>v!==n&&l.values[n]!==l.values[v])).length,r=n=>s.filter(l=>l.status==="drifted"&&l.severity==="critical"&&x.some(v=>v!==n&&l.values[n]!==l.values[v])).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(S,{label:"Total Configs Tracked",value:a,sub:"across all environments",accent:"default",barPercent:100}),e.jsx(S,{label:"Active Drifts",value:o,sub:`${Math.round(o/a*100)}% of tracked configs`,accent:"critical",barPercent:o/a*100}),e.jsx(S,{label:"Critical Drifts",value:m,sub:"immediate attention needed",accent:"critical",barPercent:m/a*100}),e.jsx(S,{label:"Resolved / Ignored",value:c,sub:`${d} currently ignored`,accent:"success",barPercent:c/a*100})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-zinc-300 mb-3",children:"Environment Health"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:x.map(n=>e.jsx(Y,{env:n,score:f[n],driftCount:i(n),criticalCount:r(n)},n))})]}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Environment Sync Matrix"}),e.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:"Pairwise drift count between environments"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-zinc-400",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-emerald-500/20 border border-emerald-500/30"}),"In Sync"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-amber-500/20 border border-amber-500/30"}),"Drifted"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-rose-500/20 border border-rose-500/30"}),"Critical"]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsx("div",{}),x.map(n=>e.jsx("div",{className:"text-center",children:e.jsx(y,{className:z(n),children:w(n)})},n)),x.map(n=>e.jsxs(G.Fragment,{children:[e.jsx("div",{className:"flex items-center",children:e.jsx(y,{className:z(n),children:w(n)})}),x.map(l=>e.jsx(J,{envA:n,envB:l,entries:s},l))]},n))]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5",children:[e.jsx("h3",{className:"text-sm font-semibold text-white mb-1",children:"Drifts by Category"}),e.jsx("p",{className:"text-xs text-zinc-500 mb-4",children:"Active drift count per config category"}),e.jsx(ee,{entries:s})]}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5",children:[e.jsx("h3",{className:"text-sm font-semibold text-white mb-1",children:"7-Day Drift Trend"}),e.jsx("p",{className:"text-xs text-zinc-500 mb-4",children:"Active drifts detected per day"}),e.jsx(te,{entries:s}),e.jsx("div",{className:"mt-4 pt-4 border-t border-zinc-800 grid grid-cols-3 gap-3 text-center",children:x.map(n=>e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-white",children:i(n)}),e.jsx("div",{className:"mt-1",children:e.jsx(y,{className:g("text-[10px]",z(n)),children:w(n)})}),e.jsx("div",{className:"text-[10px] text-zinc-500 mt-0.5",children:"drifted keys"})]},n))})]})]})]})}function ie({entries:s,onResolve:a,onIgnore:o}){const[m,c]=b.useState("all"),[d,x]=b.useState("drifted"),[u,N]=b.useState("all"),[j,f]=b.useState("severity"),[i,r]=b.useState(null),[n,l]=b.useState(""),[v,C]=b.useState([]),D=["all","database","api","auth","cache","feature-flags","networking","logging","secrets"],E=s.filter(t=>m==="all"||t.severity===m).filter(t=>d==="all"||t.status===d).filter(t=>u==="all"||t.category===u).filter(t=>{if(!n.trim())return!0;const p=n.toLowerCase();return t.key.toLowerCase().includes(p)||t.description.toLowerCase().includes(p)||t.lastChangedBy.toLowerCase().includes(p)}).sort((t,p)=>{if(j==="severity"){const h={critical:0,warning:1,info:2};return h[t.severity]-h[p.severity]}return j==="recent"?new Date(p.detectedAt).getTime()-new Date(t.detectedAt).getTime():t.key.localeCompare(p.key)}),T=t=>{C(p=>p.includes(t)?p.filter(h=>h!==t):[...p,t])},I=()=>{v.forEach(t=>a(t)),C([])},V=()=>{v.forEach(t=>o(t)),C([])};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500 text-sm select-none",children:"âŒ•"}),e.jsx("input",{type:"text",value:n,onChange:t=>l(t.target.value),placeholder:"Search config keys, descriptions, or authorsâ€¦",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg pl-8 pr-4 py-2 text-sm text-zinc-300 placeholder-zinc-600 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/20"}),n&&e.jsx("button",{onClick:()=>l(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-zinc-500 hover:text-zinc-300 text-xs",children:"âœ•"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-zinc-500 font-medium shrink-0",children:"Severity"}),e.jsx("div",{className:"flex gap-1",children:["all","critical","warning","info"].map(t=>e.jsx("button",{onClick:()=>c(t),className:g("px-2.5 py-1 rounded text-xs font-medium border transition-all",m===t?t==="all"?"bg-zinc-700 border-zinc-600 text-white":g(_(t),k(t)):"bg-zinc-800 border-zinc-700 text-zinc-500 hover:text-zinc-300"),children:t==="all"?"All":t.charAt(0).toUpperCase()+t.slice(1)},t))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-zinc-500 font-medium shrink-0",children:"Status"}),e.jsx("div",{className:"flex gap-1",children:["all","drifted","resolved","ignored"].map(t=>e.jsx("button",{onClick:()=>x(t),className:g("px-2.5 py-1 rounded text-xs font-medium border transition-all",d===t?"bg-zinc-700 border-zinc-600 text-white":"bg-zinc-800 border-zinc-700 text-zinc-500 hover:text-zinc-300"),children:t==="all"?"All":t.charAt(0).toUpperCase()+t.slice(1)},t))})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[e.jsx("span",{className:"text-xs text-zinc-500 font-medium",children:"Sort"}),e.jsxs("select",{value:j,onChange:t=>f(t.target.value),className:"bg-zinc-800 border border-zinc-700 text-zinc-300 text-xs rounded px-2 py-1.5 focus:outline-none",children:[e.jsx("option",{value:"severity",children:"By Severity"}),e.jsx("option",{value:"recent",children:"Most Recent"}),e.jsx("option",{value:"key",children:"By Key Name"})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:D.map(t=>e.jsx("button",{onClick:()=>N(t),className:g("px-2 py-0.5 rounded text-xs border transition-all",u===t?"bg-indigo-500/20 border-indigo-500/40 text-indigo-300":"bg-zinc-800 border-zinc-700 text-zinc-500 hover:text-zinc-300"),children:L(t)},t))}),e.jsxs("div",{className:"text-xs text-zinc-500",children:[E.length," result",E.length!==1?"s":"",n&&e.jsxs("span",{className:"ml-1 text-zinc-600",children:["for â€œ",n,"â€"]})]})]}),v.length>0&&e.jsxs("div",{className:"bg-indigo-500/10 border border-indigo-500/30 rounded-xl px-4 py-3 flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm text-indigo-300 font-medium",children:[v.length," selected"]}),e.jsx("button",{onClick:I,className:"px-3 py-1.5 rounded-lg bg-emerald-500/10 border border-emerald-500/30 text-emerald-400 text-xs font-medium hover:bg-emerald-500/20 transition-colors",children:"âœ“ Resolve All"}),e.jsx("button",{onClick:V,className:"px-3 py-1.5 rounded-lg bg-zinc-800 border border-zinc-700 text-zinc-400 text-xs font-medium hover:bg-zinc-700 transition-colors",children:"Ignore All"}),e.jsx("button",{onClick:()=>C([]),className:"ml-auto text-xs text-zinc-500 hover:text-zinc-300 transition-colors",children:"Clear selection"})]}),e.jsxs("div",{className:"space-y-2",children:[E.length===0&&e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-16 text-center",children:[e.jsx("div",{className:"text-zinc-600 text-3xl mb-3",children:"âŒ•"}),e.jsx("div",{className:"text-zinc-500 text-sm font-medium",children:"No drift entries match your filters"}),e.jsx("div",{className:"text-zinc-600 text-xs mt-1",children:"Try adjusting your filters or search query"})]}),E.map(t=>{const p=i===t.id,h=v.includes(t.id),F=["dev","staging","prod"],H=t.status==="drifted"&&t.severity==="critical"?"border-rose-500/30":t.status==="drifted"&&t.severity==="warning"?"border-amber-500/20":"border-zinc-800";return e.jsxs("div",{className:g("bg-zinc-900 border rounded-xl overflow-hidden transition-all",H,h&&"ring-1 ring-indigo-500/40"),children:[e.jsxs("div",{className:"flex items-center",children:[t.status==="drifted"&&e.jsx("button",{onClick:()=>T(t.id),className:"pl-4 pr-2 py-3.5 text-zinc-600 hover:text-indigo-400 transition-colors shrink-0",children:e.jsx("span",{className:"text-base leading-none",children:h?"â˜‘":"â˜"})}),t.status!=="drifted"&&e.jsx("div",{className:"w-4"}),e.jsxs("button",{onClick:()=>r(p?null:t.id),className:"flex-1 px-3 py-3.5 flex items-center gap-3 hover:bg-zinc-800/40 transition-colors text-left",children:[e.jsx("div",{className:g("w-2 h-2 rounded-full shrink-0",K(t.severity))}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-0.5",children:[e.jsx("span",{className:"text-sm font-mono font-semibold text-white truncate",children:t.key}),e.jsx(y,{className:g(_(t.severity),k(t.severity)),children:t.severity}),e.jsx(y,{className:g(t.status==="resolved"?"bg-emerald-400/10 border-emerald-400/30 text-emerald-400":t.status==="ignored"?"bg-zinc-700 border-zinc-600 text-zinc-400":"bg-rose-400/10 border-rose-400/30 text-rose-400"),children:t.status}),e.jsx(y,{className:"bg-zinc-800 border-zinc-700 text-zinc-400",children:L(t.category)})]}),e.jsx("div",{className:"text-xs text-zinc-500 truncate",children:t.description})]}),e.jsxs("div",{className:"text-xs text-zinc-600 shrink-0 text-right hidden sm:block",children:[e.jsx("div",{className:"text-zinc-400",children:R(t.detectedAt)}),e.jsx("div",{className:"text-zinc-600",children:Z(t.detectedAt)})]}),e.jsx("span",{className:"text-zinc-600 text-xs ml-1",children:p?"â–²":"â–¼"})]})]}),p&&e.jsxs("div",{className:"border-t border-zinc-800 px-5 py-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-zinc-400 uppercase tracking-wider mb-2",children:"Current Values Per Environment"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:F.map(A=>{const B=t.values[A],O=B===t.expectedValue;return e.jsxs("div",{className:g("rounded-lg border p-3",O?"border-emerald-500/30 bg-emerald-500/5":"border-zinc-700 bg-zinc-800/50"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx(y,{className:z(A),children:w(A)}),O&&e.jsx("span",{className:"text-[10px] text-emerald-400",children:"âœ“ Expected"})]}),e.jsx("div",{className:"font-mono text-sm text-white break-all",children:B!==null?B:e.jsx("span",{className:"text-zinc-500 italic",children:"not set"})})]},A)})}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Expected value:"}),e.jsx("span",{className:"font-mono text-xs text-emerald-400 bg-emerald-500/10 px-2 py-0.5 rounded border border-emerald-500/20",children:t.expectedValue})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-zinc-500",children:"Last changed by"}),e.jsx("div",{className:"text-zinc-300 mt-0.5 font-mono",children:t.lastChangedBy})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-zinc-500",children:"Detected at"}),e.jsx("div",{className:"text-zinc-300 mt-0.5",children:Z(t.detectedAt)})]})]}),t.status==="drifted"&&e.jsxs("div",{className:"flex flex-wrap gap-2 pt-1",children:[e.jsx("button",{onClick:()=>a(t.id),className:"px-3 py-1.5 rounded-lg bg-emerald-500/10 border border-emerald-500/30 text-emerald-400 text-xs font-medium hover:bg-emerald-500/20 transition-colors",children:"âœ“ Mark Resolved"}),e.jsx("button",{onClick:()=>o(t.id),className:"px-3 py-1.5 rounded-lg bg-zinc-800 border border-zinc-700 text-zinc-400 text-xs font-medium hover:bg-zinc-700 transition-colors",children:"Ignore Drift"}),e.jsx("button",{className:"px-3 py-1.5 rounded-lg bg-indigo-500/10 border border-indigo-500/30 text-indigo-400 text-xs font-medium hover:bg-indigo-500/20 transition-colors",children:"View in History"})]}),t.status==="resolved"&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-emerald-400 bg-emerald-500/10 border border-emerald-500/20 rounded-lg px-3 py-2",children:[e.jsx("span",{children:"âœ“"}),e.jsx("span",{children:"This drift has been marked as resolved."})]}),t.status==="ignored"&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-zinc-400 bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2",children:[e.jsx("span",{children:"â€”"}),e.jsx("span",{children:"This drift is suppressed by an active ignore rule or policy."})]})]})]},t.id)})]})]})}function ne({events:s}){const[a,o]=b.useState("all"),[m,c]=b.useState("all"),[d,x]=b.useState("all"),[u,N]=b.useState(""),j=s.filter(r=>a==="all"||r.environment===a).filter(r=>m==="all"||r.severity===m).filter(r=>d==="all"||r.action===d).filter(r=>{if(!u.trim())return!0;const n=u.toLowerCase();return r.actor.toLowerCase().includes(n)||r.configKey.toLowerCase().includes(n)||r.comment.toLowerCase().includes(n)}),f=[];j.forEach(r=>{const n=U(r.timestamp),l=f.find(v=>v.date===n);l?l.evts.push(r):f.push({date:n,evts:[r]})});const i=["all","changed","resolved","added","removed","ignored"];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500 text-sm select-none",children:"âŒ•"}),e.jsx("input",{type:"text",value:u,onChange:r=>N(r.target.value),placeholder:"Search by actor, config key, or commentâ€¦",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg pl-8 pr-4 py-2 text-sm text-zinc-300 placeholder-zinc-600 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/20"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-zinc-500 font-medium",children:"Environment"}),e.jsx("div",{className:"flex gap-1",children:["all","dev","staging","prod"].map(r=>e.jsx("button",{onClick:()=>o(r),className:g("px-2.5 py-1 rounded text-xs font-medium border transition-all",a===r?r==="all"?"bg-zinc-700 border-zinc-600 text-white":z(r):"bg-zinc-800 border-zinc-700 text-zinc-500 hover:text-zinc-300"),children:r==="all"?"All":w(r)},r))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-zinc-500 font-medium",children:"Action"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:i.map(r=>e.jsx("button",{onClick:()=>x(r),className:g("px-2.5 py-1 rounded text-xs font-medium border transition-all",d===r?"bg-zinc-700 border-zinc-600 text-white":"bg-zinc-800 border-zinc-700 text-zinc-500 hover:text-zinc-300"),children:r==="all"?"All":r.charAt(0).toUpperCase()+r.slice(1)},r))})]})]}),e.jsxs("div",{className:"text-xs text-zinc-500",children:[j.length," event",j.length!==1?"s":""]})]}),f.length===0&&e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-16 text-center",children:[e.jsx("div",{className:"text-zinc-600 text-3xl mb-3",children:"ðŸ“…"}),e.jsx("div",{className:"text-zinc-500 text-sm font-medium",children:"No events match your filters"})]}),f.map(({date:r,evts:n})=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"h-px flex-1 bg-zinc-800"}),e.jsx("span",{className:"text-xs font-semibold text-zinc-500 uppercase tracking-wider px-2",children:r}),e.jsx("div",{className:"h-px flex-1 bg-zinc-800"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-[22px] top-0 bottom-0 w-px bg-zinc-800"}),e.jsx("div",{className:"space-y-3",children:n.map(l=>e.jsxs("div",{className:"relative flex gap-4",children:[e.jsx("div",{className:g("relative z-10 w-3 h-3 rounded-full mt-4 ml-4 shrink-0 border-2 border-zinc-950",K(l.severity))}),e.jsx("div",{className:"flex-1 bg-zinc-900 border border-zinc-800 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("span",{className:g("text-xs font-bold uppercase tracking-wide",X(l.action)),children:l.action}),e.jsx(y,{className:z(l.environment),children:w(l.environment)}),e.jsx(y,{className:g(_(l.severity),k(l.severity)),children:l.severity})]}),e.jsx("div",{className:"font-mono text-sm font-semibold text-white mb-1.5",children:l.configKey}),l.action==="changed"&&e.jsxs("div",{className:"flex items-center gap-2 text-xs mb-1.5",children:[e.jsx("span",{className:"font-mono text-rose-400 bg-rose-400/10 px-1.5 py-0.5 rounded border border-rose-400/20",children:l.oldValue}),e.jsx("span",{className:"text-zinc-600",children:"â†’"}),e.jsx("span",{className:"font-mono text-emerald-400 bg-emerald-400/10 px-1.5 py-0.5 rounded border border-emerald-400/20",children:l.newValue})]}),l.action==="resolved"&&e.jsx("div",{className:"flex items-center gap-2 text-xs mb-1.5",children:e.jsx("span",{className:"font-mono text-emerald-400 bg-emerald-400/10 px-1.5 py-0.5 rounded border border-emerald-400/20",children:"Drift resolved"})}),l.comment&&e.jsxs("div",{className:"text-xs text-zinc-500 italic mt-1",children:["â€œ",l.comment,"â€"]}),e.jsx("div",{className:"mt-2 text-xs text-zinc-600 font-mono",children:l.actor})]}),e.jsxs("div",{className:"text-right shrink-0",children:[e.jsx("div",{className:"text-xs text-zinc-400",children:R(l.timestamp)}),e.jsx("div",{className:"text-[10px] text-zinc-600 mt-0.5",children:Z(l.timestamp)})]})]})})]},l.id))})]})]},r))]})}function re({policies:s,ignoreRules:a,onTogglePolicy:o,onToggleIgnoreRule:m}){const[c,d]=b.useState("policies"),x=s.filter(i=>i.enabled),u=s.filter(i=>!i.enabled),N=s.reduce((i,r)=>i+r.triggerCount,0),j=a.filter(i=>i.enabled),f=a.reduce((i,r)=>i+r.matchCount,0);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>d("policies"),className:g("px-4 py-2 rounded-lg text-sm font-medium border transition-all",c==="policies"?"bg-indigo-500/20 border-indigo-500/40 text-indigo-300":"bg-zinc-900 border-zinc-800 text-zinc-400 hover:text-zinc-300"),children:["Detection Policies (",s.length,")"]}),e.jsxs("button",{onClick:()=>d("ignore-rules"),className:g("px-4 py-2 rounded-lg text-sm font-medium border transition-all",c==="ignore-rules"?"bg-indigo-500/20 border-indigo-500/40 text-indigo-300":"bg-zinc-900 border-zinc-800 text-zinc-400 hover:text-zinc-300"),children:["Ignore Rules (",a.length,")"]})]}),c==="policies"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-emerald-400",children:x.length}),e.jsx("div",{className:"text-xs text-zinc-400 mt-1",children:"Active Policies"})]}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-zinc-500",children:u.length}),e.jsx("div",{className:"text-xs text-zinc-400 mt-1",children:"Disabled"})]}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-indigo-400",children:N}),e.jsx("div",{className:"text-xs text-zinc-400 mt-1",children:"Total Triggers"})]})]}),s.map(i=>e.jsx("div",{className:g("bg-zinc-900 border rounded-xl p-5 transition-all",i.enabled?"border-zinc-800":"border-zinc-800/40 opacity-60"),children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("span",{className:"text-sm font-semibold text-white",children:i.name}),e.jsx(y,{className:g(_(i.severity),k(i.severity)),children:i.severity}),e.jsx(y,{className:"bg-zinc-800 border-zinc-700 text-zinc-400",children:L(i.category)}),!i.enabled&&e.jsx(y,{className:"bg-zinc-800 border-zinc-700 text-zinc-500",children:"disabled"})]}),e.jsx("p",{className:"text-xs text-zinc-500 mb-4",children:i.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-zinc-500 mb-1.5",children:"Environments"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:i.environments.map(r=>e.jsx(y,{className:z(r),children:w(r)},r))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-zinc-500 mb-1",children:"Threshold"}),e.jsx("div",{className:"text-zinc-300 font-medium",children:i.threshold===0?"Any deviation":`Â±${i.threshold}%`})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-zinc-500 mb-1",children:"Total Triggers"}),e.jsx("div",{className:"text-zinc-300 font-medium",children:i.triggerCount})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-zinc-500 mb-1",children:"Last Triggered"}),e.jsx("div",{className:"text-zinc-300 font-medium",children:i.lastTriggered?R(i.lastTriggered):"Never"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"h-1.5 bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-indigo-500/60 rounded-full transition-all duration-700",style:{width:`${Math.min(100,i.triggerCount/Math.max(N,1)*100*3)}%`}})}),e.jsxs("div",{className:"text-[10px] text-zinc-600 mt-0.5",children:[Math.round(i.triggerCount/Math.max(N,1)*100),"% of total triggers"]})]}),i.ignorePatterns.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Ignore patterns"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:i.ignorePatterns.map(r=>e.jsx("span",{className:"font-mono text-[10px] bg-zinc-800 text-zinc-400 px-1.5 py-0.5 rounded border border-zinc-700",children:r},r))})]})]}),e.jsx("div",{className:"shrink-0 mt-1",children:e.jsx(M,{enabled:i.enabled,onChange:()=>o(i.id)})})]})},i.id)),e.jsx("button",{className:"w-full bg-zinc-900 border border-dashed border-zinc-700 rounded-xl p-4 text-sm text-zinc-500 hover:text-zinc-300 hover:border-zinc-600 transition-all",children:"+ Create Detection Policy"})]}),c==="ignore-rules"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-emerald-400",children:j.length}),e.jsx("div",{className:"text-xs text-zinc-400 mt-1",children:"Active Rules"})]}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-zinc-500",children:a.length-j.length}),e.jsx("div",{className:"text-xs text-zinc-400 mt-1",children:"Disabled"})]}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-indigo-400",children:f}),e.jsx("div",{className:"text-xs text-zinc-400 mt-1",children:"Total Matches"})]})]}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-xs text-zinc-400",children:[e.jsx("strong",{className:"text-zinc-300",children:"Ignore rules"})," suppress drift alerts for config keys matching the glob pattern. Use"," ",e.jsx("code",{className:"font-mono bg-zinc-800 px-1 py-0.5 rounded text-indigo-300",children:"*"})," ","as a wildcard. Disabled rules are retained for audit history and can be re-enabled at any time."]}),a.map(i=>e.jsx("div",{className:g("bg-zinc-900 border rounded-xl p-5 transition-all",i.enabled?"border-zinc-800":"border-zinc-800/40 opacity-60"),children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-white",children:i.pattern}),!i.enabled&&e.jsx(y,{className:"bg-zinc-800 border-zinc-700 text-zinc-500",children:"disabled"})]}),e.jsx("p",{className:"text-xs text-zinc-500 mb-3",children:i.reason}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-zinc-500 mb-0.5",children:"Added by"}),e.jsx("div",{className:"text-zinc-300 font-mono truncate",children:i.addedBy})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-zinc-500 mb-0.5",children:"Added"}),e.jsx("div",{className:"text-zinc-300",children:U(i.addedAt)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-zinc-500 mb-0.5",children:"Matches"}),e.jsxs("div",{className:"text-zinc-300",children:[i.matchCount," key",i.matchCount!==1?"s":""]})]})]})]}),e.jsx("div",{className:"shrink-0 mt-1",children:e.jsx(M,{enabled:i.enabled,onChange:()=>m(i.id)})})]})},i.id)),e.jsx("button",{className:"w-full bg-zinc-900 border border-dashed border-zinc-700 rounded-xl p-4 text-sm text-zinc-500 hover:text-zinc-300 hover:border-zinc-600 transition-all",children:"+ Add Ignore Rule"})]})]})}function de(){const[s,a]=b.useState("overview"),[o,m]=b.useState(W),[c,d]=b.useState(q),[x,u]=b.useState(Q),[N,j]=b.useState("2026-02-22T06:44:00Z"),[f,i]=b.useState(!1),[r,n]=b.useState(!0),l=t=>{m(p=>p.map(h=>h.id===t?{...h,status:"resolved"}:h))},v=t=>{m(p=>p.map(h=>h.id===t?{...h,status:"ignored"}:h))},C=t=>{d(p=>p.map(h=>h.id===t?{...h,enabled:!h.enabled}:h))},D=t=>{u(p=>p.map(h=>h.id===t?{...h,enabled:!h.enabled}:h))},E=()=>{f||(i(!0),setTimeout(()=>{j(new Date().toISOString()),i(!1)},1400))},T=o.filter(t=>t.status==="drifted"&&t.severity==="critical").length,I=o.filter(t=>t.status==="drifted").length,V=[{id:"overview",label:"Overview"},{id:"details",label:"Drift Details",badge:I},{id:"history",label:"History"},{id:"policies",label:"Policies"}];return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white",children:[T>0&&r&&e.jsx("div",{className:"bg-rose-500/10 border-b border-rose-500/30 px-6 py-2.5",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center gap-3",children:[e.jsxs("span",{className:"text-rose-400 text-xs font-bold uppercase tracking-wider animate-pulse",children:["â— ",T," Critical Drift",T!==1?"s":""," Detected"]}),e.jsx("span",{className:"text-rose-400/60 text-xs",children:"â€”"}),e.jsx("span",{className:"text-rose-300/70 text-xs",children:"Production environment health may be at risk. Review and resolve immediately."}),e.jsx("button",{onClick:()=>{a("details"),n(!1)},className:"ml-auto text-xs text-rose-400 underline underline-offset-2 hover:text-rose-300 transition-colors",children:"View Critical Drifts â†’"}),e.jsx("button",{onClick:()=>n(!1),className:"text-rose-500 hover:text-rose-300 text-xs transition-colors ml-2",children:"âœ•"})]})}),e.jsx("div",{className:"border-b border-zinc-800 bg-zinc-950/90 backdrop-blur-sm sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2.5 mb-0.5",children:[e.jsx("span",{className:"text-xl select-none",children:"ðŸ”"}),e.jsx("h1",{className:"text-xl font-bold text-white tracking-tight",children:"Environment Drift Detector"}),T>0&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-rose-500/20 border border-rose-500/40 text-rose-400 text-[10px] font-bold",children:[T," CRITICAL"]})]}),e.jsxs("p",{className:"text-xs text-zinc-500",children:["Configuration drift monitoring across"," ",e.jsx("strong",{className:"text-zinc-300",children:"dev"}),","," ",e.jsx("strong",{className:"text-zinc-300",children:"staging"}),", and"," ",e.jsx("strong",{className:"text-zinc-300",children:"prod"})," â€” ",o.length," configs tracked"]})]}),e.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[e.jsxs("div",{className:"text-right text-xs hidden sm:block",children:[e.jsx("div",{className:"text-zinc-600",children:"Last scan"}),e.jsx("div",{className:"text-zinc-400 font-medium",children:R(N)})]}),e.jsx("button",{onClick:E,disabled:f,className:g("px-3 py-1.5 rounded-lg border text-xs font-medium transition-all",f?"bg-zinc-800 border-zinc-700 text-zinc-500 cursor-not-allowed":"bg-indigo-500/10 border-indigo-500/30 text-indigo-400 hover:bg-indigo-500/20"),children:f?"Scanningâ€¦":"â†» Refresh"})]})]}),e.jsx("div",{className:"flex gap-0 mt-4 -mb-px border-b border-zinc-800/0",children:V.map(t=>e.jsxs("button",{onClick:()=>a(t.id),className:g("px-4 py-2 text-sm font-medium border-b-2 transition-all flex items-center gap-1.5 -mb-px",s===t.id?"border-indigo-500 text-white":"border-transparent text-zinc-500 hover:text-zinc-300 hover:border-zinc-700"),children:[t.label,t.badge!==void 0&&t.badge>0&&e.jsx("span",{className:"inline-flex items-center justify-center w-4 h-4 rounded-full bg-rose-500/20 text-rose-400 text-[10px] font-bold",children:t.badge})]},t.id))})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[s==="overview"&&e.jsx(se,{entries:o}),s==="details"&&e.jsx(ie,{entries:o,onResolve:l,onIgnore:v}),s==="history"&&e.jsx(ne,{events:$}),s==="policies"&&e.jsx(re,{policies:c,ignoreRules:x,onTogglePolicy:C,onToggleIgnoreRule:D})]})]})}export{de as default};
