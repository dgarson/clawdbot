import{r as c,j as e,c as i}from"./index-CE8P0xwp.js";const a=[{id:"r1",name:"prod-eks-cluster",type:"AWS EKS Cluster",provider:"aws",region:"us-east-1",status:"drifted",severity:"critical",driftCount:3,lastChecked:"2m ago",expectedBy:"Terraform state",drifts:[{field:"node_group.desired_size",expected:"5",actual:"3",severity:"critical"},{field:"cluster.version",expected:"1.28",actual:"1.27",severity:"high"},{field:"logging.enabled",expected:"true",actual:"false",severity:"medium"}]},{id:"r2",name:"prod-rds-postgres",type:"AWS RDS Instance",provider:"aws",region:"us-east-1",status:"drifted",severity:"high",driftCount:2,lastChecked:"5m ago",expectedBy:"Terraform state",drifts:[{field:"instance_class",expected:"db.r6g.xlarge",actual:"db.r6g.large",severity:"high"},{field:"multi_az",expected:"true",actual:"false",severity:"high"}]},{id:"r3",name:"prod-vpc-main",type:"AWS VPC",provider:"aws",region:"us-east-1",status:"clean",severity:null,driftCount:0,lastChecked:"2m ago",expectedBy:"Terraform state",drifts:[]},{id:"r4",name:"prod-redis-cluster",type:"AWS ElastiCache",provider:"aws",region:"us-east-1",status:"drifted",severity:"medium",driftCount:1,lastChecked:"2m ago",expectedBy:"Terraform state",drifts:[{field:"num_cache_nodes",expected:"3",actual:"2",severity:"medium"}]},{id:"r5",name:"gke-prod-cluster",type:"GCP GKE Cluster",provider:"gcp",region:"us-central1",status:"clean",severity:null,driftCount:0,lastChecked:"3m ago",expectedBy:"Terraform state",drifts:[]},{id:"r6",name:"prod-s3-data-lake",type:"AWS S3 Bucket",provider:"aws",region:"us-east-1",status:"drifted",severity:"low",driftCount:1,lastChecked:"2m ago",expectedBy:"Terraform state",drifts:[{field:"lifecycle_rule.transition_days",expected:"30",actual:"90",severity:"low"}]},{id:"r7",name:"ingress-nginx-deployment",type:"K8s Deployment",provider:"k8s",region:"prod-cluster",status:"drifted",severity:"high",driftCount:2,lastChecked:"1m ago",expectedBy:"Helm values",drifts:[{field:"spec.replicas",expected:"3",actual:"1",severity:"high"},{field:"resources.limits.memory",expected:"512Mi",actual:"256Mi",severity:"medium"}]},{id:"r8",name:"prod-iam-role-deploy",type:"AWS IAM Role",provider:"aws",region:"global",status:"error",severity:null,driftCount:0,lastChecked:"10m ago",expectedBy:"Terraform state",drifts:[]},{id:"r9",name:"cloudflare-dns-main",type:"Azure DNS Zone",provider:"azure",region:"global",status:"clean",severity:null,driftCount:0,lastChecked:"4m ago",expectedBy:"Terraform state",drifts:[]},{id:"r10",name:"prometheus-operator",type:"K8s Deployment",provider:"k8s",region:"prod-cluster",status:"drifted",severity:"medium",driftCount:1,lastChecked:"1m ago",expectedBy:"Helm values",drifts:[{field:"image.tag",expected:"v0.71.0",actual:"v0.68.0",severity:"medium"}]}],A=[{id:"e1",resourceId:"r1",resourceName:"prod-eks-cluster",type:"AWS EKS Cluster",timestamp:"2m ago",driftCount:3,status:"detected"},{id:"e2",resourceId:"r7",resourceName:"ingress-nginx-deployment",type:"K8s Deployment",timestamp:"1m ago",driftCount:2,status:"detected"},{id:"e3",resourceId:"r2",resourceName:"prod-rds-postgres",type:"AWS RDS Instance",timestamp:"5m ago",driftCount:2,status:"detected"},{id:"e4",resourceId:"r4",resourceName:"prod-redis-cluster",type:"AWS ElastiCache",timestamp:"15m ago",driftCount:1,status:"acknowledged",remediatedBy:"platform-oncall"},{id:"e5",resourceId:"r1",resourceName:"prod-eks-cluster",type:"AWS EKS Cluster",timestamp:"1h ago",driftCount:1,status:"remediated",remediatedBy:"terraform-apply"},{id:"e6",resourceId:"r10",resourceName:"prometheus-operator",type:"K8s Deployment",timestamp:"2h ago",driftCount:1,status:"detected"},{id:"e7",resourceId:"r3",resourceName:"prod-vpc-main",type:"AWS VPC",timestamp:"3h ago",driftCount:2,status:"remediated",remediatedBy:"terraform-apply"},{id:"e8",resourceId:"r6",resourceName:"prod-s3-data-lake",type:"AWS S3 Bucket",timestamp:"4h ago",driftCount:1,status:"ignored"}],v={drifted:"text-rose-400",clean:"text-emerald-400",unknown:"text-zinc-500",error:"text-amber-400"},b={drifted:"bg-rose-500/10 border-rose-500/30",clean:"bg-emerald-500/10 border-emerald-500/30",unknown:"bg-zinc-700/30 border-zinc-600",error:"bg-amber-500/10 border-amber-500/30"},p={critical:"text-rose-400",high:"text-orange-400",medium:"text-amber-400",low:"text-sky-400"},u={critical:"bg-rose-500/10 border-rose-500/30",high:"bg-orange-500/10 border-orange-500/30",medium:"bg-amber-500/10 border-amber-500/30",low:"bg-sky-500/10 border-sky-500/30"},D={detected:"text-rose-400",remediated:"text-emerald-400",acknowledged:"text-amber-400",ignored:"text-zinc-500"},o={aws:"â˜ï¸",gcp:"ðŸŒ",azure:"ðŸ’ ",k8s:"âš™ï¸"};function I(){const[d,h]=c.useState("overview"),[r,f]=c.useState(null),[x,g]=c.useState("all"),[m,j]=c.useState("all"),y=[{id:"overview",label:"Overview",emoji:"ðŸ—ºï¸"},{id:"resources",label:"Resources",emoji:"ðŸ—ï¸"},{id:"history",label:"Drift History",emoji:"ðŸ“œ"},{id:"remediation",label:"Remediation",emoji:"ðŸ”§"}],N=a.filter(s=>s.status==="drifted").length,z=a.filter(s=>s.status==="clean").length,C=a.reduce((s,t)=>s+t.driftCount,0),l=a.filter(s=>s.severity==="critical").length,w=a.filter(s=>!(x!=="all"&&s.provider!==x||m!=="all"&&s.status!==m)),k=a.reduce((s,t)=>(t.status==="drifted"&&(s[t.provider]=(s[t.provider]||0)+1),s),{});return e.jsxs("div",{className:"flex flex-col h-full bg-zinc-950 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-zinc-800",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold tracking-tight",children:"Infrastructure Drift Detector"}),e.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:"Comparing live state vs Terraform / Helm expected state"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l>0&&e.jsx("div",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded bg-rose-500/10 border border-rose-500/30",children:e.jsxs("span",{className:"text-xs text-rose-400 font-medium",children:["ðŸš¨ ",l," critical"]})}),e.jsx("button",{className:"px-3 py-1.5 text-xs bg-indigo-600 hover:bg-indigo-500 rounded text-white transition-colors",children:"â†» Scan Now"})]})]}),e.jsx("div",{className:"grid grid-cols-5 gap-0 border-b border-zinc-800",children:[{label:"Total Resources",value:String(a.length),sub:"monitored"},{label:"Drifted",value:String(N),sub:`${C} drift points`,alert:!0},{label:"Clean",value:String(z),sub:"in sync with IaC"},{label:"Critical Drifts",value:String(l),sub:"require immediate action",alert:l>0},{label:"Last Full Scan",value:"2m ago",sub:"next in 8m"}].map((s,t)=>e.jsxs("div",{className:i("px-6 py-3 border-r border-zinc-800 last:border-r-0",s.alert&&"bg-rose-500/5"),children:[e.jsx("div",{className:i("text-xl font-bold",s.alert?"text-rose-400":"text-white"),children:s.value}),e.jsx("div",{className:"text-xs font-medium text-zinc-400 mt-0.5",children:s.label}),e.jsx("div",{className:"text-xs text-zinc-600 mt-0.5",children:s.sub})]},t))}),e.jsx("div",{className:"flex border-b border-zinc-800 px-6",children:y.map(s=>e.jsxs("button",{onClick:()=>h(s.id),className:i("flex items-center gap-1.5 px-4 py-3 text-sm font-medium border-b-2 transition-colors",d===s.id?"border-indigo-500 text-white":"border-transparent text-zinc-500 hover:text-zinc-300"),children:[e.jsx("span",{children:s.emoji}),s.label]},s.id))}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[d==="overview"&&e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-zinc-300 mb-3",children:"Drifted Resources"}),e.jsx("div",{className:"space-y-2",children:a.filter(s=>s.status==="drifted").map(s=>e.jsxs("div",{className:"bg-zinc-900 rounded-lg border border-zinc-800 hover:border-zinc-700 p-4 cursor-pointer transition-colors",onClick:()=>{h("resources"),f(s)},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl shrink-0",children:o[s.provider]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm text-white",children:s.name}),s.severity&&e.jsx("span",{className:i("text-xs px-1.5 py-0.5 rounded border",u[s.severity]),children:e.jsx("span",{className:p[s.severity],children:s.severity})})]}),e.jsxs("p",{className:"text-xs text-zinc-500",children:[s.type," Â· ",s.region]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium text-rose-400",children:[s.driftCount," drift",s.driftCount!==1?"s":""]}),e.jsxs("div",{className:"text-xs text-zinc-600",children:["vs ",s.expectedBy]})]})]}),e.jsxs("div",{className:"mt-3 space-y-1",children:[s.drifts.slice(0,2).map((t,n)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs font-mono",children:[e.jsx("span",{className:i("shrink-0 px-1.5 py-0.5 rounded",u[t.severity]),children:e.jsx("span",{className:p[t.severity],children:t.severity[0].toUpperCase()})}),e.jsxs("span",{className:"text-zinc-400",children:[t.field,":"]}),e.jsx("span",{className:"text-emerald-400/60 line-through",children:t.expected}),e.jsx("span",{className:"text-zinc-500",children:"â†’"}),e.jsx("span",{className:"text-rose-400",children:t.actual})]},n)),s.drifts.length>2&&e.jsxs("div",{className:"text-xs text-zinc-600",children:["+",s.drifts.length-2," more drift points"]})]})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-zinc-300 mb-3",children:"Drift by Provider"}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:["aws","gcp","azure","k8s"].map(s=>{const t=a.filter(S=>S.provider===s).length,n=k[s]||0;return e.jsxs("div",{className:"bg-zinc-900 rounded-lg border border-zinc-800 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:o[s]}),e.jsx("span",{className:"text-sm font-medium text-zinc-300 uppercase",children:s})]}),e.jsx("div",{className:"h-1.5 bg-zinc-800 rounded-full overflow-hidden mb-1",children:e.jsx("div",{className:"h-full bg-rose-500 rounded-full",style:{width:t>0?`${n/t*100}%`:"0%"}})}),e.jsxs("div",{className:"text-xs text-zinc-500",children:[n,"/",t," resources drifted"]})]},s)})})]})]}),d==="resources"&&e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-96 border-r border-zinc-800 flex flex-col",children:[e.jsx("div",{className:"p-3 border-b border-zinc-800 space-y-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:x,onChange:s=>g(s.target.value),className:"flex-1 bg-zinc-900 border border-zinc-700 rounded px-2 py-1 text-xs text-zinc-300",children:[e.jsx("option",{value:"all",children:"All providers"}),e.jsx("option",{value:"aws",children:"AWS"}),e.jsx("option",{value:"gcp",children:"GCP"}),e.jsx("option",{value:"azure",children:"Azure"}),e.jsx("option",{value:"k8s",children:"Kubernetes"})]}),e.jsxs("select",{value:m,onChange:s=>j(s.target.value),className:"flex-1 bg-zinc-900 border border-zinc-700 rounded px-2 py-1 text-xs text-zinc-300",children:[e.jsx("option",{value:"all",children:"All status"}),e.jsx("option",{value:"drifted",children:"Drifted"}),e.jsx("option",{value:"clean",children:"Clean"}),e.jsx("option",{value:"error",children:"Error"})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:w.map(s=>e.jsxs("button",{onClick:()=>f(s),className:i("w-full text-left px-4 py-3 border-b border-zinc-800/50 hover:bg-zinc-900 transition-colors",(r==null?void 0:r.id)===s.id&&"bg-zinc-800"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-base",children:o[s.provider]}),e.jsx("span",{className:"text-xs font-mono text-zinc-200 truncate max-w-[180px]",children:s.name})]}),e.jsx("span",{className:i("text-xs px-1.5 py-0.5 rounded border shrink-0",b[s.status]),children:e.jsx("span",{className:v[s.status],children:s.status})})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-zinc-600",children:[e.jsx("span",{children:s.type}),s.driftCount>0&&e.jsxs("span",{className:"text-rose-400",children:[s.driftCount," drifts"]})]})]},s.id))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:r?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("span",{className:"text-2xl",children:o[r.provider]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-mono text-sm font-semibold text-white",children:r.name}),e.jsxs("p",{className:"text-xs text-zinc-500",children:[r.type," Â· ",r.region]})]}),e.jsx("span",{className:i("ml-auto text-xs px-2 py-0.5 rounded border",b[r.status]),children:e.jsx("span",{className:v[r.status],children:r.status})})]})}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{label:"Expected By",value:r.expectedBy},{label:"Last Checked",value:r.lastChecked},{label:"Drift Points",value:String(r.driftCount)}].map(({label:s,value:t})=>e.jsxs("div",{className:"bg-zinc-900 rounded p-3",children:[e.jsx("div",{className:"text-xs text-zinc-500",children:s}),e.jsx("div",{className:"text-sm font-medium text-zinc-200 mt-0.5",children:t})]},s))}),r.drifts.length>0?e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-3 uppercase tracking-wider",children:"Drift Details"}),e.jsx("div",{className:"space-y-2",children:r.drifts.map((s,t)=>e.jsxs("div",{className:i("rounded-lg border p-4",s.severity==="critical"?"bg-rose-500/5 border-rose-500/20":s.severity==="high"?"bg-orange-500/5 border-orange-500/20":"bg-zinc-900 border-zinc-800"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:i("text-xs px-2 py-0.5 rounded border font-medium",u[s.severity]),children:e.jsx("span",{className:p[s.severity],children:s.severity})}),e.jsx("span",{className:"font-mono text-sm text-zinc-200",children:s.field})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 font-mono text-xs",children:[e.jsxs("div",{className:"bg-emerald-500/5 border border-emerald-500/20 rounded p-2",children:[e.jsx("div",{className:"text-zinc-500 mb-1",children:"Expected (IaC)"}),e.jsx("div",{className:"text-emerald-400",children:s.expected})]}),e.jsxs("div",{className:"bg-rose-500/5 border border-rose-500/20 rounded p-2",children:[e.jsx("div",{className:"text-zinc-500 mb-1",children:"Actual (live)"}),e.jsx("div",{className:"text-rose-400",children:s.actual})]})]})]},t))})]}):e.jsxs("div",{className:"bg-emerald-500/5 border border-emerald-500/20 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-emerald-400 font-medium text-sm",children:"âœ“ No drift detected"}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Resource matches expected state"})]}),r.drifts.length>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 text-xs bg-indigo-600 hover:bg-indigo-500 rounded text-white transition-colors",children:"Apply Fix (terraform apply)"}),e.jsx("button",{className:"px-3 py-1.5 text-xs bg-zinc-800 hover:bg-zinc-700 border border-zinc-700 rounded text-zinc-300 transition-colors",children:"Acknowledge"}),e.jsx("button",{className:"px-3 py-1.5 text-xs bg-zinc-800 hover:bg-zinc-700 border border-zinc-700 rounded text-zinc-300 transition-colors",children:"View Plan"})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-zinc-600 text-sm",children:"Select a resource to view drift details"})})]}),d==="history"&&e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-2",children:A.map(s=>e.jsxs("div",{className:i("bg-zinc-900 rounded-lg border px-5 py-3 flex items-center gap-4",s.status==="detected"?"border-rose-500/20":"border-zinc-800"),children:[e.jsx("span",{className:"text-lg shrink-0",children:s.status==="remediated"?"âœ…":s.status==="acknowledged"?"ðŸ‘ï¸":s.status==="ignored"?"ðŸ”•":"ðŸš¨"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm text-zinc-200",children:s.resourceName}),e.jsx("span",{className:"text-xs text-zinc-500",children:s.type})]}),e.jsxs("div",{className:"text-xs text-zinc-600 mt-0.5",children:[s.driftCount," drift",s.driftCount!==1?"s":""," detected",s.remediatedBy&&e.jsxs("span",{children:[" Â· remediated by ",e.jsx("span",{className:"text-zinc-400",children:s.remediatedBy})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:i("text-xs font-medium",D[s.status]),children:s.status}),e.jsx("div",{className:"text-xs text-zinc-600 mt-0.5",children:s.timestamp})]})]},s.id))})}),d==="remediation"&&e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-zinc-300 mb-4",children:"Auto-Remediation Plan"}),e.jsxs("div",{className:"bg-zinc-900 rounded-lg border border-zinc-800 p-5 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-white",children:"Terraform Apply"}),e.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:"Will reconcile 7 drifted resources across AWS + Kubernetes"})]}),e.jsx("button",{className:"px-4 py-2 text-sm bg-indigo-600 hover:bg-indigo-500 rounded text-white transition-colors",children:"Run Plan â†’"})]}),e.jsx("div",{className:"space-y-1",children:a.filter(s=>s.status==="drifted").map(s=>e.jsxs("div",{className:"flex items-center gap-2 text-xs font-mono text-zinc-500 py-0.5",children:[e.jsx("span",{className:"text-amber-400",children:"~"}),e.jsx("span",{className:"text-zinc-300",children:s.type.toLowerCase().replace(/ /g,"_")}),e.jsx("span",{className:"text-zinc-600",children:s.name}),e.jsxs("span",{className:"text-rose-400 ml-auto",children:[s.driftCount," change",s.driftCount!==1?"s":""]})]},s.id))}),e.jsxs("div",{className:"bg-zinc-800 rounded p-3 font-mono text-xs text-zinc-400",children:[e.jsx("div",{className:"text-zinc-500",children:"$ terraform plan -out=drift-fix.tfplan"}),e.jsx("div",{className:"text-emerald-400 mt-1",children:"Plan: 0 to add, 7 to change, 0 to destroy."}),e.jsx("div",{className:"text-zinc-600 mt-0.5",children:"Changes to Outputs: (none)"})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-zinc-300 mb-4",children:"Remediation Settings"}),e.jsx("div",{className:"space-y-3",children:[{name:"Auto-remediate critical drifts",desc:"Automatically apply fixes for critical severity drifts",enabled:!1},{name:"Auto-remediate K8s replicas",desc:"Re-scale deployments to match Helm values",enabled:!0},{name:"Notify on drift detected",desc:"Send Slack alert when drift is first detected",enabled:!0},{name:"Block deploys on critical drift",desc:"Pause CI/CD pipeline until critical drifts are resolved",enabled:!1}].map(s=>e.jsxs("div",{className:"flex items-center justify-between bg-zinc-900 rounded-lg border border-zinc-800 px-4 py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-zinc-200",children:s.name}),e.jsx("div",{className:"text-xs text-zinc-500 mt-0.5",children:s.desc})]}),e.jsx("div",{className:i("w-10 h-5 rounded-full relative shrink-0 cursor-pointer transition-colors",s.enabled?"bg-indigo-600":"bg-zinc-700"),children:e.jsx("div",{className:i("absolute top-0.5 w-4 h-4 rounded-full bg-white transition-transform",s.enabled?"translate-x-5":"translate-x-0.5")})})]},s.name))})]})]})]})]})}export{I as default};
