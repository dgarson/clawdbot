import{r as N,R as q,j as e,c as d}from"./index-AZTR846M.js";const o=[{id:"gateway",name:"Gateway",status:"healthy",icon:"ðŸŒ",region:"us-east-1",cpu:34,ram:52,uptime:"47d 12h",requestRate:12400,errorRate:.02,events:["Scaled up replicas â†’ 4","TLS cert renewed","Rate-limit threshold raised"],x:80,y:40},{id:"api-server",name:"API Server",status:"healthy",icon:"âš¡",region:"us-east-1",cpu:61,ram:74,uptime:"47d 12h",requestRate:9800,errorRate:.05,events:["Deployed v2.14.1","Connection pool resized","Health-check latency spike resolved"],x:310,y:40},{id:"agent-1",name:"Agent Runtime 1",status:"healthy",icon:"ðŸ¤–",region:"us-east-1",cpu:78,ram:81,uptime:"12d 3h",requestRate:3200,errorRate:.1,events:["Model swap complete","Memory GC triggered","Queue depth normalised"],x:540,y:40},{id:"agent-2",name:"Agent Runtime 2",status:"degraded",icon:"ðŸ¤–",region:"us-east-1",cpu:92,ram:88,uptime:"12d 3h",requestRate:2900,errorRate:1.4,events:["CPU throttling detected","OOM kill on worker-7","Auto-restart triggered"],x:540,y:140},{id:"redis",name:"Redis Cache",status:"healthy",icon:"ðŸ”´",region:"us-east-1",cpu:18,ram:45,uptime:"90d 1h",requestRate:48e3,errorRate:0,events:["Snapshot saved","Eviction policy active","Replica sync OK"],x:310,y:140},{id:"postgres",name:"Postgres DB",status:"healthy",icon:"ðŸ˜",region:"us-east-1",cpu:42,ram:67,uptime:"90d 1h",requestRate:6100,errorRate:.01,events:["Vacuum completed","Replication lag 0ms","Backup verified"],x:80,y:140},{id:"agent-3",name:"Agent Runtime 3",status:"offline",icon:"ðŸ¤–",region:"us-west-2",cpu:0,ram:0,uptime:"0d 0h",requestRate:0,errorRate:0,events:["Node unreachable","Drain initiated","Replacement provisioning"],x:80,y:40},{id:"vector",name:"Vector Store",status:"healthy",icon:"ðŸ“",region:"us-west-2",cpu:55,ram:72,uptime:"30d 8h",requestRate:4200,errorRate:.03,events:["Index rebuild complete","Shard rebalanced","Query cache warmed"],x:310,y:40},{id:"mq",name:"Message Queue",status:"degraded",icon:"ðŸ“¨",region:"us-west-2",cpu:83,ram:59,uptime:"30d 8h",requestRate:18700,errorRate:.8,events:["Consumer lag increasing","Partition rebalance","Dead-letter queue growing"],x:540,y:40},{id:"cdn",name:"CDN Edge",status:"healthy",icon:"ðŸŒ",region:"us-west-2",cpu:12,ram:28,uptime:"120d 0h",requestRate:74e3,errorRate:.01,events:["Cache hit ratio 98.4%","Origin pull spike resolved","New POP deployed"],x:310,y:140}],w=[{from:"gateway",to:"api-server",volume:"high"},{from:"api-server",to:"agent-1",volume:"high"},{from:"api-server",to:"agent-2",volume:"medium"},{from:"api-server",to:"redis",volume:"high"},{from:"api-server",to:"postgres",volume:"medium"},{from:"agent-1",to:"vector",volume:"medium"},{from:"agent-2",to:"mq",volume:"low"},{from:"mq",to:"agent-3",volume:"low"},{from:"cdn",to:"gateway",volume:"high"}],O={healthy:{dot:"bg-emerald-500",border:"border-emerald-500/40",bg:"bg-emerald-500/10",text:"text-emerald-400"},degraded:{dot:"bg-amber-500",border:"border-amber-500/40",bg:"bg-amber-500/10",text:"text-amber-400"},offline:{dot:"bg-rose-500",border:"border-rose-500/40",bg:"bg-rose-500/10",text:"text-rose-400"}},C={low:"h-px",medium:"h-0.5",high:"h-1"},v={low:"bg-zinc-700",medium:"bg-indigo-500/60",high:"bg-indigo-400"},R=200,z=80,M=["all","healthy","degraded","offline"];function A(s){return s>=1e3?`${(s/1e3).toFixed(1)}k`:String(s)}function S({node:s,selected:u,onSelect:c}){const a=O[s.status];return e.jsxs("button",{onClick:()=>c(s.id),className:d("absolute flex flex-col gap-1 rounded-lg border px-3 py-2 text-left transition-all","bg-zinc-900 hover:bg-zinc-800/80 focus:outline-none",u?"ring-2 ring-indigo-500 border-indigo-500":d("border-zinc-800",a.border)),style:{width:R,height:z,left:s.x,top:s.y},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-base leading-none",children:s.icon}),e.jsx("span",{className:"truncate text-sm font-medium text-white",children:s.name}),e.jsx("span",{className:d("ml-auto h-2 w-2 shrink-0 rounded-full",a.dot)})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-zinc-400",children:[e.jsxs("span",{children:["CPU ",s.cpu,"%"]}),e.jsxs("span",{children:["RAM ",s.ram,"%"]}),e.jsx("span",{className:d("ml-auto capitalize text-xs font-medium",a.text),children:s.status})]})]})}function k({conn:s,nodes:u}){const c=u.find(n=>n.id===s.from),a=u.find(n=>n.id===s.to);if(!c||!a)return null;const l={"us-east-1":{x:20,y:52},"us-west-2":{x:20,y:52}},g=l[c.region],j=l[a.region],x=c.x+g.x+R/2,m=c.y+g.y+z/2,p=a.x+j.x+R/2,h=a.y+j.y+z/2;if(c.region!==a.region)return null;const b=Math.min(x,p),f=Math.min(m,h),t=Math.abs(p-x),r=Math.abs(h-m);return r<20?e.jsx("div",{className:d("absolute rounded-full",C[s.volume],v[s.volume]),style:{left:b,top:m,width:t}}):t<20?e.jsx("div",{className:d("absolute rounded-full",v[s.volume]),style:{left:x,top:f,height:r,width:s.volume==="high"?4:s.volume==="medium"?2:1}}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:d("absolute rounded-full",C[s.volume],v[s.volume]),style:{left:x,top:m,width:p-x}}),e.jsx("div",{className:d("absolute rounded-full",v[s.volume]),style:{left:p,top:Math.min(m,h),height:Math.abs(h-m),width:s.volume==="high"?4:s.volume==="medium"?2:1}})]})}function E({node:s,onClose:u}){const c=O[s.status];return e.jsxs("div",{className:"flex w-80 shrink-0 flex-col border-l border-zinc-800 bg-zinc-900",children:[e.jsxs("div",{className:"flex items-center gap-3 border-b border-zinc-800 px-5 py-4",children:[e.jsx("span",{className:"text-2xl",children:s.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-sm font-semibold text-white",children:s.name}),e.jsx("span",{className:d("text-xs font-medium capitalize",c.text),children:s.status})]}),e.jsx("button",{onClick:u,className:"rounded p-1 text-zinc-500 hover:bg-zinc-800 hover:text-white",children:"âœ•"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 p-5",children:[["Uptime",s.uptime],["CPU",`${s.cpu}%`],["RAM",`${s.ram}%`],["Req / s",A(s.requestRate)],["Error %",`${s.errorRate}%`],["Region",s.region]].map(([a,l])=>e.jsxs("div",{className:"rounded-lg border border-zinc-800 bg-zinc-950 px-3 py-2",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wider text-zinc-500",children:a}),e.jsx("p",{className:"mt-0.5 text-sm font-semibold text-white",children:l})]},a))}),e.jsx("div",{className:"space-y-3 px-5",children:["cpu","ram"].map(a=>{const l=s[a],g=l>85?"bg-rose-500":l>60?"bg-amber-500":"bg-emerald-500";return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-1 flex justify-between text-xs text-zinc-400",children:[e.jsx("span",{className:"uppercase",children:a}),e.jsxs("span",{children:[l,"%"]})]}),e.jsx("div",{className:"h-1.5 w-full rounded-full bg-zinc-800",children:e.jsx("div",{className:d("h-full rounded-full transition-all",g),style:{width:`${l}%`}})})]},a)})}),e.jsxs("div",{className:"mt-4 flex-1 overflow-y-auto px-5 pb-5",children:[e.jsx("h3",{className:"mb-2 text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Recent Events"}),e.jsx("ul",{className:"space-y-2",children:s.events.map((a,l)=>e.jsxs("li",{className:"flex items-start gap-2 text-xs text-zinc-300",children:[e.jsx("span",{className:"mt-1 h-1 w-1 shrink-0 rounded-full bg-indigo-500"}),a]},l))})]})]})}function D(){const[s,u]=N.useState("all"),[c,a]=N.useState(null),[l,g]=N.useState(!1),[j,x]=N.useState(0);q.useEffect(()=>{if(!l)return;x(0);const t=setInterval(()=>x(r=>r+1),1e3);return()=>clearInterval(t)},[l]);const m=s==="all"?o:o.filter(t=>t.status===s),p=o.find(t=>t.id===c)??null,h=m.filter(t=>t.region==="us-east-1"),b=m.filter(t=>t.region==="us-west-2"),f=t=>o.filter(r=>r.status===t).length;return e.jsxs("div",{className:"flex h-full min-h-screen flex-col bg-zinc-950 text-white",children:[e.jsxs("header",{className:"flex items-center justify-between border-b border-zinc-800 px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold tracking-tight",children:"Infrastructure Map"}),e.jsxs("p",{className:"text-xs text-zinc-500",children:["Real-time topology Â· ",o.length," nodes"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>g(t=>!t),className:d("flex items-center gap-2 rounded-lg border px-3 py-1.5 text-xs font-medium transition",l?"border-indigo-500/50 bg-indigo-500/10 text-indigo-400":"border-zinc-700 bg-zinc-900 text-zinc-400 hover:text-white"),children:[e.jsx("span",{className:d("h-1.5 w-1.5 rounded-full",l?"bg-indigo-500 animate-pulse":"bg-zinc-600")}),l?`Auto-refresh Â· ${j}s ago`:"Auto-refresh off"]}),e.jsxs("div",{className:"hidden items-center gap-2 sm:flex",children:[e.jsxs("span",{className:"flex items-center gap-1 rounded bg-emerald-500/10 px-2 py-0.5 text-[10px] font-semibold text-emerald-400",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500"})," ",f("healthy")]}),e.jsxs("span",{className:"flex items-center gap-1 rounded bg-amber-500/10 px-2 py-0.5 text-[10px] font-semibold text-amber-400",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-amber-500"})," ",f("degraded")]}),e.jsxs("span",{className:"flex items-center gap-1 rounded bg-rose-500/10 px-2 py-0.5 text-[10px] font-semibold text-rose-400",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-rose-500"})," ",f("offline")]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2 border-b border-zinc-800 px-6 py-3",children:M.map(t=>e.jsx("button",{onClick:()=>u(t),className:d("rounded-full border px-3 py-1 text-xs font-medium capitalize transition",s===t?"border-indigo-500 bg-indigo-500/15 text-indigo-400":"border-zinc-700 text-zinc-400 hover:border-zinc-600 hover:text-white"),children:t==="all"?`All (${o.length})`:`${t} (${f(t)})`},t))}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[h.length>0&&e.jsxs("section",{className:"rounded-xl border border-zinc-800 bg-zinc-950 p-5",children:[e.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-zinc-500",children:"us-east-1"}),e.jsx("span",{className:"h-px flex-1 bg-zinc-800"})]}),e.jsxs("div",{className:"relative",style:{height:260},children:[w.filter(t=>{const r=o.find(i=>i.id===t.from),n=o.find(i=>i.id===t.to);return(r==null?void 0:r.region)==="us-east-1"&&(n==null?void 0:n.region)==="us-east-1"&&m.some(i=>i.id===t.from)&&m.some(i=>i.id===t.to)}).map((t,r)=>e.jsx(k,{conn:t,nodes:h},r)),h.map(t=>e.jsx(S,{node:t,selected:c===t.id,onSelect:a},t.id))]})]}),b.length>0&&e.jsxs("section",{className:"rounded-xl border border-zinc-800 bg-zinc-950 p-5",children:[e.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-zinc-500",children:"us-west-2"}),e.jsx("span",{className:"h-px flex-1 bg-zinc-800"})]}),e.jsxs("div",{className:"relative",style:{height:260},children:[w.filter(t=>{const r=o.find(i=>i.id===t.from),n=o.find(i=>i.id===t.to);return(r==null?void 0:r.region)==="us-west-2"&&(n==null?void 0:n.region)==="us-west-2"&&m.some(i=>i.id===t.from)&&m.some(i=>i.id===t.to)}).map((t,r)=>e.jsx(k,{conn:t,nodes:b},r)),b.map(t=>e.jsx(S,{node:t,selected:c===t.id,onSelect:a},t.id))]})]}),e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-dashed border-zinc-800 px-4 py-2.5",children:[e.jsx("span",{className:"text-xs text-zinc-600",children:"Cross-region links"}),w.filter(t=>{const r=o.find(i=>i.id===t.from),n=o.find(i=>i.id===t.to);return r&&n&&r.region!==n.region}).map((t,r)=>{const n=o.find(y=>y.id===t.from),i=o.find(y=>y.id===t.to);return e.jsxs("span",{className:"flex items-center gap-1.5 text-[10px] text-zinc-500",children:[e.jsx("span",{className:"font-medium text-zinc-300",children:n==null?void 0:n.name}),e.jsx("span",{className:d("inline-block h-px w-4 rounded-full",v[t.volume])}),e.jsx("span",{className:"font-medium text-zinc-300",children:i==null?void 0:i.name})]},r)})]})]})}),p&&e.jsx(E,{node:p,onClose:()=>a(null)})]})]})}export{D as default};
