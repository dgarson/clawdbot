import{r as o,j as e,c as n}from"./index-BvekFnzL.js";const r=[{id:"rule1",name:"High API Error Rate",type:"threshold",severity:"critical",state:"firing",description:"Fires when the 5-minute error rate on any API endpoint exceeds 5% of total requests.",conditions:[{metric:"http_requests_errors_rate5m",operator:"gt",threshold:5,window:"5m",aggregation:"avg"}],actions:[{type:"pagerduty",target:"oncall-eng",message:"API error rate critical: {{value}}%",cooldown:"5m"},{type:"slack",target:"#incidents",message:"ðŸš¨ API error rate {{value}}% (threshold: 5%)",cooldown:"15m"}],labels:{team:"platform",env:"production",service:"api-gateway"},annotations:{runbook:"https://runbooks.co/api-errors",summary:"High API error rate on production"},createdBy:"platform-team@co.com",createdAt:"2025-06-01",lastEvaluated:"2026-02-22 15:58",lastFired:"2026-02-22 14:20",firingCount:18,evaluationInterval:"1m",pendingDuration:"2m",enabled:!0},{id:"rule2",name:"Database Connection Pool Exhaustion",type:"threshold",severity:"high",state:"pending",description:"Fires when database connection pool utilization exceeds 90% for more than 3 minutes.",conditions:[{metric:"db_pool_utilization",operator:"gt",threshold:90,window:"3m",aggregation:"avg"}],actions:[{type:"pagerduty",target:"dba-team",message:"DB connection pool {{value}}% utilized",cooldown:"10m"},{type:"runbook",target:"https://runbooks.co/db-pool",message:"Scale connection pool or investigate slow queries",cooldown:"0"}],labels:{team:"database",env:"production",service:"postgres-primary"},annotations:{runbook:"https://runbooks.co/db-pool",summary:"Possible DB connection exhaustion"},createdBy:"dba@co.com",createdAt:"2025-09-01",lastEvaluated:"2026-02-22 15:58",lastFired:"2026-02-10 09:15",firingCount:4,evaluationInterval:"1m",pendingDuration:"3m",enabled:!0},{id:"rule3",name:"P99 Latency Spike",type:"threshold",severity:"high",state:"ok",description:"Fires when p99 response latency exceeds 2 seconds averaged over the last 10 minutes.",conditions:[{metric:"http_request_duration_p99",operator:"gt",threshold:2e3,window:"10m",aggregation:"p99"}],actions:[{type:"slack",target:"#backend-alerts",message:"P99 latency {{value}}ms exceeded 2s threshold",cooldown:"10m"}],labels:{team:"backend",env:"production"},annotations:{runbook:"https://runbooks.co/latency",summary:"Response time degradation detected"},createdBy:"backend-team@co.com",createdAt:"2025-04-15",lastEvaluated:"2026-02-22 15:58",lastFired:"2026-02-18 16:45",firingCount:7,evaluationInterval:"2m",pendingDuration:"5m",enabled:!0},{id:"rule4",name:"Memory Leak Detection",type:"anomaly",severity:"medium",state:"ok",description:"Detects sustained upward memory trend over 1 hour suggesting potential memory leak.",conditions:[{metric:"process_memory_bytes",operator:"gt",threshold:0,window:"1h",aggregation:"avg"}],actions:[{type:"slack",target:"#infra-alerts",message:"Memory growth trend detected on {{instance}}",cooldown:"1h"}],labels:{team:"infra",env:"production"},annotations:{runbook:"https://runbooks.co/memory-leak",summary:"Possible memory leak"},createdBy:"infra@co.com",createdAt:"2025-11-01",lastEvaluated:"2026-02-22 15:55",lastFired:"2026-02-14 04:00",firingCount:2,evaluationInterval:"5m",pendingDuration:"10m",enabled:!0},{id:"rule5",name:"Service Heartbeat Missing",type:"absence",severity:"critical",state:"ok",description:"Fires when any service stops sending heartbeat metrics for more than 2 minutes.",conditions:[{metric:"service_heartbeat",operator:"eq",threshold:0,window:"2m",aggregation:"sum"}],actions:[{type:"pagerduty",target:"oncall-eng",message:"Service {{service}} heartbeat missing for 2+ minutes",cooldown:"2m"}],labels:{team:"platform",env:"production"},annotations:{runbook:"https://runbooks.co/service-down",summary:"Service may be down"},createdBy:"platform@co.com",createdAt:"2025-01-01",lastEvaluated:"2026-02-22 15:58",lastFired:"2026-02-05 09:14",firingCount:3,evaluationInterval:"30s",pendingDuration:"2m",enabled:!0},{id:"rule6",name:"Disk Usage Warning",type:"threshold",severity:"medium",state:"firing",description:"Fires when disk usage on any monitored volume exceeds 80%.",conditions:[{metric:"disk_usage_percent",operator:"gt",threshold:80,window:"5m",aggregation:"max"}],actions:[{type:"slack",target:"#infra-alerts",message:"Disk usage on {{volume}} is {{value}}%",cooldown:"1h"}],labels:{team:"infra",env:"production"},annotations:{runbook:"https://runbooks.co/disk",summary:"Disk space running low"},createdBy:"infra@co.com",createdAt:"2025-03-01",lastEvaluated:"2026-02-22 15:58",lastFired:"2026-02-22 10:00",firingCount:12,evaluationInterval:"5m",pendingDuration:"5m",enabled:!0},{id:"rule7",name:"Queue Depth Alert",type:"threshold",severity:"high",state:"disabled",description:"Fires when message queue depth exceeds 10,000 unprocessed messages.",conditions:[{metric:"rabbitmq_queue_messages",operator:"gt",threshold:1e4,window:"5m",aggregation:"max"}],actions:[{type:"slack",target:"#platform-alerts",message:"Queue depth {{value}} exceeds 10k",cooldown:"30m"}],labels:{team:"platform"},annotations:{runbook:"https://runbooks.co/queue",summary:"Message queue backup detected"},createdBy:"platform@co.com",createdAt:"2026-01-15",lastEvaluated:"N/A",lastFired:null,firingCount:0,evaluationInterval:"1m",pendingDuration:"5m",enabled:!1}],b=[{id:"a1",ruleId:"rule1",ruleName:"High API Error Rate",severity:"critical",startedAt:"2026-02-22 14:20",duration:"1h 38m",value:7.4,threshold:5,labels:{endpoint:"/api/v2/orders",region:"us-east-1"},status:"firing",resolvedAt:null},{id:"a2",ruleId:"rule6",ruleName:"Disk Usage Warning",severity:"medium",startedAt:"2026-02-22 10:00",duration:"5h 58m",value:83.2,threshold:80,labels:{volume:"/dev/nvme0n1p1",host:"worker-12"},status:"firing",resolvedAt:null},{id:"a3",ruleId:"rule3",ruleName:"P99 Latency Spike",severity:"high",startedAt:"2026-02-18 16:45",duration:"22m",value:2840,threshold:2e3,labels:{service:"order-svc"},status:"resolved",resolvedAt:"2026-02-18 17:07"},{id:"a4",ruleId:"rule1",ruleName:"High API Error Rate",severity:"critical",startedAt:"2026-02-15 09:30",duration:"45m",value:12.1,threshold:5,labels:{endpoint:"/api/v1/payments"},status:"resolved",resolvedAt:"2026-02-15 10:15"}],v=[{time:"14:00",value:2.1,threshold:5,state:"ok"},{time:"14:10",value:3.8,threshold:5,state:"ok"},{time:"14:20",value:6.2,threshold:5,state:"firing"},{time:"14:30",value:7.9,threshold:5,state:"firing"},{time:"14:40",value:8.4,threshold:5,state:"firing"},{time:"14:50",value:7.1,threshold:5,state:"firing"},{time:"15:00",value:6.8,threshold:5,state:"firing"},{time:"15:10",value:7.4,threshold:5,state:"firing"}];function R(s){return s==="firing"?"text-rose-400":s==="ok"?"text-emerald-400":s==="pending"?"text-amber-400":s==="error"?"text-rose-400":"text-zinc-400"}function f(s){return s==="firing"?"bg-rose-400/10 text-rose-400":s==="ok"?"bg-emerald-400/10 text-emerald-400":s==="pending"?"bg-amber-400/10 text-amber-400":s==="error"?"bg-rose-400/10 text-rose-400":"bg-zinc-600 text-zinc-400"}function c(s){return s==="critical"?"bg-rose-500/10 text-rose-400":s==="high"?"bg-orange-500/10 text-orange-400":s==="medium"?"bg-amber-500/10 text-amber-400":s==="low"?"bg-blue-500/10 text-blue-400":"bg-zinc-500/10 text-zinc-400"}function j(s){return{threshold:"bg-indigo-500/10 text-indigo-400",anomaly:"bg-purple-500/10 text-purple-400",trend:"bg-blue-500/10 text-blue-400",composite:"bg-orange-500/10 text-orange-400",absence:"bg-zinc-500/10 text-zinc-400"}[s]}function y(s){return{alert:"ðŸ””",pagerduty:"ðŸ“Ÿ",slack:"ðŸ’¬",webhook:"ðŸª","auto-scale":"âš–ï¸",runbook:"ðŸ“–"}[s]}function S(s){return{gt:">",lt:"<",gte:"â‰¥",lte:"â‰¤",eq:"=",ne:"â‰ "}[s]}function P(){const[s,d]=o.useState("rules"),[i,m]=o.useState(null),[x,N]=o.useState("all"),[u,z]=o.useState("all"),[h,w]=o.useState("all"),k=r.filter(t=>!(x!=="all"&&t.state!==x||u!=="all"&&t.severity!==u||h!=="all"&&t.type!==h)),A=r.filter(t=>t.state==="firing").length,C=r.filter(t=>t.state==="pending").length,E=r.filter(t=>t.state==="ok").length,g=b.filter(t=>t.status==="firing").length,F=Math.max(...v.map(t=>t.value)),I=[{id:"rules",label:`Rules (${r.length})`},{id:"alerts",label:`Alerts (${g} firing)`},{id:"history",label:"Eval History"},{id:"stats",label:"Statistics"}];return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Observability Rules Engine"}),e.jsx("p",{className:"text-zinc-400 text-sm mt-1",children:"Define, manage, and monitor alerting rules across your infrastructure"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 text-sm bg-zinc-800 hover:bg-zinc-700 rounded-lg text-zinc-300 transition-colors",children:"Import Rules"}),e.jsx("button",{className:"px-3 py-1.5 text-sm bg-indigo-600 hover:bg-indigo-500 rounded-lg text-white transition-colors",children:"+ New Rule"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 border border-rose-500/30",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Firing"}),e.jsx("div",{className:"text-2xl font-bold text-rose-400",children:A})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 border border-amber-500/20",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Pending"}),e.jsx("div",{className:"text-2xl font-bold text-amber-400",children:C})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 border border-zinc-800",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"OK"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-400",children:E})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 border border-zinc-800",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Active Alerts"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:g})]})]}),e.jsx("div",{className:"flex gap-1 border-b border-zinc-800 mb-6",children:I.map(t=>e.jsx("button",{onClick:()=>{d(t.id),m(null)},className:n("px-4 py-2 text-sm font-medium transition-colors border-b-2 -mb-px",s===t.id?"border-indigo-500 text-white":"border-transparent text-zinc-400 hover:text-zinc-200"),children:t.label},t.id))}),s==="rules"&&!i&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsxs("select",{value:x,onChange:t=>N(t.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-1.5 text-sm text-zinc-200",children:[e.jsx("option",{value:"all",children:"All States"}),e.jsx("option",{value:"firing",children:"Firing"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"ok",children:"OK"}),e.jsx("option",{value:"disabled",children:"Disabled"})]}),e.jsxs("select",{value:u,onChange:t=>z(t.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-1.5 text-sm text-zinc-200",children:[e.jsx("option",{value:"all",children:"All Severity"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("select",{value:h,onChange:t=>w(t.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-1.5 text-sm text-zinc-200",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"threshold",children:"Threshold"}),e.jsx("option",{value:"anomaly",children:"Anomaly"}),e.jsx("option",{value:"trend",children:"Trend"}),e.jsx("option",{value:"absence",children:"Absence"}),e.jsx("option",{value:"composite",children:"Composite"})]})]}),e.jsx("div",{className:"space-y-2",children:k.map(t=>e.jsx("div",{onClick:()=>m(t),className:n("bg-zinc-900 rounded-xl p-4 border hover:border-zinc-600 cursor-pointer transition-colors",t.state==="firing"?"border-rose-500/30":t.state==="pending"?"border-amber-500/20":"border-zinc-800"),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("div",{className:n("w-2 h-2 rounded-full",t.state==="firing"?"bg-rose-400 animate-pulse":t.state==="pending"?"bg-amber-400":t.state==="ok"?"bg-emerald-400":"bg-zinc-500")}),e.jsx("span",{className:"font-medium text-zinc-200",children:t.name}),e.jsx("span",{className:n("text-xs px-2 py-0.5 rounded-full capitalize",f(t.state)),children:t.state}),e.jsx("span",{className:n("text-xs px-2 py-0.5 rounded-full capitalize",c(t.severity)),children:t.severity}),e.jsx("span",{className:n("text-xs px-2 py-0.5 rounded-full capitalize",j(t.type)),children:t.type})]}),e.jsx("div",{className:"text-xs text-zinc-400",children:t.description}),e.jsxs("div",{className:"flex gap-3 mt-2 text-xs text-zinc-500",children:[e.jsxs("span",{children:["Every ",t.evaluationInterval]}),e.jsxs("span",{children:["Pending: ",t.pendingDuration]}),e.jsxs("span",{children:["Fired: ",t.firingCount,"x"]}),t.lastFired&&e.jsxs("span",{children:["Last: ",t.lastFired]})]})]}),e.jsx("div",{className:"flex gap-1 ml-3",children:t.actions.map((a,l)=>e.jsx("span",{title:a.type,className:"text-base",children:y(a.type)},l))})]})},t.id))})]}),s==="rules"&&i&&e.jsxs("div",{children:[e.jsx("button",{onClick:()=>m(null),className:"flex items-center gap-1 text-sm text-zinc-400 hover:text-zinc-200 mb-4 transition-colors",children:"â† Back"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-5 mb-5",children:[e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:i.name}),e.jsx("span",{className:n("text-xs px-2 py-0.5 rounded-full",f(i.state)),children:i.state}),e.jsx("span",{className:n("text-xs px-2 py-0.5 rounded-full capitalize",c(i.severity)),children:i.severity})]}),e.jsx("span",{className:n("text-xs px-2 py-0.5 rounded-full capitalize",j(i.type)),children:i.type})]}),e.jsx("button",{className:n("px-3 py-1.5 text-xs rounded-lg transition-colors",i.enabled?"bg-rose-600 hover:bg-rose-500 text-white":"bg-emerald-600 hover:bg-emerald-500 text-white"),children:i.enabled?"Disable":"Enable"})]}),e.jsx("p",{className:"text-sm text-zinc-300 mb-4",children:i.description}),e.jsx("div",{className:"space-y-2 text-xs",children:[{label:"Interval",value:i.evaluationInterval},{label:"Pending for",value:i.pendingDuration},{label:"Fired count",value:i.firingCount.toString()},{label:"Last fired",value:i.lastFired??"Never"},{label:"Last evaluated",value:i.lastEvaluated},{label:"Created by",value:i.createdBy}].map(t=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-zinc-500",children:t.label}),e.jsx("span",{className:"text-zinc-300",children:t.value})]},t.label))}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-2",children:"Labels"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(i.labels).map(([t,a])=>e.jsxs("span",{className:"text-xs px-2 py-0.5 rounded bg-zinc-700 text-zinc-300",children:[t,"=",a]},t))})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800",children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-300 mb-3",children:"Conditions"}),i.conditions.map((t,a)=>e.jsxs("div",{className:"p-3 bg-zinc-800 rounded-lg font-mono text-sm",children:[e.jsx("span",{className:"text-indigo-400",children:t.aggregation}),e.jsxs("span",{className:"text-zinc-300",children:["(",t.metric,")"]}),e.jsxs("span",{className:"text-zinc-200",children:["[",t.window,"] "]}),e.jsxs("span",{className:"text-amber-400",children:[S(t.operator)," "]}),e.jsx("span",{className:"text-emerald-400",children:t.threshold})]},a))]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800",children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-300 mb-3",children:"Actions"}),e.jsx("div",{className:"space-y-2",children:i.actions.map((t,a)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-zinc-800 rounded-lg",children:[e.jsx("span",{className:"text-base",children:y(t.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-zinc-300 capitalize",children:t.type}),e.jsxs("span",{className:"text-xs text-zinc-500",children:["â†’ ",t.target]}),t.cooldown!=="0"&&e.jsxs("span",{className:"text-xs text-zinc-600",children:["cooldown: ",t.cooldown]})]}),e.jsx("div",{className:"text-xs text-zinc-400 mt-1 font-mono",children:t.message})]})]},a))})]})]})]})]}),s==="alerts"&&e.jsx("div",{className:"space-y-3",children:b.map(t=>e.jsxs("div",{className:n("bg-zinc-900 rounded-xl p-4 border",t.status==="firing"?"border-rose-500/30":"border-zinc-800"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-zinc-200",children:t.ruleName}),e.jsx("span",{className:n("text-xs px-2 py-0.5 rounded-full capitalize",c(t.severity)),children:t.severity}),e.jsx("span",{className:n("text-xs px-2 py-0.5 rounded-full capitalize",t.status==="firing"?"bg-rose-400/10 text-rose-400":"bg-emerald-400/10 text-emerald-400"),children:t.status})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:Object.entries(t.labels).map(([a,l])=>e.jsxs("span",{className:"text-xs px-1.5 py-0.5 rounded bg-zinc-700 text-zinc-400",children:[a,"=",l]},a))})]}),e.jsxs("div",{className:"text-right text-xs text-zinc-500",children:[e.jsxs("div",{children:["Started: ",t.startedAt]}),e.jsxs("div",{children:["Duration: ",t.duration]}),t.resolvedAt&&e.jsxs("div",{className:"text-emerald-400",children:["Resolved: ",t.resolvedAt]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-zinc-800 flex gap-6 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-zinc-500",children:"Value: "}),e.jsx("span",{className:n("font-bold",t.status==="firing"?"text-rose-400":"text-zinc-300"),children:t.value})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-zinc-500",children:"Threshold: "}),e.jsx("span",{className:"text-zinc-400",children:t.threshold})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-zinc-500",children:"Excess: "}),e.jsxs("span",{className:"text-rose-400",children:["+",(t.value-t.threshold).toFixed(1)]})]})]})]},t.id))}),s==="history"&&e.jsx("div",{className:"space-y-5",children:e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800",children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-300 mb-1",children:'Rule: "High API Error Rate" â€” Recent Evaluations'}),e.jsx("p",{className:"text-xs text-zinc-500 mb-4",children:"HTTP error rate (%) vs 5% threshold"}),e.jsx("div",{className:"flex items-end gap-2",style:{height:100},children:v.map(t=>{const a=t.value/(F*1.1)*100;return e.jsxs("div",{className:"flex flex-col items-center gap-1 flex-1",children:[e.jsx("div",{className:"w-full flex items-end",style:{height:80},children:e.jsx("div",{className:n("w-full rounded-t",t.state==="firing"?"bg-rose-500":"bg-emerald-500"),style:{height:`${a}%`,minHeight:4},title:`${t.value}% at ${t.time}`})}),e.jsx("span",{className:"text-[10px] text-zinc-500",children:t.time})]},t.time)})}),e.jsxs("div",{className:"flex gap-4 mt-3 text-xs text-zinc-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-sm bg-rose-500 inline-block"}),"Firing"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-sm bg-emerald-500 inline-block"}),"OK"]}),e.jsx("span",{className:"ml-auto",children:"Threshold: 5%"})]})]})}),s==="stats"&&e.jsxs("div",{className:"space-y-5",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[{label:"Total Rules",value:r.length,color:"text-white"},{label:"Enabled Rules",value:r.filter(t=>t.enabled).length,color:"text-emerald-400"},{label:"Total Fire Events",value:r.reduce((t,a)=>t+a.firingCount,0),color:"text-rose-400"}].map(t=>e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 border border-zinc-800 text-center",children:[e.jsx("div",{className:n("text-3xl font-bold mb-1",t.color),children:t.value}),e.jsx("div",{className:"text-xs text-zinc-500",children:t.label})]},t.label))}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800",children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-300 mb-4",children:"Rules by Severity"}),e.jsx("div",{className:"space-y-3",children:["critical","high","medium","low","info"].map(t=>{const a=r.filter(p=>p.severity===t).length,l=a/r.length*100;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"capitalize text-zinc-400",children:t}),e.jsxs("span",{className:c(t).split(" ")[1],children:[a," rules"]})]}),e.jsx("div",{className:"h-2 bg-zinc-700 rounded-full overflow-hidden",children:e.jsx("div",{className:n("h-full rounded-full",t==="critical"?"bg-rose-500":t==="high"?"bg-orange-500":t==="medium"?"bg-amber-500":t==="low"?"bg-blue-500":"bg-zinc-500"),style:{width:`${l}%`}})})]},t)})})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-5 border border-zinc-800",children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-300 mb-4",children:"Most Active Rules"}),e.jsx("div",{className:"space-y-3",children:[...r].sort((t,a)=>a.firingCount-t.firingCount).slice(0,5).map(t=>{const a=Math.max(...r.map(p=>p.firingCount),1),l=t.firingCount/a*100;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-zinc-300",children:t.name}),e.jsxs("span",{className:R(t.state),children:[t.firingCount," fires"]})]}),e.jsx("div",{className:"h-2 bg-zinc-700 rounded-full overflow-hidden",children:e.jsx("div",{className:n("h-full rounded-full",t.state==="firing"?"bg-rose-500":"bg-indigo-500"),style:{width:`${l}%`}})})]},t.id)})})]})]})]})}export{P as default};
