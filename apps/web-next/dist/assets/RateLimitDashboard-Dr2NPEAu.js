import{r as n,j as e,c as a}from"./index-BuITcl8D.js";const o=[{id:"gl-req",name:"Global Requests",scope:"global",scopeId:"system",status:"ok",limit:1e4,used:3847,unit:"requests",window:"1h",resetAt:"2026-02-22T02:00:00Z",description:"Total API requests across all agents per hour",throttleThreshold:80},{id:"gl-tok",name:"Global Tokens",scope:"global",scopeId:"system",status:"warning",limit:5e6,used:4312e3,unit:"tokens",window:"1h",resetAt:"2026-02-22T02:00:00Z",description:"Total tokens consumed across all models per hour",throttleThreshold:80},{id:"mdl-sonnet",name:"Claude Sonnet 4.6",scope:"model",scopeId:"claude-sonnet-4-6",status:"warning",limit:2e6,used:178e4,unit:"tokens",window:"1h",resetAt:"2026-02-22T02:00:00Z",description:"Token budget for Claude Sonnet 4.6",throttleThreshold:80},{id:"mdl-opus",name:"Claude Opus 4.6",scope:"model",scopeId:"claude-opus-4-6",status:"ok",limit:5e5,used:87e3,unit:"tokens",window:"1h",resetAt:"2026-02-22T02:00:00Z",description:"Token budget for Claude Opus 4.6",throttleThreshold:80},{id:"mdl-flash",name:"Gemini 3 Flash",scope:"model",scopeId:"gemini-3-flash",status:"throttled",limit:3e6,used:3e6,unit:"tokens",window:"1h",resetAt:"2026-02-22T02:00:00Z",description:"Token budget for Gemini 3 Flash (provider limit reached)",throttleThreshold:80},{id:"mdl-gpt4o",name:"GPT-4o",scope:"model",scopeId:"gpt-4o",status:"ok",limit:1e6,used:234e3,unit:"tokens",window:"1h",resetAt:"2026-02-22T02:00:00Z",description:"Token budget for GPT-4o",throttleThreshold:80},{id:"ag-luis",name:"Luis (UX Lead)",scope:"agent",scopeId:"luis",status:"ok",limit:500,used:89,unit:"requests",window:"1h",resetAt:"2026-02-22T02:00:00Z",description:"Request quota for agent: Luis",throttleThreshold:75},{id:"ag-xavier",name:"Xavier (CTO)",scope:"agent",scopeId:"xavier",status:"ok",limit:500,used:31,unit:"requests",window:"1h",resetAt:"2026-02-22T02:00:00Z",description:"Request quota for agent: Xavier",throttleThreshold:75},{id:"ag-stephan",name:"Stephan (CMO)",scope:"agent",scopeId:"stephan",status:"ok",limit:300,used:12,unit:"requests",window:"1h",resetAt:"2026-02-22T02:00:00Z",description:"Request quota for agent: Stephan",throttleThreshold:75},{id:"ag-piper",name:"Piper (UI)",scope:"agent",scopeId:"piper",status:"warning",limit:300,used:254,unit:"requests",window:"1h",resetAt:"2026-02-22T02:00:00Z",description:"Request quota for agent: Piper",throttleThreshold:75},{id:"ag-wes",name:"Wes (Performance)",scope:"agent",scopeId:"wes",status:"ok",limit:300,used:78,unit:"requests",window:"1h",resetAt:"2026-02-22T02:00:00Z",description:"Request quota for agent: Wes",throttleThreshold:75},{id:"sess-max",name:"Concurrent Sessions",scope:"user",scopeId:"david",status:"ok",limit:20,used:7,unit:"sessions",window:"1m",resetAt:"2026-02-22T01:21:00Z",description:"Max concurrent agent sessions for workspace owner",throttleThreshold:70}],x=[{id:"te-1",timestamp:"2026-02-22T00:47:12Z",limitId:"mdl-flash",limitName:"Gemini 3 Flash",scope:"model",scopeId:"gemini-3-flash",used:3e6,limit:3e6,duration:45e3,reason:"Provider token limit reached â€” hourly cap exhausted"},{id:"te-2",timestamp:"2026-02-22T00:31:05Z",limitId:"ag-piper",limitName:"Piper (UI)",scope:"agent",scopeId:"piper",used:287,limit:300,duration:2e3,reason:"Agent request quota at 96% â€” brief backoff applied"},{id:"te-3",timestamp:"2026-02-22T00:15:33Z",limitId:"gl-tok",limitName:"Global Tokens",scope:"global",scopeId:"system",used:48e5,limit:5e6,duration:1e4,reason:"Global hourly token budget over 96% â€” throttling burst traffic"},{id:"te-4",timestamp:"2026-02-21T23:58:44Z",limitId:"mdl-flash",limitName:"Gemini 3 Flash",scope:"model",scopeId:"gemini-3-flash",used:3e6,limit:3e6,duration:36e5,reason:"Hourly token limit hit â€” all requests queued until reset"},{id:"te-5",timestamp:"2026-02-21T23:22:17Z",limitId:"ag-piper",limitName:"Piper (UI)",scope:"agent",scopeId:"piper",used:299,limit:300,duration:1500,reason:"Agent at limit â€” request delayed"},{id:"te-6",timestamp:"2026-02-21T22:11:08Z",limitId:"mdl-sonnet",limitName:"Claude Sonnet 4.6",scope:"model",scopeId:"claude-sonnet-4-6",used:2e6,limit:2e6,duration:8e3,reason:"Model token limit hit â€” switching to fallback model"}],w={ok:"OK",warning:"Warning",throttled:"Throttled",blocked:"Blocked"},N={ok:"text-emerald-400 bg-emerald-400/10 border-emerald-400/20",warning:"text-amber-400 bg-amber-400/10 border-amber-400/20",throttled:"text-rose-400 bg-rose-400/10 border-rose-400/20",blocked:"text-red-400 bg-red-400/10 border-red-400/20"},v={ok:"bg-emerald-400",warning:"bg-amber-400",throttled:"bg-rose-400",blocked:"bg-red-400"},p={agent:"Agent",model:"Model",user:"User",global:"Global"},T={"1m":"per minute","5m":"per 5 min","1h":"per hour","24h":"per day"};function h(s,l){return Math.min(100,Math.round(s/l*100))}function c(s){return s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(0)}K`:String(s)}function k(s){return s>=36e5?`${(s/36e5).toFixed(0)}h`:s>=6e4?`${(s/6e4).toFixed(0)}m`:s>=1e3?`${(s/1e3).toFixed(0)}s`:`${s}ms`}function z(s){return s>=100?"bg-rose-500":s>=80?"bg-amber-400":"bg-emerald-400"}function y(s){const l=Date.now()-new Date(s).getTime(),i=Math.floor(l/6e4);if(i<1)return"just now";if(i<60)return`${i}m ago`;const r=Math.floor(i/60);return r<24?`${r}h ago`:`${Math.floor(r/24)}d ago`}function I({used:s,limit:l,threshold:i}){const r=h(s,l);return e.jsxs("div",{className:"relative h-2 w-full rounded-full bg-zinc-800 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 bottom-0 w-px bg-zinc-600 z-10",style:{left:`${i}%`},"aria-hidden":"true"}),e.jsx("div",{className:a("h-full rounded-full transition-all",z(r)),style:{width:`${r}%`},role:"presentation"})]})}function S({limit:s}){const l=h(s.used,s.limit);return e.jsxs("div",{className:a("rounded-xl border bg-zinc-900 p-4",s.status==="throttled"||s.status==="blocked"?"border-rose-500/30":s.status==="warning"?"border-amber-400/30":"border-zinc-800"),role:"article","aria-label":`${s.name} rate limit`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-white truncate",children:s.name}),e.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:s.description})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1.5 shrink-0",children:[e.jsxs("span",{className:a("inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded-full border",N[s.status]),children:[e.jsx("span",{className:a("w-1.5 h-1.5 rounded-full",v[s.status]),"aria-hidden":"true"}),w[s.status]]}),e.jsx("span",{className:"text-[10px] text-zinc-600 uppercase tracking-wide",children:p[s.scope]})]})]}),e.jsx(I,{used:s.used,limit:s.limit,threshold:s.throttleThreshold}),e.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs",children:[e.jsxs("span",{className:"text-zinc-400",children:[e.jsx("span",{className:"font-mono font-semibold text-white",children:c(s.used)})," / ",e.jsx("span",{className:"font-mono text-zinc-500",children:c(s.limit)})," ",e.jsx("span",{className:"text-zinc-600",children:s.unit})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:a("font-mono font-bold",l>=100?"text-rose-400":l>=80?"text-amber-400":"text-zinc-300"),children:[l,"%"]}),e.jsx("span",{className:"text-zinc-600",children:T[s.window]})]})]}),e.jsxs("div",{className:"mt-2 text-[10px] text-zinc-600",children:["Resets at ",new Date(s.resetAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})}function q(){const[s,l]=n.useState("limits"),[i,r]=n.useState("all"),[d,b]=n.useState("all"),m=n.useMemo(()=>o.filter(t=>!(i!=="all"&&t.scope!==i||d!=="all"&&t.status!==d)),[i,d]),u=n.useMemo(()=>({ok:o.filter(t=>t.status==="ok").length,warning:o.filter(t=>t.status==="warning").length,throttled:o.filter(t=>t.status==="throttled").length,blocked:o.filter(t=>t.status==="blocked").length}),[]),g=[{id:"limits",label:"Active Limits",emoji:"âš¡"},{id:"history",label:"Throttle History",emoji:"ðŸ“‹"}],f=[{value:"all",label:"All Scopes"},{value:"global",label:"Global"},{value:"model",label:"Model"},{value:"agent",label:"Agent"},{value:"user",label:"User"}],j=[{value:"all",label:"All"},{value:"ok",label:"OK"},{value:"warning",label:"Warning"},{value:"throttled",label:"Throttled"}];return n.useCallback(t=>{console.log("Reset limit:",t)},[]),e.jsxs("main",{className:"flex flex-col h-full bg-zinc-950 text-white overflow-hidden",role:"main","aria-label":"Rate Limit Dashboard",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-zinc-800 shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-white",children:"Rate Limits"}),e.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:"Monitor and manage request quotas across agents, models, and system"})]}),e.jsx("div",{className:"flex items-center gap-4 text-xs",children:[{label:"OK",count:u.ok,color:"text-emerald-400"},{label:"Warning",count:u.warning,color:"text-amber-400"},{label:"Throttled",count:u.throttled,color:"text-rose-400"}].map(t=>e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:a("text-xl font-bold font-mono",t.color),children:t.count}),e.jsx("p",{className:"text-zinc-500",children:t.label})]},t.label))})]}),e.jsx("div",{className:"flex gap-1 mt-4",role:"tablist","aria-label":"Rate limit views",children:g.map(t=>e.jsxs("button",{role:"tab","aria-selected":s===t.id,"aria-controls":`tabpanel-${t.id}`,onClick:()=>l(t.id),className:a("px-4 py-1.5 rounded-lg text-sm transition-colors","focus-visible:ring-2 focus-visible:ring-indigo-500 focus-visible:outline-none",s===t.id?"bg-zinc-800 text-white":"text-zinc-400 hover:text-white"),children:[t.emoji," ",t.label]},t.id))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",role:"tabpanel",id:`tabpanel-${s}`,children:[s==="limits"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-5",children:[e.jsx("div",{className:"flex items-center gap-1.5",role:"group","aria-label":"Filter by scope",children:f.map(t=>e.jsx("button",{onClick:()=>r(t.value),"aria-pressed":i===t.value,className:a("text-xs px-3 py-1.5 rounded-lg border transition-colors","focus-visible:ring-2 focus-visible:ring-indigo-500 focus-visible:outline-none",i===t.value?"border-indigo-500 bg-indigo-950/40 text-indigo-300":"border-zinc-700 text-zinc-400 hover:text-white"),children:t.label},t.value))}),e.jsx("div",{className:"w-px h-4 bg-zinc-700","aria-hidden":"true"}),e.jsx("div",{className:"flex items-center gap-1.5",role:"group","aria-label":"Filter by status",children:j.map(t=>e.jsx("button",{onClick:()=>b(t.value),"aria-pressed":d===t.value,className:a("text-xs px-3 py-1.5 rounded-lg border transition-colors","focus-visible:ring-2 focus-visible:ring-indigo-500 focus-visible:outline-none",d===t.value?"border-indigo-500 bg-indigo-950/40 text-indigo-300":"border-zinc-700 text-zinc-400 hover:text-white"),children:t.label},t.value))}),e.jsxs("span",{className:"text-xs text-zinc-600 ml-auto",children:["Showing ",m.length," of ",o.length," limits"]})]}),m.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 text-center",children:[e.jsx("p",{className:"text-3xl mb-3",children:"âœ…"}),e.jsx("p",{className:"text-white font-semibold",children:"No limits match filters"}),e.jsx("p",{className:"text-sm text-zinc-500 mt-1",children:"Try a different scope or status filter"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:m.map(t=>e.jsx(S,{limit:t},t.id))})]}),s==="history"&&e.jsxs("div",{className:"rounded-xl bg-zinc-900 border border-zinc-800 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-zinc-800 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-white",children:"Throttle Events"}),e.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:"Recent rate limit interventions â€” last 24 hours"})]}),e.jsxs("span",{className:"text-xs text-zinc-600",children:[x.length," events"]})]}),e.jsx("div",{className:"divide-y divide-zinc-800",children:x.map(t=>e.jsx("div",{className:"p-4 hover:bg-zinc-800/40 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded-full border text-rose-400 bg-rose-400/10 border-rose-400/20",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-rose-400","aria-hidden":"true"}),"Throttled"]}),e.jsxs("span",{className:"text-xs text-zinc-500 capitalize",children:[p[t.scope]," Â· ",t.scopeId]})]}),e.jsx("p",{className:"text-sm font-semibold text-white",children:t.limitName}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:t.reason}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs font-mono",children:[e.jsxs("span",{className:"text-zinc-400",children:[c(t.used)," / ",c(t.limit)," "," ",e.jsxs("span",{className:"text-rose-400 font-semibold",children:["(",h(t.used,t.limit),"%)"]})]}),e.jsxs("span",{className:"text-zinc-600",children:["Duration: ",k(t.duration)]})]})]}),e.jsxs("div",{className:"text-right text-xs text-zinc-500 shrink-0",children:[e.jsx("p",{children:y(t.timestamp)}),e.jsx("p",{className:"text-zinc-600 mt-0.5",children:new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},t.id))})]})]})]})}export{q as default};
