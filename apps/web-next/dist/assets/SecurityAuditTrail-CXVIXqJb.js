import{r as x,j as e,c as n}from"./index-v5gn4Pco.js";const g=[{id:"evt-001",timestamp:"2026-02-22T06:42:11Z",actor:"alice@corp.io",actorType:"user",action:"LOGIN",resource:"/auth/session",ipAddress:"203.0.113.42",outcome:"success",severity:"info",category:"auth",payload:'{"method":"password","mfa":true,"session_id":"s_9xKp2"}'},{id:"evt-002",timestamp:"2026-02-22T06:45:03Z",actor:"bob@corp.io",actorType:"user",action:"LOGIN_FAILED",resource:"/auth/session",ipAddress:"198.51.100.77",outcome:"failure",severity:"high",category:"auth",payload:'{"method":"password","attempts":5,"reason":"invalid_credentials"}'},{id:"evt-003",timestamp:"2026-02-22T06:50:22Z",actor:"api-gateway",actorType:"service",action:"EXPORT_RECORDS",resource:"/api/v2/users/export",ipAddress:"10.0.1.5",outcome:"success",severity:"medium",category:"data-access",payload:'{"record_count":12450,"format":"csv","requester":"analytics-job"}'},{id:"evt-004",timestamp:"2026-02-22T07:01:55Z",actor:"charlie@corp.io",actorType:"user",action:"ROLE_ASSIGNED",resource:"/admin/roles/superadmin",ipAddress:"192.168.1.22",outcome:"success",severity:"critical",category:"admin",payload:'{"target_user":"dave@corp.io","role":"superadmin","granted_by":"charlie@corp.io"}'},{id:"evt-005",timestamp:"2026-02-22T07:05:33Z",actor:"dave@corp.io",actorType:"user",action:"CONFIG_UPDATE",resource:"/config/security/mfa-policy",ipAddress:"192.168.1.30",outcome:"success",severity:"high",category:"config-change",payload:'{"field":"mfa_required","old_value":true,"new_value":false,"reason":"test"}'},{id:"evt-006",timestamp:"2026-02-22T07:10:01Z",actor:"data-pipeline",actorType:"service",action:"BULK_READ",resource:"/api/v2/payments",ipAddress:"10.0.2.8",outcome:"success",severity:"medium",category:"data-access",payload:'{"records_accessed":88000,"table":"payments","pipeline_id":"pl_8xKw"}'},{id:"evt-007",timestamp:"2026-02-22T07:15:44Z",actor:"eve@corp.io",actorType:"user",action:"PERMISSION_DENIED",resource:"/admin/billing",ipAddress:"203.0.113.88",outcome:"failure",severity:"medium",category:"auth",payload:'{"required_role":"billing_admin","user_roles":["viewer"]}'},{id:"evt-008",timestamp:"2026-02-22T07:22:09Z",actor:"frank@corp.io",actorType:"user",action:"API_KEY_CREATED",resource:"/api/keys",ipAddress:"172.16.0.14",outcome:"success",severity:"medium",category:"api",payload:'{"key_id":"key_7Xm9","scopes":["read:users","write:reports"],"expires_in":"90d"}'},{id:"evt-009",timestamp:"2026-02-22T07:28:17Z",actor:"grace@corp.io",actorType:"user",action:"DATA_DELETE",resource:"/api/v2/users/usr_4422",ipAddress:"10.10.0.55",outcome:"success",severity:"high",category:"data-access",payload:'{"user_id":"usr_4422","deleted_by":"grace@corp.io","gdpr_request":true}'},{id:"evt-010",timestamp:"2026-02-22T07:35:50Z",actor:"auth-service",actorType:"service",action:"TOKEN_REVOKED",resource:"/auth/tokens/tkn_9x2Kp",ipAddress:"10.0.1.2",outcome:"success",severity:"low",category:"auth",payload:'{"token_id":"tkn_9x2Kp","reason":"logout","session_duration":"8h22m"}'},{id:"evt-011",timestamp:"2026-02-22T07:40:05Z",actor:"heidi@corp.io",actorType:"user",action:"WEBHOOK_CONFIGURED",resource:"/config/webhooks",ipAddress:"203.0.113.11",outcome:"success",severity:"low",category:"config-change",payload:'{"webhook_url":"https://external.example.com/hook","events":["payment.completed"]}'},{id:"evt-012",timestamp:"2026-02-22T07:44:33Z",actor:"ivan@corp.io",actorType:"user",action:"REPORT_EXPORTED",resource:"/reports/financial/q4-2025",ipAddress:"192.168.5.66",outcome:"success",severity:"medium",category:"data-access",payload:'{"report_id":"rpt_q4_2025","format":"xlsx","rows":9842}'},{id:"evt-013",timestamp:"2026-02-22T07:50:19Z",actor:"api-monitor",actorType:"service",action:"RATE_LIMIT_EXCEEDED",resource:"/api/v2/search",ipAddress:"198.51.100.33",outcome:"failure",severity:"high",category:"api",payload:'{"caller_id":"ext-app-772","limit":1000,"requests_per_min":1847}'},{id:"evt-014",timestamp:"2026-02-22T07:55:01Z",actor:"judy@corp.io",actorType:"user",action:"MFA_DISABLED",resource:"/users/judy@corp.io/mfa",ipAddress:"10.10.0.12",outcome:"success",severity:"critical",category:"auth",payload:'{"user":"judy@corp.io","mfa_was":"totp","override_reason":"emergency"}'},{id:"evt-015",timestamp:"2026-02-22T08:01:44Z",actor:"kevin@corp.io",actorType:"user",action:"FIREWALL_RULE_ADDED",resource:"/config/network/firewall",ipAddress:"192.168.1.100",outcome:"success",severity:"critical",category:"config-change",payload:'{"rule":"ALLOW 0.0.0.0/0 -> :443","added_by":"kevin@corp.io","env":"production"}'},{id:"evt-016",timestamp:"2026-02-22T08:08:22Z",actor:"sync-service",actorType:"service",action:"SCHEMA_MIGRATED",resource:"/admin/database/schema",ipAddress:"10.0.3.1",outcome:"success",severity:"medium",category:"admin",payload:'{"migration_id":"mig_20260222","tables_affected":7,"duration_ms":4221}'}],S=[{id:"ano-001",type:"unusual-location",confidence:94,affectedUser:"bob@corp.io",status:"investigating",detectedAt:"2026-02-22T03:12:00Z",details:"Login from Minsk, Belarus â€” user has never accessed from this region. VPN not detected."},{id:"ano-002",type:"off-hours-access",confidence:81,affectedUser:"charlie@corp.io",status:"confirmed",detectedAt:"2026-02-22T02:45:00Z",details:"Admin role assignment at 02:45 UTC â€” outside defined business hours (09:00â€“20:00 UTC)."},{id:"ano-003",type:"privilege-escalation",confidence:97,affectedUser:"dave@corp.io",status:"investigating",detectedAt:"2026-02-22T07:06:00Z",details:"User received superadmin role then immediately disabled MFA policy. Behavioral risk score: 9.7."},{id:"ano-004",type:"mass-download",confidence:88,affectedUser:"api-gateway",status:"false-positive",detectedAt:"2026-02-22T06:50:00Z",details:"88,000 payment records accessed in 4 minutes. Confirmed legitimate analytics pipeline run."},{id:"ano-005",type:"off-hours-access",confidence:73,affectedUser:"ivan@corp.io",status:"investigating",detectedAt:"2026-02-22T01:30:00Z",details:"Financial Q4 report exported at 01:30 UTC on a Saturday. User typically active weekday mornings."},{id:"ano-006",type:"unusual-location",confidence:66,affectedUser:"judy@corp.io",status:"confirmed",detectedAt:"2026-02-22T07:55:00Z",details:"MFA emergency override executed from a new IP block. Possible account compromise under investigation."}],C=[{id:"soc2",name:"SOC 2 Type II",controls:[{id:"CC6.1",name:"Logical Access Controls",coverage:96,lastTested:"2026-02-15",status:"pass"},{id:"CC6.2",name:"New Access Provisioning",coverage:88,lastTested:"2026-02-15",status:"pass"},{id:"CC6.3",name:"Access Removal",coverage:100,lastTested:"2026-02-15",status:"pass"},{id:"CC7.2",name:"Security Incident Management",coverage:74,lastTested:"2026-02-10",status:"fail"},{id:"CC8.1",name:"Change Management",coverage:91,lastTested:"2026-02-18",status:"pass"}]},{id:"gdpr",name:"GDPR",controls:[{id:"Art.30",name:"Records of Processing Activities",coverage:100,lastTested:"2026-02-20",status:"pass"},{id:"Art.32",name:"Security of Processing",coverage:85,lastTested:"2026-02-20",status:"pass"},{id:"Art.33",name:"Breach Notification (72h)",coverage:62,lastTested:"2026-02-01",status:"fail"},{id:"Art.17",name:"Right to Erasure (Audit)",coverage:95,lastTested:"2026-02-18",status:"pass"}]},{id:"hipaa",name:"HIPAA",controls:[{id:"164.312(a)",name:"Access Control",coverage:98,lastTested:"2026-02-12",status:"pass"},{id:"164.312(b)",name:"Audit Controls",coverage:100,lastTested:"2026-02-12",status:"pass"},{id:"164.312(c)",name:"Integrity Controls",coverage:80,lastTested:"2026-02-12",status:"pass"},{id:"164.312(e)",name:"Transmission Security",coverage:55,lastTested:"2026-01-28",status:"fail"}]},{id:"iso27001",name:"ISO 27001",controls:[{id:"A.9.2",name:"User Access Management",coverage:93,lastTested:"2026-02-16",status:"pass"},{id:"A.9.4",name:"System Access Control",coverage:89,lastTested:"2026-02-16",status:"pass"},{id:"A.12.4",name:"Logging and Monitoring",coverage:97,lastTested:"2026-02-20",status:"pass"},{id:"A.16.1",name:"Management of Security Incidents",coverage:71,lastTested:"2026-02-05",status:"fail"},{id:"A.18.1",name:"Compliance with Legal Requirements",coverage:84,lastTested:"2026-02-10",status:"pass"}]}],E=["Last 24 Hours â€” All Events","Critical + High â€” Last 7 Days","Auth Events â€” Last 30 Days","Admin Actions â€” This Month","Failed Events Only â€” Last 48h"],_=["24h","7d","30d","90d"];function k(s){switch(s){case"critical":return"bg-rose-400/10 border-rose-400/30";case"high":return"bg-amber-400/10 border-amber-400/30";case"medium":return"bg-yellow-300/10 border-yellow-300/30";case"low":return"bg-sky-400/10 border-sky-400/30";case"info":return"bg-zinc-700/40 border-zinc-600/30"}}function I(s){switch(s){case"critical":return"text-rose-400";case"high":return"text-amber-400";case"medium":return"text-yellow-300";case"low":return"text-sky-400";case"info":return"text-zinc-400"}}function D(s){switch(s){case"critical":return"bg-rose-400";case"high":return"bg-amber-400";case"medium":return"bg-yellow-300";case"low":return"bg-sky-400";case"info":return"bg-zinc-500"}}function R(s){switch(s){case"unusual-location":return"Unusual Location";case"off-hours-access":return"Off-Hours Access";case"privilege-escalation":return"Privilege Escalation";case"mass-download":return"Mass Download"}}function L(s){switch(s){case"unusual-location":return"text-amber-400";case"off-hours-access":return"text-sky-400";case"privilege-escalation":return"text-rose-400";case"mass-download":return"text-purple-400"}}function O(s){switch(s){case"investigating":return"bg-amber-400/10 text-amber-400 border-amber-400/30";case"confirmed":return"bg-rose-400/10 text-rose-400 border-rose-400/30";case"false-positive":return"bg-emerald-400/10 text-emerald-400 border-emerald-400/30"}}function M(s){switch(s){case"investigating":return"Investigating";case"confirmed":return"Confirmed";case"false-positive":return"False Positive"}}function P(s){return s>=90?"bg-rose-400":s>=75?"bg-amber-400":s>=60?"bg-yellow-300":"bg-sky-400"}function U(s){return s>=90?"text-rose-400":s>=75?"text-amber-400":s>=60?"text-yellow-300":"text-sky-400"}function j(s){return s>=90?"bg-emerald-400":s>=70?"bg-amber-400":"bg-rose-400"}function v(s){const r=new Date(s),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r.getUTCMonth()],c=r.getUTCDate(),a=String(r.getUTCHours()).padStart(2,"0"),t=String(r.getUTCMinutes()).padStart(2,"0"),m=String(r.getUTCSeconds()).padStart(2,"0");return`${i} ${c}, ${a}:${t}:${m} UTC`}function h(s){return s.split("-").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ")}function F(s){switch(s){case"investigating":return"confirmed";case"confirmed":return"false-positive";case"false-positive":return"investigating"}}function Z(s){switch(s){case"investigating":return"Mark Confirmed";case"confirmed":return"Mark False Positive";case"false-positive":return"Reopen"}}function B(s){switch(s){case"24h":return 1;case"7d":return 7;case"30d":return 30;case"90d":return 90}}function G({label:s,tabId:r,active:d,onClick:i,count:c}){return e.jsxs("button",{onClick:()=>i(r),className:n("relative px-5 py-3 text-sm font-medium transition-colors duration-150 border-b-2",d?"text-white border-indigo-500":"text-zinc-400 border-transparent hover:text-zinc-200 hover:border-zinc-600"),children:[s,c!==void 0&&e.jsx("span",{className:n("ml-2 inline-flex items-center justify-center px-1.5 py-0.5 text-xs rounded-full",d?"bg-indigo-500/30 text-indigo-300":"bg-zinc-700 text-zinc-400"),children:c})]})}function N({severity:s}){return e.jsxs("span",{className:n("inline-flex items-center gap-1.5 px-2 py-0.5 rounded text-xs font-medium border",k(s)),children:[e.jsx("span",{className:n("w-1.5 h-1.5 rounded-full",D(s))}),e.jsx("span",{className:I(s),children:s.toUpperCase()})]})}const K=["all","critical","high","medium","low","info"],q=["all","auth","data-access","admin","config-change","api"];function H({events:s,filters:r,onFilterChange:d,selectedEvent:i,onSelectEvent:c}){const a=s.filter(t=>!(r.severity!=="all"&&t.severity!==r.severity||r.category!=="all"&&t.category!==r.category));return e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:n("flex flex-col gap-4",i?"w-1/2":"w-full"),children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-end bg-zinc-900 rounded-xl p-4 border border-zinc-800",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("span",{className:"text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Severity"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:K.map(t=>e.jsx("button",{onClick:()=>d({...r,severity:t}),className:n("px-2.5 py-1 rounded text-xs font-medium transition-colors",r.severity===t?"bg-indigo-500 text-white":"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-zinc-200"),children:t==="all"?"All":t.charAt(0).toUpperCase()+t.slice(1)},t))})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("span",{className:"text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Category"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:q.map(t=>e.jsx("button",{onClick:()=>d({...r,category:t}),className:n("px-2.5 py-1 rounded text-xs font-medium transition-colors",r.category===t?"bg-indigo-500 text-white":"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-zinc-200"),children:t==="all"?"All":h(t)},t))})]}),e.jsxs("div",{className:"flex gap-2 items-end ml-auto",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"From"}),e.jsx("input",{type:"date",value:r.dateStart,onChange:t=>d({...r,dateStart:t.target.value}),className:"bg-zinc-800 border border-zinc-700 text-zinc-200 text-xs rounded px-2 py-1.5 focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"To"}),e.jsx("input",{type:"date",value:r.dateEnd,onChange:t=>d({...r,dateEnd:t.target.value}),className:"bg-zinc-800 border border-zinc-700 text-zinc-200 text-xs rounded px-2 py-1.5 focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),e.jsxs("span",{className:"text-xs text-zinc-600 self-end pb-1",children:[a.length," event",a.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex flex-col gap-1.5 overflow-y-auto",style:{maxHeight:"calc(100vh - 340px)"},children:[a.map(t=>e.jsxs("button",{onClick:()=>c((i==null?void 0:i.id)===t.id?null:t),className:n("w-full text-left rounded-lg border px-4 py-3 transition-all duration-150",(i==null?void 0:i.id)===t.id?"bg-indigo-500/10 border-indigo-500/50":"bg-zinc-900 border-zinc-800 hover:bg-zinc-800 hover:border-zinc-700"),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx(N,{severity:t.severity}),e.jsx("span",{className:"text-xs text-zinc-500 font-mono shrink-0",children:v(t.timestamp)}),e.jsx("span",{className:n("ml-auto shrink-0 text-xs px-2 py-0.5 rounded border font-medium",t.outcome==="success"?"text-emerald-400 border-emerald-400/30 bg-emerald-400/10":"text-rose-400 border-rose-400/30 bg-rose-400/10"),children:t.outcome})]}),e.jsxs("div",{className:"mt-1.5 flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"text-white text-sm font-semibold shrink-0",children:t.action}),e.jsx("span",{className:"text-zinc-500 text-xs shrink-0",children:"on"}),e.jsx("span",{className:"text-indigo-300 text-xs font-mono truncate",children:t.resource})]}),e.jsxs("div",{className:"mt-1 flex items-center gap-3 text-xs text-zinc-500",children:[e.jsxs("span",{children:[t.actorType==="user"?"ðŸ‘¤":"âš™ï¸"," ",t.actor]}),e.jsx("span",{children:"Â·"}),e.jsx("span",{children:t.ipAddress}),e.jsx("span",{children:"Â·"}),e.jsx("span",{className:"text-zinc-600",children:h(t.category)})]})]},t.id)),a.length===0&&e.jsx("div",{className:"flex items-center justify-center h-32 text-zinc-600 text-sm",children:"No events match the current filters"})]})]}),i!==null&&e.jsxs("div",{className:"w-1/2 bg-zinc-900 rounded-xl border border-zinc-800 p-5 flex flex-col gap-5 overflow-y-auto",style:{maxHeight:"calc(100vh - 240px)"},children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold text-base",children:i.action}),e.jsx("p",{className:"text-zinc-600 text-xs mt-0.5 font-mono",children:i.id})]}),e.jsx("button",{onClick:()=>c(null),className:"text-zinc-600 hover:text-zinc-300 text-xl leading-none shrink-0",children:"âœ•"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(N,{severity:i.severity}),e.jsx("span",{className:n("inline-flex items-center px-2 py-0.5 rounded text-xs font-medium border",i.outcome==="success"?"text-emerald-400 border-emerald-400/30 bg-emerald-400/10":"text-rose-400 border-rose-400/30 bg-rose-400/10"),children:i.outcome==="success"?"âœ“ Success":"âœ— Failure"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{label:"Timestamp",value:v(i.timestamp)},{label:"IP Address",value:i.ipAddress},{label:"Actor",value:i.actor},{label:"Actor Type",value:h(i.actorType)},{label:"Resource",value:i.resource},{label:"Category",value:h(i.category)}].map(({label:t,value:m})=>e.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-zinc-500 text-xs mb-1",children:t}),e.jsx("p",{className:"text-zinc-100 text-sm font-medium font-mono break-all",children:m})]},t))}),e.jsxs("div",{children:[e.jsx("p",{className:"text-zinc-500 text-xs mb-2 font-medium uppercase tracking-wider",children:"Raw Payload"}),e.jsx("pre",{className:"bg-zinc-950 rounded-lg p-4 text-xs text-emerald-300 font-mono overflow-x-auto border border-zinc-800 whitespace-pre-wrap",children:JSON.stringify(JSON.parse(i.payload),null,2)})]})]})]})}function J({anomalies:s,onStatusChange:r}){const d=["investigating","confirmed","false-positive"],i={investigating:"border-amber-400/30 bg-amber-400/5",confirmed:"border-rose-400/30 bg-rose-400/5","false-positive":"border-emerald-400/30 bg-emerald-400/5"},c={investigating:"text-amber-400",confirmed:"text-rose-400","false-positive":"text-emerald-400"},a={investigating:"Investigating",confirmed:"Confirmed","false-positive":"False Positives"};return e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsx("div",{className:"grid grid-cols-3 gap-4",children:d.map(t=>{const m=s.filter(o=>o.status===t).length;return e.jsxs("div",{className:n("rounded-xl border p-4",i[t]),children:[e.jsx("p",{className:n("text-2xl font-bold",c[t]),children:m}),e.jsx("p",{className:"text-zinc-400 text-sm mt-1",children:a[t]})]},t)})}),e.jsx("div",{className:"flex flex-col gap-3",children:s.map(t=>e.jsx("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-5",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("span",{className:n("text-sm font-semibold",L(t.type)),children:R(t.type)}),e.jsx("span",{className:n("px-2 py-0.5 rounded text-xs border font-medium",O(t.status)),children:M(t.status)}),e.jsx("span",{className:"text-zinc-700 text-xs font-mono ml-auto",children:t.id})]}),e.jsx("p",{className:"text-zinc-300 text-sm mt-2 leading-relaxed",children:t.details}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-xs text-zinc-500",children:[e.jsxs("span",{children:["ðŸ‘¤ ",t.affectedUser]}),e.jsx("span",{children:"Â·"}),e.jsxs("span",{children:["Detected ",v(t.detectedAt)]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-3 shrink-0",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-zinc-500 mb-1.5",children:"Confidence"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 h-2 bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:n("h-full rounded-full",P(t.confidence)),style:{width:`${t.confidence}%`}})}),e.jsxs("span",{className:n("text-sm font-bold tabular-nums",U(t.confidence)),children:[t.confidence,"%"]})]})]}),e.jsx("button",{onClick:()=>r(t.id,F(t.status)),className:"px-3 py-1.5 text-xs font-medium rounded-lg bg-zinc-800 text-zinc-300 border border-zinc-700 hover:bg-zinc-700 hover:text-white transition-colors whitespace-nowrap",children:Z(t.status)})]})]})},t.id))})]})}function V({frameworks:s}){const[r,d]=x.useState(s[0]!==void 0?s[0].id:null);return e.jsx("div",{className:"flex flex-col gap-4",children:s.map(i=>{const c=r===i.id,a=Math.round(i.controls.reduce((o,u)=>o+u.coverage,0)/i.controls.length),t=i.controls.filter(o=>o.status==="pass").length,m=i.controls.length-t;return e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 overflow-hidden",children:[e.jsxs("button",{onClick:()=>d(c?null:i.id),className:"w-full flex items-center justify-between px-5 py-4 hover:bg-zinc-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-white font-semibold",children:i.name}),e.jsxs("span",{className:"text-zinc-500 text-sm",children:[i.controls.length," controls"]})]}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("span",{className:"text-emerald-400 text-sm font-medium",children:[t," pass"]}),e.jsxs("span",{className:"text-rose-400 text-sm font-medium",children:[m," fail"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-28 h-2 bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:n("h-full rounded-full",j(a)),style:{width:`${a}%`}})}),e.jsxs("span",{className:"text-zinc-300 text-xs font-medium w-10 text-right tabular-nums",children:[a,"%"]})]}),e.jsx("span",{className:n("text-zinc-400 text-xs transition-transform duration-200",c?"rotate-180":"rotate-0"),children:"â–¼"})]})]}),c&&e.jsx("div",{className:"border-t border-zinc-800 overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-zinc-950/50",children:[e.jsx("th",{className:"text-left px-5 py-2.5 text-xs font-medium text-zinc-500 uppercase tracking-wider whitespace-nowrap",children:"Control ID"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-zinc-500 uppercase tracking-wider w-48",children:"Coverage"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-zinc-500 uppercase tracking-wider whitespace-nowrap",children:"Last Tested"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{children:i.controls.map((o,u)=>e.jsxs("tr",{className:n("border-t border-zinc-800/50",u%2!==0?"bg-zinc-950/20":"bg-transparent"),children:[e.jsx("td",{className:"px-5 py-3 font-mono text-indigo-300 text-xs whitespace-nowrap",children:o.id}),e.jsx("td",{className:"px-4 py-3 text-zinc-200 whitespace-nowrap",children:o.name}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-zinc-800 rounded-full overflow-hidden min-w-16",children:e.jsx("div",{className:n("h-full rounded-full",j(o.coverage)),style:{width:`${o.coverage}%`}})}),e.jsxs("span",{className:"text-xs text-zinc-400 w-9 text-right tabular-nums",children:[o.coverage,"%"]})]})}),e.jsx("td",{className:"px-4 py-3 text-zinc-400 text-xs font-mono whitespace-nowrap",children:o.lastTested}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:n("inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium border",o.status==="pass"?"text-emerald-400 border-emerald-400/30 bg-emerald-400/10":"text-rose-400 border-rose-400/30 bg-rose-400/10"),children:o.status==="pass"?"âœ“ Pass":"âœ— Fail"})})]},o.id))})]})})]},i.id)})})}const $={JSON:"Structured JSON with full event metadata, nested objects, and type annotations.",CSV:"Flat CSV suitable for Excel, Google Sheets, or data pipeline ingestion.",SIEM:"CEF/Syslog format compatible with Splunk, Datadog, and QRadar."};function W({state:s,onChange:r}){const d=["JSON","CSV","SIEM"],i=()=>{const a={...s,isExporting:!0};r(a),setTimeout(()=>{r({...a,isExporting:!1})},2500)},c=a=>{const t=new Date,m=new Date;m.setDate(t.getDate()-B(a)),r({...s,dateStart:m.toISOString().slice(0,10),dateEnd:t.toISOString().slice(0,10)})};return e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-5",children:[e.jsx("h3",{className:"text-white font-semibold text-sm mb-4",children:"Export Format"}),e.jsx("div",{className:"flex flex-col gap-2",children:d.map(a=>e.jsxs("button",{onClick:()=>r({...s,format:a}),className:n("flex items-start gap-3 p-3 rounded-lg border text-left transition-colors",s.format===a?"bg-indigo-500/10 border-indigo-500/50":"bg-zinc-800/30 border-zinc-700/50 hover:bg-zinc-800 hover:border-zinc-600"),children:[e.jsx("div",{className:n("w-4 h-4 rounded-full border-2 mt-0.5 shrink-0 flex items-center justify-center",s.format===a?"border-indigo-500 bg-indigo-500":"border-zinc-600"),children:s.format===a&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:n("text-sm font-medium",s.format===a?"text-white":"text-zinc-300"),children:a}),e.jsx("p",{className:"text-zinc-500 text-xs mt-0.5",children:$[a]})]})]},a))})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-5",children:[e.jsx("h3",{className:"text-white font-semibold text-sm mb-4",children:"Date Range"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-zinc-500 mb-1.5",children:"Start Date"}),e.jsx("input",{type:"date",value:s.dateStart,onChange:a=>r({...s,dateStart:a.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 text-zinc-200 text-sm rounded-lg px-3 py-2 focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-zinc-500 mb-1.5",children:"End Date"}),e.jsx("input",{type:"date",value:s.dateEnd,onChange:a=>r({...s,dateEnd:a.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 text-zinc-200 text-sm rounded-lg px-3 py-2 focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),e.jsx("div",{className:"flex gap-2",children:_.map(a=>e.jsxs("button",{onClick:()=>c(a),className:"px-3 py-1 text-xs rounded bg-zinc-800 text-zinc-400 border border-zinc-700 hover:bg-zinc-700 hover:text-zinc-200 transition-colors",children:["Last ",a]},a))})]})]}),e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-5",children:[e.jsx("h3",{className:"text-white font-semibold text-sm mb-4",children:"Saved Presets"}),e.jsx("div",{className:"flex flex-col gap-2",children:E.map(a=>e.jsxs("button",{onClick:()=>r({...s,preset:a}),className:n("flex items-center gap-2 px-3 py-2.5 rounded-lg border text-left text-sm transition-colors",s.preset===a?"bg-indigo-500/10 border-indigo-500/40 text-white":"bg-zinc-800/30 border-zinc-700/50 text-zinc-400 hover:bg-zinc-800 hover:text-zinc-200 hover:border-zinc-600"),children:[e.jsx("span",{className:n("w-2 h-2 rounded-full shrink-0",s.preset===a?"bg-indigo-400":"bg-zinc-600")}),a]},a))})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-5",children:[e.jsx("h3",{className:"text-white font-semibold text-sm mb-4",children:"Generate Export"}),e.jsxs("div",{className:"bg-zinc-950/60 rounded-lg p-3 mb-4 text-xs text-zinc-500 border border-zinc-800/80 space-y-1",children:[e.jsxs("p",{children:["Format:"," ",e.jsx("span",{className:"text-zinc-300 font-medium",children:s.format})]}),e.jsxs("p",{children:["Range:"," ",e.jsxs("span",{className:"text-zinc-300 font-medium",children:[s.dateStart||"â€”"," â†’ ",s.dateEnd||"â€”"]})]}),s.preset!==""&&e.jsxs("p",{children:["Preset:"," ",e.jsx("span",{className:"text-indigo-300 font-medium",children:s.preset})]})]}),e.jsx("button",{onClick:i,disabled:s.isExporting,className:n("w-full py-3 rounded-lg text-sm font-semibold transition-all duration-200",s.isExporting?"bg-indigo-600/40 text-indigo-300 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-500 text-white"),children:s.isExporting?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"inline-block w-4 h-4 border-2 border-indigo-300/30 border-t-indigo-300 rounded-full animate-spin"}),"Preparing exportâ€¦"]}):"Generate Export"}),!s.isExporting&&s.preset!==""&&e.jsxs("p",{className:"text-center text-xs text-zinc-600 mt-3",children:["Will include all matching events in ",s.format," format."]})]})]})]})}function Q(){const[s,r]=x.useState("events"),[d,i]=x.useState(null),[c,a]=x.useState({severity:"all",category:"all",dateStart:"2026-02-22",dateEnd:"2026-02-22"}),[t,m]=x.useState(S),[o,u]=x.useState({format:"JSON",dateStart:"2026-02-15",dateEnd:"2026-02-22",preset:"",isExporting:!1}),z=(l,f)=>{m(b=>b.map(p=>p.id===l?{...p,status:f}:p))},y=t.filter(l=>l.status==="investigating").length,w=[{id:"events",label:"Events",count:g.length},{id:"anomalies",label:"Anomalies",count:y},{id:"compliance",label:"Compliance"},{id:"export",label:"Export"}],T=g.filter(l=>l.severity==="critical").length,A=g.filter(l=>l.outcome==="failure").length;return e.jsx("div",{className:"min-h-screen bg-zinc-950 text-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"flex items-start justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white tracking-tight",children:"Security Audit Trail"}),e.jsx("p",{className:"text-zinc-500 text-sm mt-1",children:"Real-time event log, anomaly detection, and compliance coverage"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-emerald-400/10 border border-emerald-400/20 rounded-lg",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-400 animate-pulse"}),e.jsx("span",{className:"text-emerald-400 text-sm font-medium",children:"Live"})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[{label:"Total Events",value:String(g.length),sub:"last 24h",color:"text-white"},{label:"Critical",value:String(T),sub:"need attention",color:"text-rose-400"},{label:"Failed",value:String(A),sub:"outcomes",color:"text-amber-400"},{label:"Active Anomalies",value:String(y),sub:"investigating",color:"text-indigo-400"}].map(({label:l,value:f,sub:b,color:p})=>e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 px-5 py-4",children:[e.jsx("p",{className:"text-zinc-500 text-xs uppercase tracking-wider mb-1",children:l}),e.jsx("p",{className:n("text-3xl font-bold tabular-nums",p),children:f}),e.jsx("p",{className:"text-zinc-600 text-xs mt-1",children:b})]},l))}),e.jsx("div",{className:"flex border-b border-zinc-800 mb-6",children:w.map(l=>e.jsx(G,{tabId:l.id,label:l.label,active:s===l.id,onClick:r,count:l.count},l.id))}),s==="events"&&e.jsx(H,{events:g,filters:c,onFilterChange:a,selectedEvent:d,onSelectEvent:i}),s==="anomalies"&&e.jsx(J,{anomalies:t,onStatusChange:z}),s==="compliance"&&e.jsx(V,{frameworks:C}),s==="export"&&e.jsx(W,{state:o,onChange:u})]})})}export{Q as default};
