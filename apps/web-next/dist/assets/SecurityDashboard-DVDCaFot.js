import{r as m,j as e,c as n}from"./index-1Mn94Dpj.js";const z=new Date,l=s=>new Date(z.getTime()-s),E=s=>new Date(z.getTime()+s),C=s=>s*6e4,p=s=>s*36e5,u=s=>s*864e5,I=[{id:"se1",timestamp:l(p(4)),threatLevel:"high",type:"Brute Force Attempt",description:"3 invalid API token attempts from a single IP within 60 seconds.",ip:"198.51.100.44",actor:"api:unknown",attempts:3,resolved:!1,country:"RU"},{id:"se2",timestamp:l(p(2)),threatLevel:"medium",type:"Budget Threshold",description:"Daily token budget at 87% — claude-opus-4-6. Potential runaway agent.",actor:"system",attempts:1,resolved:!1,country:void 0},{id:"se3",timestamp:l(C(34)),threatLevel:"medium",type:"Scope Violation",description:"API key oc_sk_dev_3a9b attempted sessions:write without permission.",ip:"192.168.1.44",actor:"api:oc_sk_dev_3a9b",attempts:1,resolved:!0,country:"US"},{id:"se4",timestamp:l(u(1)+p(3)),threatLevel:"low",type:"Unusual Access Time",description:"API key oc_sk_prod_7f2a used at 3:47 AM — outside normal hours.",ip:"203.0.113.12",actor:"api:oc_sk_prod_7f2a",attempts:1,resolved:!0,country:"US"},{id:"se5",timestamp:l(u(2)),threatLevel:"info",type:"New Device Login",description:"David signed in from a new browser (Safari/19) for the first time.",ip:"10.0.1.5",actor:"user:david",attempts:1,resolved:!0,country:"US"},{id:"se6",timestamp:l(u(3)),threatLevel:"critical",type:"Key Exposure Risk",description:"API key pattern detected in a pushed GitHub commit (now rolled back).",actor:"user:david",attempts:1,resolved:!0,country:"US"}],P=[{id:"bi1",ip:"198.51.100.44",country:"RU",reason:"Brute force — 3 invalid token attempts",blockedAt:l(p(4)),expiresAt:E(p(20)),status:"active",attempts:3},{id:"bi2",ip:"203.0.113.99",country:"CN",reason:"Port scanning detected",blockedAt:l(u(2)),expiresAt:l(p(4)),status:"expired",attempts:47},{id:"bi3",ip:"192.0.2.55",country:"KP",reason:"Manually blocked — suspicious reconnaissance",blockedAt:l(u(5)),status:"manual",attempts:2}],g={overall:82,authentication:91,apiSecurity:78,networkSecurity:84,dataProtection:88},h=[2,0,1,3,0,0,1,2,4,1,0,2,1,0,0,3,1,0,2,1,0,0,1,2,3,0,1,4,2,1];Array.from({length:30},(s,r)=>new Date(z.getTime()-(29-r)*u(1)).getDate().toString());const N={critical:{label:"Critical",dot:"bg-rose-500",badge:"bg-rose-500/15 text-rose-300 ring-1 ring-rose-500/25",text:"text-rose-400"},high:{label:"High",dot:"bg-orange-500",badge:"bg-orange-500/15 text-orange-300 ring-1 ring-orange-500/25",text:"text-orange-400"},medium:{label:"Medium",dot:"bg-amber-500",badge:"bg-amber-500/15 text-amber-300 ring-1 ring-amber-500/25",text:"text-amber-400"},low:{label:"Low",dot:"bg-indigo-500",badge:"bg-indigo-500/15 text-indigo-300 ring-1 ring-indigo-500/25",text:"text-indigo-400"},info:{label:"Info",dot:"bg-zinc-500",badge:"bg-zinc-500/15 text-zinc-400 ring-1 ring-zinc-500/25",text:"text-zinc-400"}},_={active:{label:"Active",badge:"bg-rose-500/15 text-rose-300 ring-1 ring-rose-500/25"},expired:{label:"Expired",badge:"bg-zinc-700/50 text-zinc-500 ring-1 ring-zinc-600/25"},manual:{label:"Manual",badge:"bg-amber-500/15 text-amber-300 ring-1 ring-amber-500/25"}};function y(s){const r=Date.now()-s.getTime();return r<0?"in future":r<6e4?"just now":r<36e5?`${Math.floor(r/6e4)}m ago`:r<864e5?`${Math.floor(r/36e5)}h ago`:`${Math.floor(r/864e5)}d ago`}function D(s){if(!s)return"Never";const r=s.getTime()-Date.now();return r<0?"Expired":r<36e5?`${Math.floor(r/6e4)}m remaining`:r<864e5?`${Math.floor(r/36e5)}h remaining`:`${Math.floor(r/864e5)}d remaining`}function M({score:s}){const a=2*Math.PI*40,c=a-s/100*a,o=s>=80?"#34d399":s>=60?"#fbbf24":"#f87171";return e.jsxs("div",{className:"relative flex items-center justify-center h-28 w-28","aria-label":`Security score: ${s}/100`,children:[e.jsxs("svg",{className:"absolute",width:"112",height:"112",viewBox:"0 0 112 112",children:[e.jsx("circle",{cx:"56",cy:"56",r:40,fill:"none",stroke:"#27272a",strokeWidth:"10"}),e.jsx("circle",{cx:"56",cy:"56",r:40,fill:"none",stroke:o,strokeWidth:"10",strokeLinecap:"round",strokeDasharray:a,strokeDashoffset:c,transform:"rotate(-90 56 56)",style:{transition:"stroke-dashoffset 0.6s ease"}})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:s}),e.jsx("p",{className:"text-xs text-zinc-500",children:"/ 100"})]})]})}function B(){const s=Math.max(...h),r=48,a=8;return e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-zinc-500 uppercase tracking-wider mb-3",children:"30-Day Threat Activity"}),e.jsx("div",{className:"flex items-end gap-px","aria-label":"30-day threat history bar chart",children:h.map((c,o)=>{const f=s>0?Math.max(2,c/s*r):2,b=o===h.length-1,v=c===0?"bg-zinc-800":c>=3?"bg-rose-500":c>=2?"bg-amber-500":"bg-indigo-500";return e.jsx("div",{className:n("rounded-sm",v,b&&"ring-1 ring-white/20"),style:{width:a,height:f,minHeight:2},title:`Day ${o+1}: ${c} events`},o)})}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:"text-xs text-zinc-700",children:"30 days ago"}),e.jsx("span",{className:"text-xs text-zinc-700",children:"Today"})]})]})}function U(){const[s,r]=m.useState("overview"),[a,c]=m.useState("all"),[o,f]=m.useState(P),[b,v]=m.useState(I),w=b.filter(t=>a==="unresolved"?!t.resolved:a==="all"?!0:t.threatLevel===a),S=m.useCallback(t=>{f(i=>i.filter(d=>d.id!==t))},[]),k=m.useCallback(t=>{v(i=>i.map(d=>d.id===t?{...d,resolved:!0}:d))},[]),x=b.filter(t=>!t.resolved).length,j=o.filter(t=>t.status==="active").length,A=[{id:"overview",label:"Overview"},{id:"events",label:"Events",badge:x},{id:"blocked",label:"Blocked IPs",badge:j}];return e.jsxs("div",{className:"flex flex-col h-full bg-zinc-950",children:[e.jsxs("div",{className:"flex-none px-6 py-4 border-b border-zinc-800",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-white",children:"Security Dashboard"}),e.jsx("p",{className:"text-sm text-zinc-500 mt-0.5",children:"Threat detection, blocked IPs, and security posture"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[x>0&&e.jsxs("span",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-rose-500/15 text-rose-300 ring-1 ring-rose-500/25",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-rose-500 animate-pulse"}),x," unresolved"]}),e.jsx("span",{className:"text-zinc-600",children:"Last scan: just now"})]})]}),e.jsx("div",{role:"tablist","aria-label":"Security sections",className:"flex items-center gap-1 mt-4",children:A.map(t=>e.jsxs("button",{role:"tab","aria-selected":s===t.id,onClick:()=>r(t.id),className:n("flex items-center gap-1.5 px-3 py-2 text-sm font-medium rounded-lg transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",s===t.id?"bg-zinc-800 text-white":"text-zinc-500 hover:text-zinc-200 hover:bg-zinc-900"),children:[t.label,t.badge!==void 0&&t.badge>0&&e.jsx("span",{className:"px-1.5 py-0.5 text-xs font-semibold rounded-full bg-rose-500 text-white",children:t.badge})]},t.id))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[s==="overview"&&e.jsxs("div",{className:"px-6 py-5 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start gap-6 p-5 rounded-xl bg-zinc-900 border border-zinc-800",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(M,{score:g.overall}),e.jsx("p",{className:"text-sm font-semibold text-zinc-300",children:"Security Score"}),e.jsx("p",{className:"text-xs text-zinc-600 text-center",children:"Good — a few improvements possible"})]}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx("p",{className:"text-xs font-semibold text-zinc-500 uppercase tracking-wider",children:"Score Breakdown"}),[{label:"Authentication",value:g.authentication},{label:"API Security",value:g.apiSecurity},{label:"Network Security",value:g.networkSecurity},{label:"Data Protection",value:g.dataProtection}].map(({label:t,value:i})=>{const d=i>=85?"bg-emerald-500":i>=70?"bg-amber-500":"bg-rose-500",T=i>=85?"text-emerald-400":i>=70?"text-amber-400":"text-rose-400";return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-zinc-400",children:t}),e.jsx("span",{className:n("text-xs font-mono font-semibold tabular-nums",T),children:i})]}),e.jsx("div",{className:"h-1.5 w-full bg-zinc-800 rounded-full",children:e.jsx("div",{className:n("h-1.5 rounded-full transition-all",d),style:{width:`${i}%`}})})]},t)})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[{label:"Unresolved Events",value:x.toString(),color:x>0?"text-rose-400":"text-emerald-400"},{label:"Active Blocks",value:j.toString(),color:j>0?"text-amber-400":"text-zinc-300"},{label:"Events (30d)",value:h.reduce((t,i)=>t+i,0).toString(),color:"text-zinc-300"},{label:"Auth Failures (24h)",value:"4",color:"text-zinc-300"}].map(({label:t,value:i,color:d})=>e.jsxs("div",{className:"p-4 rounded-xl bg-zinc-900 border border-zinc-800",children:[e.jsx("p",{className:"text-xs text-zinc-500",children:t}),e.jsx("p",{className:n("text-2xl font-bold tabular-nums mt-1",d),children:i})]},t))}),e.jsxs("div",{className:"p-5 rounded-xl bg-zinc-900 border border-zinc-800",children:[e.jsx(B,{}),e.jsx("div",{className:"flex items-center gap-4 mt-3",children:[{color:"bg-rose-500",label:"≥3 events"},{color:"bg-amber-500",label:"2 events"},{color:"bg-indigo-500",label:"1 event"},{color:"bg-zinc-800",label:"None"}].map(({color:t,label:i})=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:n("h-2 w-4 rounded-sm",t)}),e.jsx("span",{className:"text-xs text-zinc-600",children:i})]},i))})]}),x>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-semibold text-zinc-500 uppercase tracking-wider mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-rose-500 animate-pulse"}),"Unresolved Events"]}),e.jsx("div",{className:"space-y-2",children:b.filter(t=>!t.resolved).map(t=>{const i=N[t.threatLevel];return e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-zinc-900 border border-zinc-800",children:[e.jsx("span",{className:n("flex-none h-2 w-2 rounded-full mt-1.5",i.dot)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:n("text-xs font-medium px-1.5 py-0.5 rounded-full ring-1",i.badge),children:i.label}),e.jsx("span",{className:"text-sm font-semibold text-white",children:t.type})]}),e.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:t.description}),e.jsxs("p",{className:"text-xs text-zinc-600 mt-1",children:[y(t.timestamp)," ",t.ip&&`· ${t.ip}`," ",t.country&&`(${t.country})`]})]}),e.jsx("button",{onClick:()=>k(t.id),"aria-label":`Mark ${t.type} as resolved`,className:"flex-none py-1 px-2.5 text-xs font-medium rounded-lg bg-zinc-800 text-zinc-300 hover:bg-zinc-700 border border-zinc-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 transition-colors",children:"Resolve"})]},t.id)})})]})]}),s==="events"&&e.jsxs("div",{className:"px-6 py-5",children:[e.jsx("div",{role:"group","aria-label":"Filter security events",className:"flex flex-wrap gap-2 mb-4",children:["all","unresolved","critical","high","medium","low","info"].map(t=>e.jsx("button",{onClick:()=>c(t),"aria-pressed":a===t,className:n("px-3 py-1 text-xs font-medium rounded-full transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",a===t?"bg-indigo-600 text-white":"bg-zinc-800 text-zinc-400 border border-zinc-700 hover:text-zinc-200"),children:t==="all"?"All":t==="unresolved"?"Unresolved":N[t].label},t))}),e.jsxs("div",{className:"space-y-2",children:[w.map(t=>{const i=N[t.threatLevel];return e.jsx("div",{className:n("p-4 rounded-xl border transition-colors",t.resolved?"bg-zinc-900 border-zinc-800 opacity-60":"bg-zinc-900 border-zinc-700"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:n("flex-none h-2 w-2 rounded-full mt-1.5",i.dot)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:n("text-xs font-medium px-1.5 py-0.5 rounded-full ring-1",i.badge),children:i.label}),e.jsx("span",{className:"text-sm font-semibold text-white",children:t.type}),t.resolved&&e.jsx("span",{className:"text-xs text-emerald-500",children:"✓ Resolved"})]}),e.jsx("p",{className:"text-xs text-zinc-400 mt-1 leading-relaxed",children:t.description}),e.jsxs("div",{className:"flex items-center gap-3 mt-1.5 text-xs text-zinc-600",children:[e.jsx("span",{children:y(t.timestamp)}),t.ip&&e.jsx("span",{children:t.ip}),t.country&&e.jsxs("span",{children:["(",t.country,")"]}),t.actor&&e.jsx("span",{className:"font-mono",children:t.actor}),t.attempts&&t.attempts>1&&e.jsxs("span",{children:[t.attempts," attempts"]})]})]}),!t.resolved&&e.jsx("button",{onClick:()=>k(t.id),"aria-label":"Mark as resolved",className:"flex-none py-1 px-2.5 text-xs font-medium rounded-lg bg-zinc-800 text-zinc-300 hover:bg-emerald-600/20 hover:text-emerald-300 border border-zinc-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 transition-colors",children:"Resolve"})]})},t.id)}),w.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 py-16 text-center",children:[e.jsx("span",{className:"text-3xl",children:"✅"}),e.jsx("p",{className:"text-sm font-medium text-zinc-300",children:"No events matching filter"})]})]})]}),s==="blocked"&&e.jsxs("div",{className:"px-6 py-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("p",{className:"text-xs font-semibold text-zinc-500 uppercase tracking-wider",children:[o.length," entries"]}),e.jsxs("button",{"aria-label":"Block new IP address",className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-zinc-800 text-zinc-300 hover:bg-zinc-700 border border-zinc-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 transition-colors",children:[e.jsx("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",d:"M7 2v10M2 7h10"})}),"Block IP"]})]}),e.jsx("div",{className:"space-y-3",children:o.map(t=>{const i=_[t.status];return e.jsx("div",{className:n("p-4 rounded-xl border",t.status==="active"?"bg-zinc-900 border-zinc-700":"bg-zinc-900 border-zinc-800 opacity-60"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-sm font-mono font-semibold text-white",children:t.ip}),e.jsx("span",{className:n("px-1.5 py-0.5 text-xs font-medium rounded-full",i.badge),children:i.label}),e.jsx("span",{className:"text-xs text-zinc-600",children:t.country})]}),e.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:t.reason}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-zinc-600",children:[e.jsxs("span",{children:["Blocked ",y(t.blockedAt)]}),e.jsx("span",{children:"·"}),e.jsx("span",{children:D(t.expiresAt)}),e.jsx("span",{children:"·"}),e.jsxs("span",{children:[t.attempts," attempt",t.attempts!==1?"s":""]})]})]}),t.status!=="expired"&&e.jsx("button",{onClick:()=>S(t.id),"aria-label":`Unblock ${t.ip}`,className:"flex-none py-1 px-2.5 text-xs font-medium rounded-lg bg-zinc-800 text-zinc-400 hover:text-rose-400 border border-zinc-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-rose-500 transition-colors",children:"Unblock"})]})},t.id)})})]})]})]})}export{U as default};
