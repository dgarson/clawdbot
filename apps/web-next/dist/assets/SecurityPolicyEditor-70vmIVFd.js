import{r as x,j as e,c as b}from"./index-MWx9SRPD.js";const N=[{id:"pol-1",name:"GDPR Compliance",scope:"All EU User Data",status:"active",lastUpdated:"2026-02-18",owner:"Maria Chen",description:"Ensures all personal data processing complies with GDPR Articles 5-11. Covers consent management, data subject rights, and cross-border transfers.",enforcementMode:"enforce"},{id:"pol-2",name:"API Access Control",scope:"External & Internal APIs",status:"active",lastUpdated:"2026-02-15",owner:"James Rodriguez",description:"Governs authentication, authorization, and rate limiting for all API endpoints. Requires OAuth 2.0 with PKCE for external consumers.",enforcementMode:"enforce"},{id:"pol-3",name:"Data Retention",scope:"All Data Stores",status:"active",lastUpdated:"2026-02-10",owner:"Sarah Kim",description:"Defines retention periods by data classification. PII: 2 years. Financial: 7 years. Logs: 90 days. Automated purge pipelines enforced.",enforcementMode:"warn"},{id:"pol-4",name:"Incident Response",scope:"Security Operations",status:"draft",lastUpdated:"2026-02-20",owner:"Alex Thompson",description:"Playbook for security incident triage, escalation, containment, and post-mortem. Includes SLA targets: P1 < 15min acknowledgment, P2 < 1hr.",enforcementMode:"audit"},{id:"pol-5",name:"Password Policy",scope:"All User Accounts",status:"active",lastUpdated:"2026-01-28",owner:"Maria Chen",description:"Minimum 12 characters, must include uppercase, lowercase, digit, and special character. 90-day rotation. No reuse of last 12 passwords. MFA required for admin roles.",enforcementMode:"enforce"},{id:"pol-6",name:"Network Segmentation",scope:"Infrastructure & Cloud",status:"active",lastUpdated:"2026-02-05",owner:"David Park",description:"Enforces zero-trust network architecture. All inter-service communication via mTLS. DMZ isolation for public-facing services. VPC peering rules strictly controlled.",enforcementMode:"enforce"},{id:"pol-7",name:"Vendor Risk Assessment",scope:"Third-Party Integrations",status:"deprecated",lastUpdated:"2025-12-15",owner:"Sarah Kim",description:"Legacy vendor assessment framework. Superseded by automated continuous monitoring. Retained for audit trail purposes only.",enforcementMode:"audit"}],z=[{id:"rule-1",name:"Block Non-EU Data Transfer",policyId:"pol-1",priority:1,condition:{eventType:"data.transfer",sourceIpRange:"0.0.0.0/0",userRole:"any",timeWindow:"always"},action:"deny",enabled:!0},{id:"rule-2",name:"Rate Limit External API",policyId:"pol-2",priority:2,condition:{eventType:"api.request",sourceIpRange:"0.0.0.0/0",userRole:"external-consumer",timeWindow:"per-minute"},action:"deny",enabled:!0},{id:"rule-3",name:"Require MFA for Admin Actions",policyId:"pol-5",priority:1,condition:{eventType:"auth.privilege-escalation",sourceIpRange:"10.0.0.0/8",userRole:"admin",timeWindow:"always"},action:"require-MFA",enabled:!0},{id:"rule-4",name:"Alert on Anomalous Login",policyId:"pol-5",priority:3,condition:{eventType:"auth.login",sourceIpRange:"0.0.0.0/0",userRole:"any",timeWindow:"outside-business-hours"},action:"alert",enabled:!0},{id:"rule-5",name:"Deny Unencrypted Storage Write",policyId:"pol-3",priority:1,condition:{eventType:"storage.write",sourceIpRange:"10.0.0.0/8",userRole:"service-account",timeWindow:"always"},action:"deny",enabled:!0},{id:"rule-6",name:"Allow Internal Health Checks",policyId:"pol-2",priority:0,condition:{eventType:"api.healthcheck",sourceIpRange:"10.0.0.0/8",userRole:"service-account",timeWindow:"always"},action:"allow",enabled:!0},{id:"rule-7",name:"Alert on PII Access",policyId:"pol-1",priority:2,condition:{eventType:"data.read",sourceIpRange:"0.0.0.0/0",userRole:"analyst",timeWindow:"business-hours"},action:"alert",enabled:!0},{id:"rule-8",name:"Block Deprecated API Versions",policyId:"pol-2",priority:3,condition:{eventType:"api.request.v1",sourceIpRange:"0.0.0.0/0",userRole:"any",timeWindow:"always"},action:"deny",enabled:!1},{id:"rule-9",name:"Require MFA for Vendor Portal",policyId:"pol-7",priority:1,condition:{eventType:"auth.login",sourceIpRange:"0.0.0.0/0",userRole:"vendor",timeWindow:"always"},action:"require-MFA",enabled:!0},{id:"rule-10",name:"Deny Cross-Zone Traffic",policyId:"pol-6",priority:1,condition:{eventType:"network.connection",sourceIpRange:"172.16.0.0/12",userRole:"service-account",timeWindow:"always"},action:"deny",enabled:!0}],I=[{id:"aud-1",timestamp:"2026-02-20 14:32",user:"Alex Thompson",policyName:"Incident Response",field:"status",oldValue:"active",newValue:"draft"},{id:"aud-2",timestamp:"2026-02-18 09:15",user:"Maria Chen",policyName:"GDPR Compliance",field:"description",oldValue:"Ensures GDPR compliance for EU data",newValue:"Ensures all personal data processing complies with GDPR Articles 5-11"},{id:"aud-3",timestamp:"2026-02-15 16:44",user:"James Rodriguez",policyName:"API Access Control",field:"enforcementMode",oldValue:"warn",newValue:"enforce"},{id:"aud-4",timestamp:"2026-02-10 11:20",user:"Sarah Kim",policyName:"Data Retention",field:"scope",oldValue:"Primary Data Stores",newValue:"All Data Stores"},{id:"aud-5",timestamp:"2026-02-05 08:55",user:"David Park",policyName:"Network Segmentation",field:"enforcementMode",oldValue:"audit",newValue:"enforce"},{id:"aud-6",timestamp:"2026-01-28 13:10",user:"Maria Chen",policyName:"Password Policy",field:"description",oldValue:"Minimum 8 characters with complexity requirements",newValue:"Minimum 12 characters with complexity requirements and MFA"},{id:"aud-7",timestamp:"2025-12-15 10:30",user:"Sarah Kim",policyName:"Vendor Risk Assessment",field:"status",oldValue:"active",newValue:"deprecated"}],R={"pol-1":[{description:"Cross-border data transfers without adequacy decision",count:142,severity:"high"},{description:"API calls missing consent verification",count:38,severity:"medium"},{description:"Unclassified data records in EU storage",count:15,severity:"low"}],"pol-2":[{description:"Requests exceeding rate limit threshold",count:2340,severity:"high"},{description:"Deprecated API version calls",count:891,severity:"medium"},{description:"Missing OAuth scope declarations",count:56,severity:"low"}],"pol-3":[{description:"Records past retention deadline",count:18420,severity:"high"},{description:"Unencrypted storage writes pending",count:73,severity:"medium"}],"pol-4":[{description:"Unacknowledged P1 incidents (simulated)",count:0,severity:"low"},{description:"Missing post-mortem reports",count:3,severity:"medium"}],"pol-5":[{description:"Accounts with passwords older than 90 days",count:234,severity:"high"},{description:"Admin accounts without MFA enabled",count:12,severity:"high"},{description:"Accounts using previously-used passwords",count:67,severity:"medium"}],"pol-6":[{description:"Unauthorized cross-zone connections",count:18,severity:"high"},{description:"Services without mTLS certificates",count:4,severity:"medium"}],"pol-7":[{description:"Vendors without current assessment",count:8,severity:"low"}]},v={active:"âœ…",draft:"ðŸ“",deprecated:"âš ï¸"},k={active:"text-emerald-400",draft:"text-amber-400",deprecated:"text-zinc-500"},A={active:"bg-emerald-400/15 text-emerald-400 border-emerald-400/30",draft:"bg-amber-400/15 text-amber-400 border-amber-400/30",deprecated:"bg-zinc-500/15 text-zinc-500 border-zinc-500/30"},C={allow:"âœ…",deny:"âŒ",alert:"ðŸ””","require-MFA":"ðŸ”"},j={audit:"ðŸ‘ï¸",warn:"âš ï¸",enforce:"ðŸ›¡ï¸"},y={audit:"Audit Only",warn:"Warn",enforce:"Enforce"},P={high:"text-rose-400",medium:"text-amber-400",low:"text-zinc-400"},T=[{id:"policies",label:"Policies",emoji:"ðŸ”’"},{id:"rules",label:"Rules",emoji:"ðŸ“‹"},{id:"enforcement",label:"Enforcement",emoji:"ðŸ›¡ï¸"},{id:"audit",label:"Audit Trail",emoji:"ðŸ“œ"}];function w({children:l,className:o}){return e.jsx("span",{className:b("inline-flex items-center gap-1 rounded-full border px-2.5 py-0.5 text-xs font-medium",o),children:l})}function S({policies:l,onUpdate:o}){const[m,u]=x.useState(null),[h,r]=x.useState(null),[d,n]=x.useState({}),a=i=>{r(i.id),n({name:i.name,scope:i.scope,status:i.status,owner:i.owner,description:i.description})},p=i=>{o({...i,...d,lastUpdated:new Date().toISOString().slice(0,10)}),r(null),n({})};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Security Policies"}),e.jsxs("span",{className:"text-sm text-zinc-500",children:[l.filter(i=>i.status==="active").length," active /"," ",l.length," total"]})]}),l.map(i=>{const g=m===i.id,c=h===i.id;return e.jsxs("div",{className:"rounded-lg border border-zinc-800 bg-zinc-900 overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>u(g?null:i.id),className:"w-full px-4 py-3 flex items-center justify-between text-left hover:bg-zinc-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("span",{className:"text-lg flex-shrink-0",children:v[i.status]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-white truncate",children:i.name}),e.jsx("p",{className:"text-xs text-zinc-500 truncate",children:i.scope})]})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[e.jsx(w,{className:A[i.status],children:i.status}),e.jsx("span",{className:"text-xs text-zinc-600",children:i.lastUpdated}),e.jsx("span",{className:"text-zinc-600 text-sm",children:g?"â–²":"â–¼"})]})]}),g&&e.jsx("div",{className:"border-t border-zinc-800 px-4 py-4 space-y-4",children:c?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-zinc-400 mb-1 block",children:"Name"}),e.jsx("input",{type:"text",value:d.name??"",onChange:t=>n(s=>({...s,name:t.target.value})),className:"w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-white placeholder-zinc-600 focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-zinc-400 mb-1 block",children:"Scope"}),e.jsx("input",{type:"text",value:d.scope??"",onChange:t=>n(s=>({...s,scope:t.target.value})),className:"w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-white placeholder-zinc-600 focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-zinc-400 mb-1 block",children:"Owner"}),e.jsx("input",{type:"text",value:d.owner??"",onChange:t=>n(s=>({...s,owner:t.target.value})),className:"w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-white placeholder-zinc-600 focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-zinc-400 mb-1 block",children:"Status"}),e.jsxs("select",{value:d.status??"active",onChange:t=>n(s=>({...s,status:t.target.value})),className:"w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-white focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"deprecated",children:"Deprecated"})]})]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-zinc-400 mb-1 block",children:"Description"}),e.jsx("textarea",{rows:3,value:d.description??"",onChange:t=>n(s=>({...s,description:t.target.value})),className:"w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-white placeholder-zinc-600 focus:outline-none focus:ring-1 focus:ring-indigo-500 resize-none"})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{r(null),n({})},className:"rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-xs text-zinc-300 hover:bg-zinc-700 transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>p(i),className:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs text-white hover:bg-indigo-500 transition-colors",children:"Save Changes"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-zinc-300 leading-relaxed",children:i.description}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-zinc-500",children:"Owner"}),e.jsx("p",{className:"text-zinc-200 mt-0.5",children:i.owner})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-zinc-500",children:"Last Updated"}),e.jsx("p",{className:"text-zinc-200 mt-0.5",children:i.lastUpdated})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-zinc-500",children:"Enforcement"}),e.jsxs("p",{className:"text-zinc-200 mt-0.5",children:[j[i.enforcementMode]," ",y[i.enforcementMode]]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>a(i),className:"rounded-md bg-zinc-800 border border-zinc-700 px-3 py-1.5 text-xs text-zinc-300 hover:bg-zinc-700 hover:text-white transition-colors",children:"âœï¸ Edit Policy"})})]})})]},i.id)})]})}function E({rules:l,policies:o,onAdd:m,onRemove:u,onToggle:h}){var c;const[r,d]=x.useState(!1),[n,a]=x.useState({name:"",policyId:((c=o[0])==null?void 0:c.id)??"",priority:"5",eventType:"",sourceIpRange:"0.0.0.0/0",userRole:"any",timeWindow:"always",action:"deny"}),p=[...l].sort((t,s)=>t.priority-s.priority),i=t=>{var s;return((s=o.find(f=>f.id===t))==null?void 0:s.name)??"Unknown"},g=()=>{var s;if(!n.name.trim()||!n.eventType.trim())return;const t={id:`rule-${Date.now()}`,name:n.name,policyId:n.policyId,priority:parseInt(n.priority,10)||5,condition:{eventType:n.eventType,sourceIpRange:n.sourceIpRange,userRole:n.userRole,timeWindow:n.timeWindow},action:n.action,enabled:!0};m(t),d(!1),a({name:"",policyId:((s=o[0])==null?void 0:s.id)??"",priority:"5",eventType:"",sourceIpRange:"0.0.0.0/0",userRole:"any",timeWindow:"always",action:"deny"})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Rule Engine"}),e.jsx("button",{type:"button",onClick:()=>d(!r),className:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs text-white hover:bg-indigo-500 transition-colors",children:r?"Cancel":"âž• Add Rule"})]}),r&&e.jsxs("div",{className:"rounded-lg border border-indigo-500/30 bg-zinc-900 p-4 space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-indigo-400 mb-2",children:"New Rule"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-zinc-400 mb-1 block",children:"Rule Name"}),e.jsx("input",{type:"text",value:n.name,onChange:t=>a(s=>({...s,name:t.target.value})),placeholder:"e.g., Block Unauthorized Access",className:"w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-white placeholder-zinc-600 focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-zinc-400 mb-1 block",children:"Policy"}),e.jsx("select",{value:n.policyId,onChange:t=>a(s=>({...s,policyId:t.target.value})),className:"w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-white focus:outline-none focus:ring-1 focus:ring-indigo-500",children:o.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-zinc-400 mb-1 block",children:"Event Type"}),e.jsx("input",{type:"text",value:n.eventType,onChange:t=>a(s=>({...s,eventType:t.target.value})),placeholder:"e.g., api.request",className:"w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-white placeholder-zinc-600 focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-zinc-400 mb-1 block",children:"Source IP Range"}),e.jsx("input",{type:"text",value:n.sourceIpRange,onChange:t=>a(s=>({...s,sourceIpRange:t.target.value})),className:"w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-white placeholder-zinc-600 focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-zinc-400 mb-1 block",children:"User Role"}),e.jsx("input",{type:"text",value:n.userRole,onChange:t=>a(s=>({...s,userRole:t.target.value})),className:"w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-white placeholder-zinc-600 focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-zinc-400 mb-1 block",children:"Time Window"}),e.jsxs("select",{value:n.timeWindow,onChange:t=>a(s=>({...s,timeWindow:t.target.value})),className:"w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-white focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[e.jsx("option",{value:"always",children:"Always"}),e.jsx("option",{value:"business-hours",children:"Business Hours"}),e.jsx("option",{value:"outside-business-hours",children:"Outside Business Hours"}),e.jsx("option",{value:"per-minute",children:"Per Minute"})]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-zinc-400 mb-1 block",children:"Priority (lower = higher)"}),e.jsx("input",{type:"number",value:n.priority,onChange:t=>a(s=>({...s,priority:t.target.value})),min:"0",max:"99",className:"w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-white focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-zinc-400 mb-1 block",children:"Action"}),e.jsxs("select",{value:n.action,onChange:t=>a(s=>({...s,action:t.target.value})),className:"w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-white focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[e.jsx("option",{value:"allow",children:"Allow"}),e.jsx("option",{value:"deny",children:"Deny"}),e.jsx("option",{value:"alert",children:"Alert"}),e.jsx("option",{value:"require-MFA",children:"Require MFA"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:g,className:"rounded-md bg-indigo-600 px-4 py-1.5 text-xs text-white hover:bg-indigo-500 transition-colors",children:"Create Rule"})})]}),e.jsx("div",{className:"space-y-2",children:p.map((t,s)=>e.jsx("div",{className:b("rounded-lg border bg-zinc-900 p-3",t.enabled?"border-zinc-800":"border-zinc-800/50 opacity-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 min-w-0",children:[e.jsx("span",{className:"flex-shrink-0 mt-0.5 w-6 h-6 rounded bg-zinc-800 text-zinc-400 text-xs font-mono flex items-center justify-center",children:t.priority}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:t.name}),e.jsxs(w,{className:b("text-[10px]",t.action==="allow"?"bg-emerald-400/15 text-emerald-400 border-emerald-400/30":t.action==="deny"?"bg-rose-400/15 text-rose-400 border-rose-400/30":t.action==="alert"?"bg-amber-400/15 text-amber-400 border-amber-400/30":"bg-indigo-400/15 text-indigo-400 border-indigo-400/30"),children:[C[t.action]," ",t.action]})]}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-1",children:["Policy: ",i(t.policyId)]}),e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 mt-2 text-xs text-zinc-400",children:[e.jsxs("span",{children:[e.jsx("span",{className:"text-zinc-600",children:"Event:"})," ",e.jsx("span",{className:"font-mono text-zinc-300",children:t.condition.eventType})]}),e.jsxs("span",{children:[e.jsx("span",{className:"text-zinc-600",children:"IP:"})," ",e.jsx("span",{className:"font-mono text-zinc-300",children:t.condition.sourceIpRange})]}),e.jsxs("span",{children:[e.jsx("span",{className:"text-zinc-600",children:"Role:"})," ",e.jsx("span",{className:"text-zinc-300",children:t.condition.userRole})]}),e.jsxs("span",{children:[e.jsx("span",{className:"text-zinc-600",children:"Window:"})," ",e.jsx("span",{className:"text-zinc-300",children:t.condition.timeWindow})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>h(t.id),className:b("rounded px-2 py-1 text-xs transition-colors",t.enabled?"bg-emerald-400/15 text-emerald-400 hover:bg-emerald-400/25":"bg-zinc-800 text-zinc-500 hover:bg-zinc-700"),children:t.enabled?"ON":"OFF"}),e.jsx("button",{type:"button",onClick:()=>u(t.id),className:"rounded px-2 py-1 text-xs bg-rose-400/10 text-rose-400 hover:bg-rose-400/20 transition-colors",children:"ðŸ—‘ï¸"})]})]})},t.id))}),p.length===0&&e.jsx("div",{className:"text-center py-8 text-zinc-600 text-sm",children:"No rules configured. Add one to get started."})]})}function M({policies:l,onModeChange:o}){const[m,u]=x.useState(null),h=["audit","warn","enforce"];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Enforcement Settings"}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Configure enforcement mode per policy and preview potential impact"})]}),l.map(r=>{const d=R[r.id]??[],n=m===r.id;return e.jsxs("div",{className:"rounded-lg border border-zinc-800 bg-zinc-900 p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:k[r.status],children:v[r.status]}),e.jsx("span",{className:"text-sm font-medium text-white",children:r.name})]}),e.jsx("button",{type:"button",onClick:()=>u(n?null:r.id),className:"text-xs text-indigo-400 hover:text-indigo-300 transition-colors",children:n?"Hide Impact":"Preview Impact"})]}),e.jsx("div",{className:"flex gap-2",children:h.map(a=>e.jsxs("button",{type:"button",onClick:()=>o(r.id,a),className:b("flex-1 rounded-md border px-3 py-2 text-xs font-medium transition-colors",r.enforcementMode===a?a==="enforce"?"border-indigo-500 bg-indigo-500/20 text-indigo-300":a==="warn"?"border-amber-500 bg-amber-500/20 text-amber-300":"border-zinc-600 bg-zinc-700/50 text-zinc-300":"border-zinc-700 bg-zinc-800 text-zinc-500 hover:bg-zinc-700 hover:text-zinc-300"),children:[j[a]," ",y[a]]},a))}),n&&d.length>0&&e.jsxs("div",{className:"border-t border-zinc-800 pt-3 space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-zinc-400 mb-2",children:"âš¡ Impact Preview â€” What would be affected"}),d.map((a,p)=>e.jsxs("div",{className:"flex items-center justify-between rounded-md bg-zinc-800/50 px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:b("text-xs font-medium uppercase tracking-wider flex-shrink-0",P[a.severity]),children:a.severity}),e.jsx("span",{className:"text-xs text-zinc-300 truncate",children:a.description})]}),e.jsx("span",{className:"text-xs font-mono text-zinc-400 flex-shrink-0 ml-2",children:a.count.toLocaleString()})]},p)),e.jsxs("p",{className:"text-[10px] text-zinc-600 mt-1",children:["Counts represent events in the last 30 days that would be affected under"," ",e.jsx("span",{className:"text-zinc-500",children:"enforce"})," mode."]})]})]},r.id)})]})}function D({entries:l}){return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Audit Trail"}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Chronological log of all policy changes"})]}),e.jsxs("div",{className:"rounded-lg border border-zinc-800 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-[120px_120px_1fr_100px_1fr_1fr] gap-px bg-zinc-800",children:[e.jsx("div",{className:"bg-zinc-900 px-3 py-2 text-[10px] font-medium uppercase tracking-wider text-zinc-500",children:"Timestamp"}),e.jsx("div",{className:"bg-zinc-900 px-3 py-2 text-[10px] font-medium uppercase tracking-wider text-zinc-500",children:"User"}),e.jsx("div",{className:"bg-zinc-900 px-3 py-2 text-[10px] font-medium uppercase tracking-wider text-zinc-500",children:"Policy"}),e.jsx("div",{className:"bg-zinc-900 px-3 py-2 text-[10px] font-medium uppercase tracking-wider text-zinc-500",children:"Field"}),e.jsx("div",{className:"bg-zinc-900 px-3 py-2 text-[10px] font-medium uppercase tracking-wider text-zinc-500",children:"Old Value"}),e.jsx("div",{className:"bg-zinc-900 px-3 py-2 text-[10px] font-medium uppercase tracking-wider text-zinc-500",children:"New Value"})]}),l.map(o=>e.jsxs("div",{className:"grid grid-cols-[120px_120px_1fr_100px_1fr_1fr] gap-px bg-zinc-800",children:[e.jsx("div",{className:"bg-zinc-900 px-3 py-2.5 text-xs font-mono text-zinc-500",children:o.timestamp}),e.jsx("div",{className:"bg-zinc-900 px-3 py-2.5 text-xs text-zinc-300",children:o.user}),e.jsx("div",{className:"bg-zinc-900 px-3 py-2.5 text-xs text-white font-medium",children:o.policyName}),e.jsx("div",{className:"bg-zinc-900 px-3 py-2.5",children:e.jsx("span",{className:"rounded bg-zinc-800 px-1.5 py-0.5 text-[10px] font-mono text-zinc-400",children:o.field})}),e.jsx("div",{className:"bg-zinc-900 px-3 py-2.5 text-xs text-rose-400/80 line-through truncate",children:o.oldValue}),e.jsx("div",{className:"bg-zinc-900 px-3 py-2.5 text-xs text-emerald-400 truncate",children:o.newValue})]},o.id))]}),e.jsxs("p",{className:"text-[10px] text-zinc-600 text-right",children:["Showing ",l.length," entries"]})]})}function V(){const[l,o]=x.useState("policies"),[m,u]=x.useState(N),[h,r]=x.useState(z),[d]=x.useState(I),n=c=>{u(t=>t.map(s=>s.id===c.id?c:s))},a=(c,t)=>{u(s=>s.map(f=>f.id===c?{...f,enforcementMode:t}:f))},p=c=>{r(t=>[...t,c])},i=c=>{r(t=>t.filter(s=>s.id!==c))},g=c=>{r(t=>t.map(s=>s.id===c?{...s,enabled:!s.enabled}:s))};return e.jsx("div",{className:"min-h-screen bg-zinc-950 text-white",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ”’"}),e.jsx("h1",{className:"text-2xl font-bold text-white tracking-tight",children:"Security Policy Editor"})]}),e.jsx("p",{className:"text-sm text-zinc-500 ml-10",children:"Manage security policies, rules, enforcement, and audit trail"})]}),e.jsx("div",{className:"flex gap-1 mb-6 rounded-lg bg-zinc-900 p-1 border border-zinc-800",children:T.map(c=>e.jsxs("button",{type:"button",onClick:()=>o(c.id),className:b("flex-1 rounded-md px-4 py-2.5 text-sm font-medium transition-colors",l===c.id?"bg-indigo-600 text-white shadow-sm":"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800"),children:[c.emoji," ",c.label]},c.id))}),e.jsxs("div",{children:[l==="policies"&&e.jsx(S,{policies:m,onUpdate:n}),l==="rules"&&e.jsx(E,{rules:h,policies:m,onAdd:p,onRemove:i,onToggle:g}),l==="enforcement"&&e.jsx(M,{policies:m,onModeChange:a}),l==="audit"&&e.jsx(D,{entries:d})]})]})})}export{V as default};
