import{r as u,j as e,c as i}from"./index-BuITcl8D.js";const f={running:"bg-blue-500/20 text-blue-300 border border-blue-500/30",completed:"bg-emerald-500/20 text-emerald-300 border border-emerald-500/30",failed:"bg-rose-500/20 text-rose-300 border border-rose-500/30",scheduled:"bg-amber-500/20 text-amber-300 border border-amber-500/30"},b={critical:"text-rose-400",high:"text-orange-400",medium:"text-amber-400",low:"text-blue-400",info:"text-zinc-400"},d={critical:"bg-rose-500/20 text-rose-300 border border-rose-500/30",high:"bg-orange-500/20 text-orange-300 border border-orange-500/30",medium:"bg-amber-500/20 text-amber-300 border border-amber-500/30",low:"bg-blue-500/20 text-blue-300 border border-blue-500/30",info:"bg-zinc-500/20 text-zinc-400 border border-zinc-500/30"},A={critical:"bg-rose-500",high:"bg-orange-500",medium:"bg-amber-500",low:"bg-blue-500",info:"bg-zinc-500"},j={sast:"SAST",dast:"DAST",sca:"SCA",container:"Container",iac:"IaC"},N={sast:"bg-indigo-500/20 text-indigo-300 border border-indigo-500/30",dast:"bg-purple-500/20 text-purple-300 border border-purple-500/30",sca:"bg-cyan-500/20 text-cyan-300 border border-cyan-500/30",container:"bg-teal-500/20 text-teal-300 border border-teal-500/30",iac:"bg-sky-500/20 text-sky-300 border border-sky-500/30"},h={injection:"ðŸ’‰",auth:"ðŸ”‘",exposure:"ðŸ‘ï¸",misconfiguration:"âš™ï¸",dependency:"ðŸ“¦",crypto:"ðŸ”’"},y={open:"bg-rose-500/20 text-rose-300 border border-rose-500/30",acknowledged:"bg-amber-500/20 text-amber-300 border border-amber-500/30",fixed:"bg-emerald-500/20 text-emerald-300 border border-emerald-500/30",false_positive:"bg-zinc-500/20 text-zinc-400 border border-zinc-500/30"},o=[{id:"scan-001",name:"API Server SAST",type:"sast",target:"src/api/**/*.ts",status:"completed",startedAt:"2026-02-22T08:00:00Z",completedAt:"2026-02-22T08:12:34Z",duration:754,coverage:94,vulnCount:{critical:2,high:5,medium:11,low:8,info:3},vulnerabilities:[{id:"v-001",title:"SQL Injection via unsanitized query parameter",severity:"critical",category:"injection",file:"src/api/users/search.ts",line:47,description:"User-controlled input passed directly to database query without parameterization.",recommendation:"Use parameterized queries or prepared statements. Never interpolate user input directly.",cveId:null,cvssScore:9.8,status:"open",firstSeen:"2026-02-22",lastSeen:"2026-02-22"},{id:"v-002",title:"JWT secret hardcoded in source",severity:"critical",category:"crypto",file:"src/api/auth/tokens.ts",line:12,description:"JWT signing secret is hardcoded as a string literal in source code.",recommendation:"Load secrets from environment variables or a secrets manager. Rotate the exposed secret immediately.",cveId:null,cvssScore:9.1,status:"acknowledged",firstSeen:"2026-02-20",lastSeen:"2026-02-22"},{id:"v-003",title:"Missing rate limiting on auth endpoint",severity:"high",category:"auth",file:"src/api/auth/login.ts",line:23,description:"Login endpoint has no rate limiting, enabling brute-force attacks.",recommendation:"Implement rate limiting with exponential backoff. Consider account lockout after N failures.",cveId:null,cvssScore:7.5,status:"open",firstSeen:"2026-02-21",lastSeen:"2026-02-22"},{id:"v-004",title:"Sensitive data in error response",severity:"medium",category:"exposure",file:"src/api/middleware/error.ts",line:89,description:"Stack traces and internal paths exposed in production error responses.",recommendation:"Return generic error messages in production. Log detailed errors server-side only.",cveId:null,cvssScore:5.3,status:"fixed",firstSeen:"2026-02-18",lastSeen:"2026-02-21"}]},{id:"scan-002",name:"Frontend DAST Scan",type:"dast",target:"https://staging.clawdbot.io",status:"completed",startedAt:"2026-02-22T09:00:00Z",completedAt:"2026-02-22T09:45:12Z",duration:2712,coverage:78,vulnCount:{critical:0,high:3,medium:7,low:12,info:6},vulnerabilities:[{id:"v-005",title:"Cross-Site Scripting (XSS) in search field",severity:"high",category:"injection",file:"src/components/GlobalSearch.tsx",line:134,description:"User input reflected in DOM without sanitization, enabling stored XSS.",recommendation:"Sanitize all user input before rendering. Use DOMPurify for HTML content.",cveId:"CVE-2024-1234",cvssScore:7.2,status:"open",firstSeen:"2026-02-22",lastSeen:"2026-02-22"},{id:"v-006",title:"Missing Content-Security-Policy header",severity:"medium",category:"misconfiguration",file:"nginx.conf",line:28,description:"CSP header not configured, increasing XSS risk surface.",recommendation:"Configure a strict Content-Security-Policy header. Start with report-only mode.",cveId:null,cvssScore:5.1,status:"open",firstSeen:"2026-02-19",lastSeen:"2026-02-22"}]},{id:"scan-003",name:"Dependency Audit",type:"sca",target:"package.json",status:"completed",startedAt:"2026-02-22T07:00:00Z",completedAt:"2026-02-22T07:03:22Z",duration:202,coverage:100,vulnCount:{critical:1,high:2,medium:4,low:6,info:0},vulnerabilities:[{id:"v-007",title:"Prototype pollution in lodash@4.17.20",severity:"critical",category:"dependency",file:"package.json",line:34,description:"lodash versions before 4.17.21 are vulnerable to prototype pollution via merge operations.",recommendation:"Upgrade lodash to 4.17.21 or later.",cveId:"CVE-2021-23337",cvssScore:9,status:"open",firstSeen:"2026-02-15",lastSeen:"2026-02-22"}]},{id:"scan-004",name:"Container Image Scan",type:"container",target:"clawdbot-api:latest",status:"running",startedAt:"2026-02-22T10:00:00Z",completedAt:null,duration:null,coverage:0,vulnCount:{critical:0,high:0,medium:0,low:0,info:0},vulnerabilities:[]},{id:"scan-005",name:"Terraform IaC Scan",type:"iac",target:"infra/terraform/**",status:"scheduled",startedAt:"2026-02-22T12:00:00Z",completedAt:null,duration:null,coverage:0,vulnCount:{critical:0,high:0,medium:0,low:0,info:0},vulnerabilities:[]}],I=[{id:"r-01",name:"SQL Injection Detection",description:"Detects unsanitized SQL query construction",severity:"critical",category:"injection",enabled:!0,occurrences:3},{id:"r-02",name:"Hardcoded Secrets",description:"Finds hardcoded passwords, tokens, API keys",severity:"critical",category:"crypto",enabled:!0,occurrences:1},{id:"r-03",name:"XSS Vulnerability",description:"Identifies cross-site scripting attack vectors",severity:"high",category:"injection",enabled:!0,occurrences:5},{id:"r-04",name:"Missing Auth Check",description:"Flags endpoints lacking authentication middleware",severity:"high",category:"auth",enabled:!0,occurrences:2},{id:"r-05",name:"Sensitive Data Exposure",description:"Detects PII/secrets in logs or responses",severity:"medium",category:"exposure",enabled:!0,occurrences:8},{id:"r-06",name:"Outdated Dependencies",description:"Flags packages with known CVEs",severity:"medium",category:"dependency",enabled:!0,occurrences:13},{id:"r-07",name:"Weak Crypto Algorithm",description:"Detects use of MD5, SHA1, DES in security contexts",severity:"medium",category:"crypto",enabled:!1,occurrences:0},{id:"r-08",name:"IaC Public Exposure",description:"Flags S3 buckets, RDS, EC2 with public access",severity:"high",category:"misconfiguration",enabled:!0,occurrences:4}],l=[{date:"Feb 15",critical:8,high:14,medium:22,low:31},{date:"Feb 16",critical:7,high:13,medium:21,low:29},{date:"Feb 17",critical:7,high:12,medium:20,low:27},{date:"Feb 18",critical:6,high:11,medium:19,low:25},{date:"Feb 19",critical:5,high:10,medium:18,low:26},{date:"Feb 20",critical:5,high:9,medium:16,low:24},{date:"Feb 21",critical:4,high:8,medium:15,low:22},{date:"Feb 22",critical:3,high:10,medium:22,low:26}],S=Math.max(...l.map(r=>r.critical+r.high+r.medium+r.low));function D(){const[r,z]=u.useState("scans"),[n,w]=u.useState(o[0]),[t,C]=u.useState(o[0].vulnerabilities[0]),[m,g]=u.useState("all"),x=o.flatMap(s=>s.vulnerabilities),v=m==="all"?x:x.filter(s=>s.severity===m),k=o.reduce((s,a)=>(s.critical+=a.vulnCount.critical,s.high+=a.vulnCount.high,s.medium+=a.vulnCount.medium,s.low+=a.vulnCount.low,s),{critical:0,high:0,medium:0,low:0});return e.jsxs("div",{className:"flex flex-col h-full bg-zinc-950 text-white",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-zinc-800 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Security Scanner"}),e.jsx("p",{className:"text-sm text-zinc-400 mt-0.5",children:"SAST Â· DAST Â· SCA Â· Container Â· IaC"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center gap-3 text-sm",children:["critical","high","medium","low"].map(s=>e.jsxs("span",{className:i("flex items-center gap-1.5",b[s]),children:[e.jsx("span",{className:i("w-2 h-2 rounded-full",A[s])}),e.jsx("span",{className:"font-mono font-bold",children:k[s]}),e.jsx("span",{className:"text-zinc-500 capitalize",children:s})]},s))}),e.jsx("button",{className:"px-3 py-1.5 bg-indigo-600 hover:bg-indigo-500 rounded text-sm font-medium transition-colors",children:"+ New Scan"})]})]}),e.jsx("div",{className:"flex border-b border-zinc-800 px-6",children:["scans","vulnerabilities","policies","trend"].map(s=>e.jsx("button",{onClick:()=>z(s),className:i("px-4 py-3 text-sm font-medium border-b-2 transition-colors capitalize",r===s?"border-indigo-500 text-white":"border-transparent text-zinc-400 hover:text-zinc-200"),children:s},s))}),r==="scans"&&e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsx("div",{className:"w-80 border-r border-zinc-800 overflow-y-auto",children:o.map(s=>e.jsxs("button",{onClick:()=>w(s),className:i("w-full text-left px-4 py-3 border-b border-zinc-800/60 hover:bg-zinc-800/40 transition-colors",n.id===s.id&&"bg-zinc-800/60"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1.5",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:s.name}),e.jsx("span",{className:i("text-xs px-1.5 py-0.5 rounded-full whitespace-nowrap",f[s.status]),children:s.status})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:i("text-xs px-1.5 py-0.5 rounded",N[s.type]),children:j[s.type]}),e.jsx("span",{className:"text-xs text-zinc-500 truncate",children:s.target})]}),s.status==="completed"&&e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[s.vulnCount.critical>0&&e.jsxs("span",{className:"text-rose-400",children:["â—",s.vulnCount.critical," crit"]}),s.vulnCount.high>0&&e.jsxs("span",{className:"text-orange-400",children:["â—",s.vulnCount.high," high"]}),s.vulnCount.medium>0&&e.jsxs("span",{className:"text-amber-400",children:["â—",s.vulnCount.medium," med"]})]})]},s.id))}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-1",children:n.name}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:i("text-xs px-2 py-0.5 rounded",N[n.type]),children:j[n.type]}),e.jsx("span",{className:i("text-xs px-2 py-0.5 rounded-full",f[n.status]),children:n.status}),e.jsx("span",{className:"text-sm text-zinc-400 font-mono",children:n.target})]})]}),n.status==="completed"&&e.jsxs("div",{className:"text-right text-sm",children:[e.jsx("div",{className:"text-zinc-400",children:"Duration"}),e.jsxs("div",{className:"font-mono text-white",children:[Math.floor((n.duration??0)/60),"m ",(n.duration??0)%60,"s"]})]})]}),n.status==="completed"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-5 gap-3 mb-6",children:["critical","high","medium","low","info"].map(s=>e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-3 text-center",children:[e.jsx("div",{className:i("text-2xl font-bold font-mono mb-1",b[s]),children:n.vulnCount[s]}),e.jsx("div",{className:"text-xs text-zinc-500 capitalize",children:s})]},s))}),e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Code Coverage"}),e.jsxs("span",{className:"text-sm font-mono text-emerald-400",children:[n.coverage,"%"]})]}),e.jsx("div",{className:"w-full bg-zinc-800 rounded-full h-2",children:e.jsx("div",{className:"bg-emerald-500 h-2 rounded-full",style:{width:`${n.coverage}%`}})})]}),n.vulnerabilities.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-300 mb-3",children:"Vulnerabilities"}),e.jsx("div",{className:"space-y-2",children:n.vulnerabilities.map(s=>e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:h[s.category]}),e.jsx("span",{className:"text-sm font-medium",children:s.title})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("span",{className:i("text-xs px-1.5 py-0.5 rounded-full",d[s.severity]),children:s.severity}),e.jsx("span",{className:i("text-xs px-1.5 py-0.5 rounded-full",y[s.status]),children:s.status.replace("_"," ")})]})]}),e.jsxs("div",{className:"text-xs font-mono text-zinc-400 mb-2",children:[s.file,":",s.line]}),e.jsx("p",{className:"text-xs text-zinc-400 mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-zinc-500",children:[s.cveId&&e.jsx("span",{className:"text-amber-400",children:s.cveId}),s.cvssScore!==null&&e.jsxs("span",{children:["CVSS ",s.cvssScore]}),e.jsxs("span",{children:["First seen ",s.firstSeen]})]})]},s.id))})]}),n.vulnerabilities.length===0&&e.jsx("div",{className:"text-center py-12 text-zinc-500",children:"No vulnerabilities found in this scan"})]}),n.status==="running"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-2xl mb-3 animate-pulse",children:"ðŸ”"}),e.jsx("div",{className:"text-zinc-300 font-medium mb-1",children:"Scan in progress"}),e.jsxs("div",{className:"text-sm text-zinc-500",children:["Started at ",new Date(n.startedAt).toLocaleTimeString()]})]}),n.status==="scheduled"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-2xl mb-3",children:"ðŸ•"}),e.jsx("div",{className:"text-zinc-300 font-medium mb-1",children:"Scan scheduled"}),e.jsxs("div",{className:"text-sm text-zinc-500",children:["Starts at ",new Date(n.startedAt).toLocaleTimeString()]})]})]})]}),r==="vulnerabilities"&&e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("div",{className:"w-80 border-r border-zinc-800 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-800",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-2",children:"Filter by severity"}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[e.jsxs("button",{onClick:()=>g("all"),className:i("text-xs px-2 py-1 rounded-full border transition-colors",m==="all"?"bg-zinc-700 border-zinc-500 text-white":"border-zinc-700 text-zinc-400 hover:border-zinc-500"),children:["All (",x.length,")"]}),["critical","high","medium","low"].map(s=>e.jsxs("button",{onClick:()=>g(s),className:i("text-xs px-2 py-1 rounded-full border transition-colors capitalize",m===s?d[s]:"border-zinc-700 text-zinc-400 hover:border-zinc-500"),children:[s," (",x.filter(a=>a.severity===s).length,")"]},s))]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[v.map(s=>e.jsxs("button",{onClick:()=>C(s),className:i("w-full text-left px-4 py-3 border-b border-zinc-800/60 hover:bg-zinc-800/40 transition-colors",(t==null?void 0:t.id)===s.id&&"bg-zinc-800/60"),children:[e.jsxs("div",{className:"flex items-start gap-2 mb-1",children:[e.jsx("span",{className:"text-sm",children:h[s.category]}),e.jsx("span",{className:"text-xs font-medium text-white leading-snug",children:s.title})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-5",children:[e.jsx("span",{className:i("text-xs px-1.5 py-0.5 rounded-full",d[s.severity]),children:s.severity}),e.jsx("span",{className:"text-xs text-zinc-500 font-mono",children:s.file.split("/").pop()})]})]},s.id)),v.length===0&&e.jsx("div",{className:"text-center py-8 text-zinc-500 text-sm",children:"No vulnerabilities match filter"})]})]}),t&&e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xl",children:h[t.category]}),e.jsx("h2",{className:"text-lg font-semibold",children:t.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:i("text-xs px-2 py-0.5 rounded-full",d[t.severity]),children:t.severity}),e.jsx("span",{className:i("text-xs px-2 py-0.5 rounded-full",y[t.status]),children:t.status.replace("_"," ")}),t.cveId&&e.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-amber-500/10 text-amber-300 border border-amber-500/30",children:t.cveId})]})]}),t.cvssScore!==null&&e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-3 text-center",children:[e.jsx("div",{className:i("text-2xl font-bold font-mono",t.cvssScore>=9?"text-rose-400":t.cvssScore>=7?"text-orange-400":"text-amber-400"),children:t.cvssScore}),e.jsx("div",{className:"text-xs text-zinc-500",children:"CVSS"})]})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-4 mb-4",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Location"}),e.jsxs("div",{className:"font-mono text-sm text-white",children:[t.file,e.jsxs("span",{className:"text-zinc-500",children:[":",t.line]})]})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-4 mb-4",children:[e.jsx("div",{className:"text-sm font-medium mb-2 text-zinc-300",children:"Description"}),e.jsx("p",{className:"text-sm text-zinc-400 leading-relaxed",children:t.description})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-4 mb-4 border border-indigo-500/20",children:[e.jsx("div",{className:"text-sm font-medium mb-2 text-indigo-300",children:"Recommendation"}),e.jsx("p",{className:"text-sm text-zinc-400 leading-relaxed",children:t.recommendation})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"First Seen"}),e.jsx("div",{className:"text-white",children:t.firstSeen})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-zinc-500 mb-1",children:"Last Seen"}),e.jsx("div",{className:"text-white",children:t.lastSeen})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx("button",{className:"flex-1 py-2 bg-zinc-800 hover:bg-zinc-700 rounded text-sm transition-colors",children:"Mark Acknowledged"}),e.jsx("button",{className:"flex-1 py-2 bg-zinc-800 hover:bg-zinc-700 rounded text-sm transition-colors",children:"Mark Fixed"}),e.jsx("button",{className:"flex-1 py-2 bg-zinc-800 hover:bg-zinc-700 rounded text-sm transition-colors",children:"False Positive"})]})]})]}),r==="policies"&&e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-semibold",children:"Scan Policies"}),e.jsx("p",{className:"text-sm text-zinc-400 mt-0.5",children:"Rules applied across all scan types"})]}),e.jsx("button",{className:"px-3 py-1.5 bg-indigo-600 hover:bg-indigo-500 rounded text-sm font-medium transition-colors",children:"+ Add Rule"})]}),e.jsx("div",{className:"space-y-2",children:I.map(s=>e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-4 flex items-center gap-4",children:[e.jsx("div",{className:"text-lg",children:h[s.category]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:s.name}),e.jsx("span",{className:i("text-xs px-1.5 py-0.5 rounded-full",d[s.severity]),children:s.severity})]}),e.jsx("div",{className:"text-xs text-zinc-400",children:s.description})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold font-mono text-white",children:s.occurrences}),e.jsx("div",{className:"text-xs text-zinc-500",children:"findings"})]}),e.jsx("div",{className:i("text-xs px-2 py-1 rounded font-medium",s.enabled?"bg-emerald-500/20 text-emerald-300":"bg-zinc-700 text-zinc-400"),children:s.enabled?"Enabled":"Disabled"})]},s.id))})]}),r==="trend"&&e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsx("h2",{className:"text-base font-semibold mb-1",children:"Vulnerability Trend"}),e.jsx("p",{className:"text-sm text-zinc-400 mb-6",children:"Open vulnerabilities over time"}),e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-6",children:[e.jsx("div",{className:"flex items-end gap-2 h-48 mb-3",children:l.map(s=>{const a=s.critical+s.high+s.medium+s.low,p=S>0?a/S*100:0;return e.jsx("div",{className:"flex-1 flex flex-col items-center gap-1",children:e.jsxs("div",{className:"w-full flex flex-col-reverse rounded overflow-hidden",style:{height:`${p}%`,minHeight:"4px"},children:[e.jsx("div",{className:"bg-rose-500",style:{flex:s.critical}}),e.jsx("div",{className:"bg-orange-500",style:{flex:s.high}}),e.jsx("div",{className:"bg-amber-500",style:{flex:s.medium}}),e.jsx("div",{className:"bg-blue-500",style:{flex:s.low}})]})},s.date)})}),e.jsx("div",{className:"flex items-end gap-2 mb-4",children:l.map(s=>e.jsx("div",{className:"flex-1 text-center text-xs text-zinc-500",children:s.date.replace("Feb ","")},s.date))}),e.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-sm bg-rose-500"}),e.jsx("span",{className:"text-zinc-400",children:"Critical"})]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-sm bg-orange-500"}),e.jsx("span",{className:"text-zinc-400",children:"High"})]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-sm bg-amber-500"}),e.jsx("span",{className:"text-zinc-400",children:"Medium"})]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-sm bg-blue-500"}),e.jsx("span",{className:"text-zinc-400",children:"Low"})]})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4 mt-6",children:["critical","high","medium","low"].map(s=>{const a=l[l.length-1][s],p=l[l.length-2][s],c=a-p;return e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-4 text-center",children:[e.jsx("div",{className:i("text-3xl font-bold font-mono mb-1",b[s]),children:a}),e.jsx("div",{className:"text-xs text-zinc-500 capitalize mb-2",children:s}),e.jsxs("div",{className:i("text-xs font-medium",c>0?"text-rose-400":c<0?"text-emerald-400":"text-zinc-400"),children:[c>0?"â–²":c<0?"â–¼":"â€”"," ",Math.abs(c)," vs yesterday"]})]},s)})})]})]})}export{D as default};
