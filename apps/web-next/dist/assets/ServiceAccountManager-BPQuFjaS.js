import{r as m,j as e,c as i}from"./index-Buf38RO5.js";const n=[{id:"sa1",name:"sa-api-gateway",displayName:"API Gateway",status:"active",description:"Service account for the main API gateway to access internal services",team:"Platform",roles:["api:read","api:write","metrics:read"],rotationPolicy:"90d",createdAt:"2025-08-15",lastActivity:"2026-02-22T14:28:00Z",requestsLast30d:84291,keys:[{id:"k1a",name:"Production Key",prefix:"sak_live_xK9m",status:"active",createdAt:"2025-11-15",expiresAt:"2026-02-13",lastUsed:"2026-02-22T14:28:00Z",usageCount:82913,scopes:["api:read","api:write"]},{id:"k1b",name:"Backup Key",prefix:"sak_live_bP3r",status:"rotating",createdAt:"2026-02-20",expiresAt:"2026-05-20",lastUsed:null,usageCount:0,scopes:["api:read","api:write"]}]},{id:"sa2",name:"sa-data-pipeline",displayName:"Data Pipeline",status:"active",description:"ETL pipeline service account for reading and writing to data stores",team:"Data Engineering",roles:["data:read","data:write","storage:read","storage:write"],rotationPolicy:"60d",createdAt:"2025-07-01",lastActivity:"2026-02-22T13:45:00Z",requestsLast30d:31204,keys:[{id:"k2a",name:"ETL Key",prefix:"sak_live_dQ7n",status:"active",createdAt:"2025-12-20",expiresAt:"2026-02-18",lastUsed:"2026-02-22T13:45:00Z",usageCount:31100,scopes:["data:read","data:write","storage:read","storage:write"]}]},{id:"sa3",name:"sa-monitoring",displayName:"Monitoring Agent",status:"active",description:"Scrapes metrics and sends alerts. Read-only access to all services.",team:"SRE",roles:["metrics:read","logs:read","alerts:write"],rotationPolicy:"180d",createdAt:"2025-06-10",lastActivity:"2026-02-22T14:30:00Z",requestsLast30d:129340,keys:[{id:"k3a",name:"Prom Scrape Key",prefix:"sak_live_mX2p",status:"active",createdAt:"2025-09-01",expiresAt:"2026-03-01",lastUsed:"2026-02-22T14:30:00Z",usageCount:128e3,scopes:["metrics:read","logs:read"]}]},{id:"sa4",name:"sa-ci-deployer",displayName:"CI/CD Deployer",status:"active",description:"GitHub Actions service account for deployments to all environments",team:"DevOps",roles:["deploy:write","config:read","secrets:read"],rotationPolicy:"30d",createdAt:"2025-05-20",lastActivity:"2026-02-21T18:00:00Z",requestsLast30d:412,keys:[{id:"k4a",name:"GH Actions Key",prefix:"sak_live_cD5s",status:"active",createdAt:"2026-01-22",expiresAt:"2026-02-22",lastUsed:"2026-02-21T18:00:00Z",usageCount:400,scopes:["deploy:write","config:read"]},{id:"k4b",name:"Old Deploy Key",prefix:"sak_live_oZ8q",status:"revoked",createdAt:"2025-12-01",expiresAt:"2026-01-01",lastUsed:"2025-12-31T23:59:00Z",usageCount:892,scopes:["deploy:write"]}]},{id:"sa5",name:"sa-backup-service",displayName:"Backup Service",status:"inactive",description:"Automated backup service (currently paused for migration)",team:"Platform",roles:["storage:read","storage:write","data:read"],rotationPolicy:"90d",createdAt:"2025-04-12",lastActivity:"2026-01-15T03:00:00Z",requestsLast30d:0,keys:[{id:"k5a",name:"Backup Key",prefix:"sak_live_bkZ1",status:"expired",createdAt:"2025-10-15",expiresAt:"2026-01-15",lastUsed:"2026-01-15T03:00:00Z",usageCount:18e3,scopes:["storage:read","storage:write"]}]}],j=[{id:"a1",action:"key.created",serviceAccount:"sa-api-gateway",keyId:"k1b",actor:"jane@openclaw.io",timestamp:"2026-02-20T09:30:00Z",result:"success",ip:"10.0.1.45"},{id:"a2",action:"key.rotated",serviceAccount:"sa-api-gateway",keyId:"k1a",actor:"system",timestamp:"2026-02-20T09:30:00Z",result:"success",ip:"10.0.0.1"},{id:"a3",action:"key.revoked",serviceAccount:"sa-ci-deployer",keyId:"k4b",actor:"mike@openclaw.io",timestamp:"2026-01-05T14:00:00Z",result:"success",ip:"10.0.2.12"},{id:"a4",action:"sa.suspended",serviceAccount:"sa-backup-service",keyId:"—",actor:"admin@openclaw.io",timestamp:"2026-01-20T11:00:00Z",result:"success",ip:"10.0.1.99"},{id:"a5",action:"key.auth_failed",serviceAccount:"sa-data-pipeline",keyId:"k2a",actor:"system",timestamp:"2026-02-22T08:15:00Z",result:"failure",ip:"203.0.113.42"},{id:"a6",action:"key.created",serviceAccount:"sa-monitoring",keyId:"k3a",actor:"sre@openclaw.io",timestamp:"2025-09-01T10:00:00Z",result:"success",ip:"10.0.1.5"}],N=["Accounts","Keys","Rotation","Audit"],h={active:"text-emerald-400 bg-emerald-400/10 border-emerald-400/30",inactive:"text-zinc-400 bg-zinc-400/10 border-zinc-400/30",suspended:"text-rose-400 bg-rose-400/10 border-rose-400/30"},v={active:"text-emerald-400",expired:"text-amber-400",revoked:"text-rose-400",rotating:"text-indigo-400"},p=r=>{if(!r)return null;const l=new Date("2026-02-22"),a=new Date(r),c=Math.floor((a.getTime()-l.getTime())/864e5);return c<0?"Expired":c<=7?`Expires in ${c}d`:c<=30?`Expires in ${c}d`:null};function y(){const[r,l]=m.useState("Accounts"),[a,c]=m.useState(n[0]),[u,b]=m.useState({}),g=s=>{b(t=>({...t,[s]:!t[s]}))},o=n.flatMap(s=>s.keys.map(t=>({...t,saName:s.displayName,saId:s.id}))),d=o.filter(s=>{if(!s.expiresAt||s.status!=="active")return!1;const t=new Date("2026-02-22");return(new Date(s.expiresAt).getTime()-t.getTime())/864e5<=30});return e.jsxs("div",{className:"h-full flex flex-col bg-zinc-950 text-white overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-zinc-800 shrink-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Service Account Manager"}),e.jsx("p",{className:"text-xs text-zinc-400 mt-0.5",children:"Manage service accounts, API keys, and rotation policies"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[d.length>0&&e.jsxs("div",{className:"text-xs px-2 py-1 rounded bg-amber-400/10 border border-amber-400/30 text-amber-400",children:["⚠ ",d.length," key",d.length>1?"s":""," expiring soon"]}),e.jsx("button",{className:"px-3 py-1.5 text-xs bg-indigo-600 hover:bg-indigo-500 rounded-md transition-colors",children:"+ New Service Account"})]})]}),e.jsx("div",{className:"flex gap-1 px-6 pt-3 border-b border-zinc-800 shrink-0",children:N.map(s=>e.jsx("button",{onClick:()=>l(s),className:i("px-4 py-2 text-sm font-medium rounded-t transition-colors border-b-2 -mb-px",r===s?"text-indigo-400 border-indigo-500":"text-zinc-400 border-transparent hover:text-white"),children:s},s))}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[r==="Accounts"&&e.jsxs("div",{className:"h-full flex",children:[e.jsx("div",{className:"w-64 border-r border-zinc-800 overflow-y-auto",children:n.map(s=>e.jsxs("button",{onClick:()=>c(s),className:i("w-full text-left px-4 py-4 border-b border-zinc-800/50 transition-colors",a.id===s.id?"bg-indigo-600/10":"hover:bg-zinc-800/40"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:s.displayName}),e.jsx("div",{className:i("text-[10px] px-1 py-0.5 rounded border",h[s.status]),children:s.status})]}),e.jsx("div",{className:"text-[10px] text-zinc-500 font-mono mt-1",children:s.name}),e.jsx("div",{className:"text-[10px] text-zinc-400 mt-1",children:s.team})]},s.id))}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-5",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-xl font-bold",children:a.displayName}),e.jsx("span",{className:i("text-xs px-2 py-0.5 rounded border",h[a.status]),children:a.status})]}),e.jsx("div",{className:"text-sm text-zinc-500 font-mono mt-1",children:a.name}),e.jsx("p",{className:"text-sm text-zinc-400 mt-2",children:a.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 text-xs border border-zinc-700 text-zinc-400 hover:border-zinc-600 rounded-md transition-colors",children:"Edit"}),e.jsx("button",{className:"px-3 py-1.5 text-xs border border-rose-500/40 text-rose-400 hover:bg-rose-500/10 rounded-md transition-colors",children:"Suspend"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"Team",value:a.team},{label:"Created",value:a.createdAt},{label:"Rotation Policy",value:a.rotationPolicy},{label:"Requests (30d)",value:a.requestsLast30d.toLocaleString()}].map(s=>e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-zinc-500",children:s.label}),e.jsx("div",{className:"text-sm font-medium mt-1",children:s.value})]},s.label))}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-xs text-zinc-400 font-semibold uppercase tracking-wider mb-3",children:"Roles & Scopes"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.roles.map(s=>e.jsx("span",{className:"text-xs px-2 py-1 rounded bg-zinc-800 border border-zinc-700 text-zinc-300 font-mono",children:s},s))})]}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-b border-zinc-800",children:[e.jsx("div",{className:"text-xs text-zinc-400 font-semibold uppercase tracking-wider",children:"API Keys"}),e.jsx("button",{className:"text-xs text-indigo-400 hover:text-indigo-300",children:"+ Create Key"})]}),e.jsx("div",{className:"divide-y divide-zinc-800",children:a.keys.map(s=>{const t=p(s.expiresAt);return e.jsxs("div",{className:"px-5 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm font-medium",children:s.name}),e.jsx("span",{className:i("text-xs",v[s.status]),children:s.status}),t&&e.jsx("span",{className:i("text-[10px] px-1.5 py-0.5 rounded border",t==="Expired"?"text-rose-400 bg-rose-400/10 border-rose-400/30":"text-amber-400 bg-amber-400/10 border-amber-400/30"),children:t})]}),s.status==="active"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"text-xs text-amber-400 hover:text-amber-300",children:"Rotate"}),e.jsx("button",{className:"text-xs text-rose-400 hover:text-rose-300",children:"Revoke"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs font-mono",children:[e.jsx("span",{className:"text-zinc-300",children:u[s.id]?`${s.prefix}••••••••••••••••••••`:`${s.prefix}••••••••••••••••••••`}),e.jsx("button",{onClick:()=>g(s.id),className:"text-zinc-500 hover:text-zinc-300 text-[10px]",children:u[s.id]?"hide":"reveal"})]}),e.jsxs("div",{className:"flex gap-4 mt-2 text-[10px] text-zinc-500",children:[e.jsxs("span",{children:["Created: ",s.createdAt]}),s.expiresAt&&e.jsxs("span",{children:["Expires: ",s.expiresAt]}),s.lastUsed&&e.jsxs("span",{children:["Last used: ",s.lastUsed.slice(0,10)]}),e.jsxs("span",{children:[s.usageCount.toLocaleString()," requests"]})]}),s.scopes.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:s.scopes.map(x=>e.jsx("span",{className:"text-[10px] px-1 py-0.5 rounded bg-zinc-800 text-zinc-500 font-mono",children:x},x))})]},s.id)})})]})]})]}),r==="Keys"&&e.jsx("div",{className:"h-full overflow-y-auto p-6",children:e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-3 border-b border-zinc-800 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium",children:"All API Keys"}),e.jsxs("span",{className:"text-xs text-zinc-500",children:[o.length," total"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-zinc-800",children:["Key Name","Service Account","Prefix","Status","Expires","Last Used","Requests"].map(s=>e.jsx("th",{className:"px-4 py-2.5 text-left text-xs text-zinc-500 font-medium",children:s},s))})}),e.jsx("tbody",{className:"divide-y divide-zinc-800/50",children:o.map(s=>{const t=p(s.expiresAt);return e.jsxs("tr",{className:"hover:bg-zinc-800/30",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:s.name}),e.jsx("td",{className:"px-4 py-3 text-xs text-zinc-400",children:s.saName}),e.jsxs("td",{className:"px-4 py-3 text-xs font-mono text-zinc-300",children:[s.prefix,"…"]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:i("text-xs",v[s.status]),children:s.status})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-xs",children:s.expiresAt??"—"}),t&&e.jsx("div",{className:i("text-[10px]",t==="Expired"?"text-rose-400":"text-amber-400"),children:t})]}),e.jsx("td",{className:"px-4 py-3 text-xs text-zinc-400",children:s.lastUsed?s.lastUsed.slice(0,10):"—"}),e.jsx("td",{className:"px-4 py-3 text-xs text-zinc-300",children:s.usageCount.toLocaleString()})]},s.id)})})]})})]})}),r==="Rotation"&&e.jsxs("div",{className:"h-full overflow-y-auto p-6 space-y-4",children:[d.length>0&&e.jsxs("div",{className:"bg-amber-400/10 border border-amber-400/30 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm font-medium text-amber-400 mb-2",children:"⚠ Keys requiring attention"}),e.jsx("div",{className:"space-y-1",children:d.map(s=>e.jsxs("div",{className:"text-xs text-zinc-300",children:[e.jsxs("span",{className:"font-mono",children:[s.prefix,"…"]})," (",s.saName,") — ",p(s.expiresAt)]},s.id))})]}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"px-5 py-3 border-b border-zinc-800",children:e.jsx("h3",{className:"text-sm font-medium",children:"Rotation Policies"})}),e.jsx("div",{className:"divide-y divide-zinc-800",children:n.map(s=>e.jsxs("div",{className:"px-5 py-4 flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium",children:s.displayName}),e.jsx("div",{className:"text-xs text-zinc-500 font-mono",children:s.name})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("select",{defaultValue:s.rotationPolicy,className:"bg-zinc-800 border border-zinc-700 rounded px-2 py-1 text-xs text-zinc-300 focus:outline-none focus:border-indigo-500",children:["30d","60d","90d","180d","never"].map(t=>e.jsx("option",{value:t,children:t},t))})}),e.jsx("button",{className:"px-3 py-1 text-xs bg-indigo-600/20 border border-indigo-600/40 text-indigo-300 rounded hover:bg-indigo-600/30 transition-colors",children:"Rotate Now"})]},s.id))})]})]}),r==="Audit"&&e.jsx("div",{className:"h-full overflow-y-auto p-6",children:e.jsx("div",{className:"space-y-2",children:j.map(s=>e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg px-5 py-3 flex items-center gap-4",children:[e.jsx("div",{className:i("w-2 h-2 rounded-full shrink-0",s.result==="success"?"bg-emerald-400":"bg-rose-400")}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-sm font-mono font-medium text-indigo-300",children:s.action}),e.jsx("span",{className:"text-xs text-zinc-400",children:s.serviceAccount}),s.keyId!=="—"&&e.jsxs("span",{className:"text-[10px] text-zinc-500 font-mono",children:["key:",s.keyId]})]}),e.jsxs("div",{className:"flex gap-3 mt-1 text-[10px] text-zinc-500",children:[e.jsxs("span",{children:["Actor: ",s.actor]}),e.jsxs("span",{children:["IP: ",s.ip]})]})]}),e.jsx("div",{className:"text-xs text-zinc-500 shrink-0",children:s.timestamp.slice(0,16).replace("T"," ")}),e.jsx("div",{className:i("text-xs font-medium shrink-0",s.result==="success"?"text-emerald-400":"text-rose-400"),children:s.result})]},s.id))})})]})]})}export{y as default};
