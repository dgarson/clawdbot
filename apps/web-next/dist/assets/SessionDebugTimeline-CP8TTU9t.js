import{r as x,R as v,j as e,c}from"./index-D2H6hWpW.js";const I=[{id:"e1",offsetMs:0,type:"system",status:"ok",title:"Session started",summary:"Agent initialized with SOUL.md + USER.md context loaded",detail:"Session created. Profile: production. Model: claude-3-5-sonnet. Context: SOUL.md (2,140 tokens), USER.md (880 tokens), CONTEXT.md (1,200 tokens). Total preload: 4,220 tokens.",tokens:4220,latencyMs:0,model:"claude-3-5-sonnet"},{id:"e2",offsetMs:312,type:"user",status:"ok",title:"User message",summary:"What's the current status of the Horizon UI sprint?",detail:`Role: user
Content: "What's the current status of the Horizon UI sprint?"
Tokens: 14
Channel: webchat
Timestamp: 2026-02-22T06:05:12Z`,tokens:14,latencyMs:312,role:"user"},{id:"e3",offsetMs:820,type:"tool_call",status:"ok",title:"read: UX_WORK_QUEUE.md",summary:"Reading sprint work queue to fetch current status",detail:`Tool: read
Input path: /Users/openclaw/.openclaw/workspace/luis/UX_WORK_QUEUE.md
Call ID: tool-call-0a3f
Model decided to read the sprint queue before answering.`,tokens:0,latencyMs:508,tool:{name:"read",input:'{"path": "/Users/openclaw/.openclaw/workspace/luis/UX_WORK_QUEUE.md"}',output:`# UX Work Queue ‚Äî OpenClaw Horizon

**Sprint Status:** ‚úÖ ABSOLUTELY CRUSHED ‚Äî **48 views** shipped...`,durationMs:142,success:!0}},{id:"e4",offsetMs:962,type:"tool_result",status:"ok",title:"read result ‚Äî 8,420 bytes",summary:"File read successfully: 48 views complete, 0 TS errors",detail:"Tool result for call-0a3f. Content length: 8,420 bytes. Exit code: 0. Read latency: 142ms.",tokens:1840,latencyMs:142},{id:"e5",offsetMs:2240,type:"assistant",status:"ok",title:"Assistant response",summary:"The Horizon UI sprint is complete ‚Äî 48 views shipped‚Ä¶",detail:`Role: assistant
Model: claude-3-5-sonnet
Content: "The Horizon UI sprint is complete ‚Äî 48 views shipped, all builds passing (0 TypeScript errors). The original goal was 10-12 views by 7:30 AM; we shipped 48 by ~2:00 AM ‚Äî 5 hours early and 2.5√ó the goal. All lazy-loaded chunks are wired into App.tsx. Currently queued: ActivityFeed, CommandPalette, SupportCenter, TroubleshootingWizard, ReleasePipeline."
Tokens: 112
Generation time: 1,278ms
Finish reason: stop`,tokens:112,latencyMs:1278,model:"claude-3-5-sonnet",role:"assistant"},{id:"e6",offsetMs:3100,type:"user",status:"ok",title:"User message",summary:"Can you check if the build is still clean? Run pnpm check.",detail:`Role: user
Content: "Can you check if the build is still clean? Run pnpm check."
Tokens: 18`,tokens:18,latencyMs:860,role:"user"},{id:"e7",offsetMs:3640,type:"tool_call",status:"ok",title:"exec: pnpm check",summary:"Running type-check, lint, and tests",detail:`Tool: exec
Input: {"command": "cd /Users/openclaw/.openclaw/workspace/luis/apps/web-next && pnpm check"}
Call ID: tool-call-1b7c`,tokens:0,latencyMs:540,tool:{name:"exec",input:'{"command": "cd apps/web-next && pnpm check"}',output:`$ tsc --noEmit && eslint src/ && vitest run
‚úì 0 errors, 0 warnings
‚úì built in 1.55s
‚úì 48 lazy-loaded chunks`,durationMs:4820,success:!0}},{id:"e8",offsetMs:8460,type:"tool_result",status:"ok",title:"exec result ‚Äî clean",summary:"0 TS errors, 0 lint warnings, build in 1.55s",detail:"Tool result for call-1b7c. Exit code: 0. Stdout: tsc clean, eslint clean, built in 1.55s. Duration: 4,820ms.",tokens:210,latencyMs:4820},{id:"e9",offsetMs:9900,type:"assistant",status:"ok",title:"Assistant response",summary:"Build is clean ‚Äî 0 TypeScript errors, 0 lint warnings, 1.55s build.",detail:`Role: assistant
Model: claude-3-5-sonnet
Content: "Build is clean ‚Äî 0 TypeScript errors, 0 lint warnings, built in 1.55s. All 48 lazy-loaded view chunks are intact."
Tokens: 44
Generation time: 1,440ms
Finish reason: stop`,tokens:44,latencyMs:1440,model:"claude-3-5-sonnet",role:"assistant"},{id:"e10",offsetMs:10800,type:"context_shift",status:"warning",title:"Context window approaching limit",summary:"Context at 74% capacity ‚Äî compaction eligible",detail:"Context window utilization: 74% (148,000 / 200,000 tokens). Compaction threshold: 80%. Next compaction will trigger if 3+ more tool calls with large outputs occur.",tokens:0,latencyMs:0,context:{tokensBefore:148e3,tokensAfter:148e3,compacted:!1}},{id:"e11",offsetMs:11200,type:"user",status:"ok",title:"User message",summary:"Commit everything and push to master.",detail:`Role: user
Content: "Commit everything and push to master."
Tokens: 9`,tokens:9,latencyMs:400,role:"user"},{id:"e12",offsetMs:11700,type:"tool_call",status:"ok",title:"exec: git add -A && git commit",summary:"Staging all changes and committing",detail:`Tool: exec
Input: {"command": "cd /Users/openclaw/.openclaw/workspace/luis && git add -A && git commit -m \\"Views #249-250: SessionDebugTimeline, StreamingDebugger ‚Äî wire all\\""}
Call ID: tool-call-2c9d`,tokens:0,latencyMs:500,tool:{name:"exec",input:'{"command": "git add -A && git commit -m \\"Views #249-250\\""}',output:`[master ae7b249] Views #249-250: SessionDebugTimeline, StreamingDebugger
 3 files changed, 1847 insertions(+)`,durationMs:890,success:!0}},{id:"e13",offsetMs:13580,type:"tool_result",status:"ok",title:"exec result ‚Äî committed",summary:"master ae7b249 ‚Äî 3 files, 1847 insertions",detail:"Tool result for call-2c9d. Exit code: 0. Committed successfully. Hash: ae7b249.",tokens:88,latencyMs:890},{id:"e14",offsetMs:15200,type:"tool_call",status:"error",title:"exec: git push origin master",summary:"Push failed ‚Äî remote rejected (stale ref)",detail:`Tool: exec
Input: {"command": "git push origin master"}
Call ID: tool-call-3d1e
Error: remote rejected push due to stale ref. Needs rebase.`,tokens:0,latencyMs:1620,tool:{name:"exec",input:'{"command": "git push origin master"}',output:`error: failed to push some refs to 'origin'
hint: Updates were rejected because the remote contains work that you do
not have locally. Integrate the remote changes (e.g.
'git pull ...') before pushing again.`,durationMs:1620,success:!1}},{id:"e15",offsetMs:16820,type:"error",status:"error",title:"Tool error: git push rejected",summary:"Remote ahead of local ‚Äî rebase required before push",detail:"Tool call-3d1e returned non-zero exit code. Remote has commits not present locally. Recovery: git pull --rebase then repush.",tokens:0,latencyMs:0},{id:"e16",offsetMs:17100,type:"tool_call",status:"ok",title:"exec: git pull --rebase",summary:"Rebasing local changes on top of remote",detail:`Tool: exec
Input: {"command": "git pull --rebase origin master"}
Call ID: tool-call-4e2f`,tokens:0,latencyMs:280,tool:{name:"exec",input:'{"command": "git pull --rebase origin master"}',output:"Successfully rebased and updated refs/heads/master.",durationMs:1240,success:!0}},{id:"e17",offsetMs:19620,type:"tool_result",status:"ok",title:"exec result ‚Äî rebased",summary:"Rebase successful. Clean to push.",detail:"Tool result for call-4e2f. Exit code: 0. Rebase successful.",tokens:64,latencyMs:1240},{id:"e18",offsetMs:22e3,type:"assistant",status:"ok",title:"Assistant response",summary:"Rebased and pushed successfully. All 250 views on master.",detail:`Role: assistant
Content: "Hit a stale ref on push ‚Äî rebased and pushed successfully. All 250 views are now on master."
Tokens: 32
Generation time: 980ms
Finish reason: stop`,tokens:32,latencyMs:980,model:"claude-3-5-sonnet",role:"assistant"}],A=[{id:"b1",offsetMs:0,type:"system",status:"ok",title:"Session started",summary:"Xavier session ‚Äî architecture review context loaded",detail:"Session created. Profile: xavier. Model: claude-opus-4. Context preload: 3,100 tokens.",tokens:3100,latencyMs:0,model:"claude-opus-4"},{id:"b2",offsetMs:240,type:"user",status:"ok",title:"User message",summary:"Review the StreamingDebugger PR and leave feedback",detail:`Role: user
Content: "Review the StreamingDebugger PR and leave feedback"
Tokens: 11`,tokens:11,latencyMs:240,role:"user"},{id:"b3",offsetMs:720,type:"tool_call",status:"ok",title:"exec: gh pr list",summary:"Fetching open PRs from dgarson/clawdbot",detail:`Tool: exec
Input: {"command": "gh pr list --repo dgarson/clawdbot"}
Call ID: tool-call-b01`,tokens:0,latencyMs:480,tool:{name:"exec",input:'{"command": "gh pr list --repo dgarson/clawdbot"}',output:"#42  feat/streaming-debugger  OPEN  reed/streaming-debugger ‚Üí feat/horizon-ui",durationMs:780,success:!0}},{id:"b4",offsetMs:2100,type:"tool_call",status:"ok",title:"exec: gh pr diff 42",summary:"Reading StreamingDebugger diff",detail:`Tool: exec
Input: {"command": "gh pr diff 42 --repo dgarson/clawdbot"}
Call ID: tool-call-b02`,tokens:0,latencyMs:880,tool:{name:"exec",input:'{"command": "gh pr diff 42 --repo dgarson/clawdbot"}',output:`diff --git a/apps/web-next/src/views/StreamingDebugger.tsx b/...
+++ b/apps/web-next/src/views/StreamingDebugger.tsx
@@ -1,3 +1,1221 @@
+import React, { useState } from "react";
+import { cn } from "../lib/utils";
...`,durationMs:1100,success:!0}},{id:"b5",offsetMs:5400,type:"assistant",status:"ok",title:"PR review complete",summary:"Approved with minor notes. Merged into feat/horizon-ui.",detail:`Role: assistant
Content: "Reviewed PR #42 ‚Äî StreamingDebugger. Solid implementation. Approved and merged."
Tokens: 88
Generation time: 2,100ms`,tokens:88,latencyMs:2100,model:"claude-opus-4",role:"assistant"},{id:"b6",offsetMs:6200,type:"context_shift",status:"ok",title:"Context compacted",summary:"Compaction ran ‚Äî context trimmed from 82% to 31%",detail:"Context compaction triggered at 82% utilization (164,000 tokens). Post-compaction: 62,000 tokens (31%). Oldest 40 turns summarized.",tokens:0,latencyMs:320,context:{tokensBefore:164e3,tokensAfter:62e3,compacted:!0}}],U=[{id:"c1",offsetMs:0,type:"system",status:"ok",title:"Session started",summary:"Piper subagent ‚Äî spawned by Luis for TeamManagement component",detail:"Subagent session. Parent: luis. Task: Build TeamManagement.tsx. Model: claude-sonnet-4-6.",tokens:1200,latencyMs:0,model:"claude-sonnet-4-6"},{id:"c2",offsetMs:188,type:"tool_call",status:"ok",title:"write: TeamManagement.tsx",summary:"Writing 892-line TeamManagement component",detail:`Tool: write
Input: {"path": "...TeamManagement.tsx", "content": "..."}
Call ID: tool-call-c01`,tokens:0,latencyMs:188,tool:{name:"write",input:'{"path": "apps/web-next/src/views/TeamManagement.tsx"}',output:"Successfully wrote 45,210 bytes to TeamManagement.tsx",durationMs:95,success:!0}},{id:"c3",offsetMs:1100,type:"tool_call",status:"error",title:"exec: pnpm check",summary:"Build failed ‚Äî 3 TypeScript errors",detail:`Tool: exec
Input: {"command": "pnpm check"}
Call ID: tool-call-c02`,tokens:0,latencyMs:912,tool:{name:"exec",input:'{"command": "pnpm check"}',output:`src/views/TeamManagement.tsx:142:7 - error TS2322: Type 'string | undefined' is not assignable to type 'string'.
src/views/TeamManagement.tsx:198:3 - error TS7006: Parameter 'e' implicitly has an 'any' type.`,durationMs:3200,success:!1}},{id:"c4",offsetMs:5400,type:"error",status:"error",title:"TypeScript errors detected",summary:"2 type errors in TeamManagement.tsx ‚Äî self-correcting",detail:`Errors:
1. TS2322 line 142: string | undefined not assignable to string
2. TS7006 line 198: implicit any on event handler param
Self-correction initiated.`,tokens:0,latencyMs:0},{id:"c5",offsetMs:5800,type:"tool_call",status:"ok",title:"edit: fix TS errors",summary:"Applying 2 targeted fixes to TeamManagement.tsx",detail:`Tool: edit (√ó2)
Fix 1: Add ?? "" to string | undefined field
Fix 2: Type event param as React.ChangeEvent<HTMLInputElement>`,tokens:0,latencyMs:400,tool:{name:"edit",input:'{"file_path": "TeamManagement.tsx", "oldText": "...", "newText": "..."}',output:"Edit applied successfully.",durationMs:60,success:!0}},{id:"c6",offsetMs:7200,type:"tool_result",status:"ok",title:"Build clean after fix",summary:"0 TS errors ‚Äî component ready for PR",detail:"pnpm check: 0 errors, 0 warnings. Built in 1.48s.",tokens:0,latencyMs:3100},{id:"c7",offsetMs:9800,type:"system",status:"ok",title:"Subagent complete",summary:"Task finished. Result announced to parent (luis).",detail:"Subagent run complete. Output: TeamManagement.tsx (892 lines, 0 errors). Notified parent agent.",tokens:0,latencyMs:0}],b=[{id:"sess-luis-main",label:"Luis main ‚Äî Sprint recap + push",agentName:"luis",model:"claude-sonnet-4-6",startedAt:"2026-02-22T06:05:12Z",durationMs:22e3,totalTokens:6641,events:I},{id:"sess-xavier-review",label:"Xavier ‚Äî PR review + compaction",agentName:"xavier",model:"claude-opus-4",startedAt:"2026-02-22T05:48:00Z",durationMs:6520,totalTokens:3299,events:A},{id:"sess-piper-sub",label:"Piper subagent ‚Äî TeamManagement build",agentName:"piper",model:"claude-sonnet-4-6",startedAt:"2026-02-22T04:22:10Z",durationMs:9800,totalTokens:1200,events:U}],S={user:"bg-indigo-500",assistant:"bg-emerald-500",tool_call:"bg-amber-500",tool_result:"bg-amber-400/60",context_shift:"bg-purple-500",error:"bg-rose-500",system:"bg-zinc-500"},j={user:"üí¨",assistant:"ü§ñ",tool_call:"üîß",tool_result:"üì¨",context_shift:"ü™ü",error:"‚ö†Ô∏è",system:"‚öôÔ∏è"},O={ok:"text-emerald-400",error:"text-rose-400",warning:"text-amber-400",pending:"text-zinc-400"},D=[{label:"All",value:"all"},{label:"User",value:"user"},{label:"Assistant",value:"assistant"},{label:"Tools",value:"tool_call"},{label:"Context",value:"context_shift"},{label:"Errors",value:"error"},{label:"System",value:"system"}];function f(t){return t===0?"0ms":t<1e3?`${t}ms`:`${(t/1e3).toFixed(2)}s`}function N(t){return t<1e3?`+${t}ms`:`+${(t/1e3).toFixed(1)}s`}function z(t){return t.replace("T"," ").slice(0,19)+" UTC"}function P({durationMs:t,currentMs:a,events:o,onScrub:d}){const n=x.useRef(null),m=i=>{if(!n.current)return;const p=n.current.getBoundingClientRect(),y=Math.max(0,Math.min(1,(i.clientX-p.left)/p.width));d(Math.round(y*t))},r=t>0?a/t*100:0;return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{ref:n,onClick:m,className:"relative h-6 bg-zinc-800 rounded-lg cursor-pointer group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 bg-indigo-600/40 rounded-lg transition-none",style:{width:`${r}%`}}),o.map(i=>{const p=t>0?i.offsetMs/t*100:0;return e.jsx("div",{className:c("absolute top-1 w-1.5 h-4 rounded-sm opacity-80",S[i.type]),style:{left:`calc(${p}% - 3px)`},title:i.title},i.id)}),e.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-white shadow-glow",style:{left:`${r}%`}})]}),e.jsxs("div",{className:"flex justify-between text-xs font-mono text-zinc-600",children:[e.jsx("span",{children:"0ms"}),e.jsx("span",{className:"text-zinc-400",children:N(a)}),e.jsx("span",{children:f(t)})]})]})}function L({event:t,selected:a,onClick:o,prevOffsetMs:d}){const n=t.offsetMs-d;return e.jsxs(e.Fragment,{children:[n>500&&e.jsxs("div",{className:"flex items-center gap-2 py-1 px-3",children:[e.jsx("div",{className:"flex-1 h-px bg-zinc-800/60"}),e.jsxs("span",{className:"text-xs font-mono text-zinc-600",children:[f(n)," gap"]}),e.jsx("div",{className:"flex-1 h-px bg-zinc-800/60"})]}),e.jsxs("button",{onClick:o,className:c("w-full text-left flex items-start gap-3 px-3 py-2.5 transition-colors rounded-lg",a?"bg-indigo-600/20 border border-indigo-500/40":"hover:bg-zinc-800/60 border border-transparent"),children:[e.jsxs("div",{className:"flex flex-col items-center gap-1 pt-0.5 min-w-[36px]",children:[e.jsx("span",{className:"text-base leading-none",children:j[t.type]}),e.jsx("span",{className:"text-[10px] font-mono text-zinc-600",children:N(t.offsetMs)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[e.jsx("span",{className:c("text-xs font-medium",O[t.status]),children:t.status==="error"?"‚úó":t.status==="warning"?"‚ö†":"‚úì"}),e.jsx("span",{className:"text-sm font-medium text-white truncate",children:t.title}),t.tokens>0&&e.jsxs("span",{className:"ml-auto shrink-0 text-xs font-mono text-zinc-500",children:[t.tokens.toLocaleString()," tok"]})]}),e.jsx("p",{className:"text-xs text-zinc-500 truncate",children:t.summary})]}),t.latencyMs>0&&e.jsx("div",{className:"shrink-0 text-right",children:e.jsx("span",{className:c("text-xs font-mono",t.latencyMs>3e3?"text-amber-400":t.latencyMs>1e3?"text-zinc-400":"text-zinc-600"),children:f(t.latencyMs)})})]})]})}function B({event:t,session:a}){const[o,d]=x.useState("detail");return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-zinc-800",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:j[t.type]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-white truncate",children:t.title}),e.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:t.summary})]}),e.jsx("span",{className:c("shrink-0 text-xs px-2 py-0.5 rounded-full font-medium",t.status==="ok"?"bg-emerald-500/20 text-emerald-400":t.status==="error"?"bg-rose-500/20 text-rose-400":"bg-amber-500/20 text-amber-400"),children:t.status})]}),e.jsxs("div",{className:"flex gap-3 text-xs font-mono text-zinc-500",children:[e.jsxs("span",{children:["Offset: ",N(t.offsetMs)]}),t.latencyMs>0&&e.jsxs("span",{children:["Latency: ",f(t.latencyMs)]}),t.tokens>0&&e.jsxs("span",{children:["Tokens: ",t.tokens.toLocaleString()]})]})]}),e.jsx("div",{className:"flex gap-1 px-4 pt-3 pb-1",children:["detail","raw","context"].map(n=>e.jsx("button",{onClick:()=>d(n),className:c("px-3 py-1 text-xs font-medium rounded transition-colors capitalize",o===n?"bg-indigo-600 text-white":"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800"),children:n},n))}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-2 space-y-3",children:[o==="detail"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-zinc-950 rounded-lg p-3 font-mono text-xs text-zinc-300 whitespace-pre-wrap leading-relaxed",children:t.detail}),t.tool&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-zinc-500 uppercase tracking-wide",children:"Tool I/O"}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-zinc-600 mb-1",children:"Input"}),e.jsx("div",{className:"bg-zinc-950 rounded p-2 font-mono text-xs text-indigo-300 whitespace-pre-wrap",children:t.tool.input})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-zinc-600 mb-1",children:["Output"," ",e.jsx("span",{className:c("ml-1",t.tool.success?"text-emerald-500":"text-rose-500"),children:t.tool.success?"‚úì":"‚úó"})," ",e.jsx("span",{className:"text-zinc-600",children:f(t.tool.durationMs)})]}),e.jsx("div",{className:c("bg-zinc-950 rounded p-2 font-mono text-xs whitespace-pre-wrap max-h-36 overflow-y-auto",t.tool.success?"text-zinc-300":"text-rose-300"),children:t.tool.output})]})]})]}),t.context&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-zinc-500 uppercase tracking-wide",children:"Context Window"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-zinc-950 rounded p-3",children:[e.jsx("p",{className:"text-xs text-zinc-600 mb-1",children:"Before"}),e.jsx("p",{className:"text-lg font-bold font-mono text-white",children:t.context.tokensBefore.toLocaleString()}),e.jsx("p",{className:"text-xs text-zinc-500",children:"tokens"})]}),e.jsxs("div",{className:"bg-zinc-950 rounded p-3",children:[e.jsx("p",{className:"text-xs text-zinc-600 mb-1",children:"After"}),e.jsx("p",{className:c("text-lg font-bold font-mono",t.context.compacted?"text-emerald-400":"text-white"),children:t.context.tokensAfter.toLocaleString()}),e.jsx("p",{className:"text-xs text-zinc-500",children:t.context.compacted?"compacted":"tokens"})]})]}),t.context.compacted&&e.jsxs("div",{className:"bg-zinc-800 rounded p-2 text-xs text-zinc-400",children:["Saved"," ",e.jsx("span",{className:"text-emerald-400 font-mono",children:(t.context.tokensBefore-t.context.tokensAfter).toLocaleString()})," ","tokens (",Math.round((t.context.tokensBefore-t.context.tokensAfter)/t.context.tokensBefore*100),"% reduction)"]})]})]}),o==="raw"&&e.jsx("div",{className:"bg-zinc-950 rounded-lg p-3 font-mono text-xs text-zinc-400 whitespace-pre-wrap leading-relaxed",children:JSON.stringify({id:t.id,offsetMs:t.offsetMs,type:t.type,status:t.status,title:t.title,tokens:t.tokens,latencyMs:t.latencyMs,model:t.model,role:t.role,tool:t.tool?{name:t.tool.name,durationMs:t.tool.durationMs,success:t.tool.success}:void 0,context:t.context},null,2)}),o==="context"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-zinc-500 uppercase tracking-wide",children:"Session context"}),e.jsx("div",{className:"space-y-2",children:[{label:"Session",value:a.id},{label:"Agent",value:a.agentName},{label:"Model",value:a.model},{label:"Started",value:z(a.startedAt)},{label:"Duration",value:f(a.durationMs)},{label:"Total tokens",value:a.totalTokens.toLocaleString()},{label:"Event index",value:`${a.events.findIndex(n=>n.id===t.id)+1} / ${a.events.length}`}].map(n=>e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-zinc-500",children:n.label}),e.jsx("span",{className:"font-mono text-zinc-300",children:n.value})]},n.label))}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-zinc-500",children:"Token budget"}),e.jsxs("span",{className:"font-mono text-zinc-400",children:[a.totalTokens.toLocaleString()," / 200,000"]})]}),e.jsx("div",{className:"h-2 bg-zinc-800 rounded-full",children:e.jsx("div",{className:c("h-2 rounded-full",a.totalTokens/2e5>.8?"bg-rose-500":a.totalTokens/2e5>.6?"bg-amber-500":"bg-indigo-500"),style:{width:`${Math.min(a.totalTokens/2e5*100,100)}%`}})})]})]})]})]})}function F({session:t,currentMs:a}){const o=t.events.filter(r=>r.offsetMs<=a),d=o.filter(r=>r.status==="error").length,n=o.filter(r=>r.type==="tool_call").length,m=o.reduce((r,i)=>r+i.tokens,0);return e.jsxs("div",{className:"flex flex-wrap gap-4 px-4 py-3 bg-zinc-900 border-b border-zinc-800 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-zinc-500",children:"Events"}),e.jsx("span",{className:"font-mono text-white font-semibold",children:o.length})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-zinc-500",children:"Tool calls"}),e.jsx("span",{className:"font-mono text-amber-400 font-semibold",children:n})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-zinc-500",children:"Errors"}),e.jsx("span",{className:c("font-mono font-semibold",d>0?"text-rose-400":"text-zinc-400"),children:d})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-zinc-500",children:"Tokens"}),e.jsx("span",{className:"font-mono text-emerald-400 font-semibold",children:m.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-zinc-500",children:"Elapsed"}),e.jsx("span",{className:"font-mono text-zinc-300",children:f(a)})]})]})}function W(){const[t,a]=x.useState(b[0].id),[o,d]=x.useState(null),[n,m]=x.useState(0),[r,i]=x.useState(!1),[p,y]=x.useState(1),[g,T]=x.useState("all"),h=x.useRef(null),l=b.find(s=>s.id===t)??b[0],w=l.events.find(s=>s.id===o)??null;v.useEffect(()=>{if(h.current!==null&&(clearInterval(h.current),h.current=null),!r)return;const s=50;return h.current=setInterval(()=>{m(u=>{const M=u+s*p;return M>=l.durationMs?(i(!1),l.durationMs):M})},s),()=>{h.current!==null&&(clearInterval(h.current),h.current=null)}},[r,p,l.durationMs]),v.useEffect(()=>{const s=l.events.filter(u=>u.offsetMs<=n);if(s.length>0){const u=s[s.length-1];d(u.id)}},[n,l.events]);const C=s=>{a(s),d(null),m(0),i(!1)},R=s=>{m(s),i(!1)},E=()=>{n>=l.durationMs&&m(0),i(!0)},k=l.events.filter(s=>g==="all"?!0:g==="tool_call"?s.type==="tool_call"||s.type==="tool_result":s.type===g).filter(s=>s.offsetMs<=n),_=[1,2,5,10];return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white flex flex-col",children:[e.jsxs("div",{className:"px-4 pt-5 pb-3 border-b border-zinc-800 bg-zinc-950 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx("span",{children:"üé¨"})," Session Debug Timeline"]}),e.jsx("p",{className:"text-xs text-zinc-500 mt-0.5",children:"Replay and inspect agent sessions event-by-event"})]}),e.jsx("select",{value:t,onChange:s=>C(s.target.value),className:"bg-zinc-800 border border-zinc-700 text-white text-sm rounded-lg px-3 py-1.5 focus:outline-none focus:ring-1 focus:ring-indigo-500 max-w-xs",children:b.map(s=>e.jsx("option",{value:s.id,children:s.label},s.id))})]}),e.jsx("div",{className:"flex flex-wrap gap-3 text-xs",children:[{label:"Agent",value:l.agentName},{label:"Model",value:l.model},{label:"Started",value:z(l.startedAt)},{label:"Duration",value:f(l.durationMs)},{label:"Events",value:String(l.events.length)},{label:"Tokens",value:l.totalTokens.toLocaleString()}].map(s=>e.jsxs("div",{className:"flex items-center gap-1.5 bg-zinc-900 border border-zinc-800 rounded-lg px-2.5 py-1",children:[e.jsxs("span",{className:"text-zinc-500",children:[s.label,":"]}),e.jsx("span",{className:"font-mono text-zinc-300",children:s.value})]},s.label))}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{durationMs:l.durationMs,currentMs:n,events:l.events,onScrub:R}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:r?()=>i(!1):E,className:"w-8 h-8 rounded-full bg-indigo-600 hover:bg-indigo-500 flex items-center justify-center text-white transition-colors",children:r?"‚è∏":"‚ñ∂"}),e.jsx("button",{onClick:()=>{m(0),i(!1)},className:"w-7 h-7 rounded-full bg-zinc-800 hover:bg-zinc-700 flex items-center justify-center text-zinc-400 transition-colors text-sm",title:"Restart",children:"‚Ü∫"}),e.jsx("button",{onClick:()=>{m(l.durationMs),i(!1)},className:"w-7 h-7 rounded-full bg-zinc-800 hover:bg-zinc-700 flex items-center justify-center text-zinc-400 transition-colors text-sm",title:"Jump to end",children:"‚è≠"}),e.jsx("div",{className:"w-px h-5 bg-zinc-700"}),e.jsx("div",{className:"flex items-center gap-1",children:_.map(s=>e.jsxs("button",{onClick:()=>y(s),className:c("px-2 py-0.5 text-xs font-mono rounded transition-colors",p===s?"bg-indigo-600 text-white":"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800"),children:[s,"√ó"]},s))}),e.jsx("div",{className:"w-px h-5 bg-zinc-700"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:D.map(s=>e.jsx("button",{onClick:()=>T(s.value),className:c("px-2 py-0.5 text-xs rounded transition-colors",g===s.value?"bg-zinc-700 text-white":"text-zinc-600 hover:text-zinc-400"),children:s.label},s.value))})]})]})]}),e.jsx(F,{session:l,currentMs:n}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",style:{minHeight:0},children:[e.jsx("div",{className:"w-1/2 border-r border-zinc-800 overflow-y-auto flex flex-col",children:k.length===0?e.jsx("div",{className:"flex-1 flex items-center justify-center text-zinc-600 text-sm",children:n===0?"Press ‚ñ∂ to start replay":"No events match the current filter"}):e.jsx("div",{className:"p-2 space-y-0.5",children:k.map((s,u)=>e.jsx(L,{event:s,selected:s.id===o,prevOffsetMs:u===0?0:k[u-1].offsetMs,onClick:()=>d(s.id)},s.id))})}),e.jsx("div",{className:"w-1/2 overflow-hidden flex flex-col",children:w?e.jsx(B,{event:w,session:l}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-zinc-600 gap-2",children:[e.jsx("span",{className:"text-3xl",children:"üîç"}),e.jsx("p",{className:"text-sm",children:"Select an event to inspect"}),e.jsx("p",{className:"text-xs text-zinc-700",children:"Click any event in the timeline to view details, tool I/O, and context state"})]})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 px-4 py-2.5 border-t border-zinc-800 bg-zinc-950",children:[e.jsx("span",{className:"text-xs text-zinc-600 uppercase tracking-wide",children:"Legend"}),Object.entries(j).map(([s,u])=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:c("w-2.5 h-2.5 rounded-sm",S[s])}),e.jsx("span",{className:"text-xs text-zinc-500 capitalize",children:s.replace("_"," ")})]},s))]})]})}export{W as default};
