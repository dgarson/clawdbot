import{r as u,j as e,c as n}from"./index-wQFonBeR.js";const d=[{id:"wf-1",name:"New Agent Onboarding",description:"Automatically onboard new agents: notify team, configure access, send welcome package",status:"active",triggerType:"Event: agent.created",createdAt:"2026-01-15",lastRunAt:"2026-02-21T14:30:00Z",runs:[{id:"r1",startedAt:"2026-02-21T14:30:00Z",completedAt:"2026-02-21T14:30:45Z",status:"success",triggeredBy:"agent.created",stepsCompleted:5,stepsTotal:5},{id:"r2",startedAt:"2026-02-20T09:15:00Z",completedAt:"2026-02-20T09:15:38Z",status:"success",triggeredBy:"agent.created",stepsCompleted:5,stepsTotal:5},{id:"r3",startedAt:"2026-02-18T16:00:00Z",completedAt:"2026-02-18T16:00:12Z",status:"failed",triggeredBy:"agent.created",stepsCompleted:2,stepsTotal:5}],nodes:[{id:"n1",kind:"trigger",label:"Agent Created",description:"Fires when agent.created event is emitted",config:{eventType:"agent.created"},nextIds:["n2"],x:10,y:40,status:"active"},{id:"n2",kind:"condition",label:"Check Tier",description:"Is the new agent a principal or higher?",config:{field:"tier",op:"in",value:"principal,executive"},nextIds:["n3","n4"],x:30,y:40,status:"active"},{id:"n3",kind:"action",label:"Notify Amadeus",description:"Send DM to Amadeus with new agent details",config:{target:"amadeus",template:"new-agent-exec"},nextIds:["n5"],x:52,y:20,status:"active"},{id:"n4",kind:"action",label:"Notify Squad Lead",description:"Send DM to relevant squad lead",config:{target:"squad-lead",template:"new-agent-worker"},nextIds:["n5"],x:52,y:60,status:"active"},{id:"n5",kind:"delay",label:"Wait 5 min",description:"Allow setup to complete",config:{duration:300,unit:"seconds"},nextIds:["n6"],x:72,y:40,status:"active"},{id:"n6",kind:"notify",label:"Welcome Message",description:"Post welcome to #cb-activity",config:{channel:"#cb-activity",template:"welcome"},nextIds:["n7"],x:88,y:40,status:"active"},{id:"n7",kind:"end",label:"Done",description:"Workflow complete",config:{},nextIds:[],x:100,y:40,status:"active"}]},{id:"wf-2",name:"Daily Digest",description:"Every morning: compile agent activity summary and post to #cb-inbox",status:"active",triggerType:"Schedule: 0 8 * * *",createdAt:"2026-01-20",lastRunAt:"2026-02-22T08:00:00Z",runs:[{id:"r4",startedAt:"2026-02-22T08:00:00Z",completedAt:"2026-02-22T08:00:22Z",status:"success",triggeredBy:"schedule",stepsCompleted:4,stepsTotal:4},{id:"r5",startedAt:"2026-02-21T08:00:00Z",completedAt:"2026-02-21T08:00:18Z",status:"success",triggeredBy:"schedule",stepsCompleted:4,stepsTotal:4}],nodes:[{id:"n1",kind:"trigger",label:"Daily Schedule",description:"Runs at 8:00 AM every day",config:{cron:"0 8 * * *"},nextIds:["n2"],x:10,y:50,status:"active"},{id:"n2",kind:"action",label:"Fetch Activity",description:"Query last 24h agent runs and tasks",config:{lookback:"24h",include:"all-squads"},nextIds:["n3"],x:35,y:50,status:"active"},{id:"n3",kind:"action",label:"Compile Digest",description:"Format activity into digest template",config:{template:"daily-digest",format:"markdown"},nextIds:["n4"],x:62,y:50,status:"active"},{id:"n4",kind:"notify",label:"Post to Inbox",description:"Post digest to #cb-inbox",config:{channel:"#cb-inbox",mention:"here"},nextIds:[],x:88,y:50,status:"active"}]},{id:"wf-3",name:"Error Escalation",description:"When an agent reports an error, escalate based on severity and retry count",status:"active",triggerType:"Event: agent.error",createdAt:"2026-02-01",lastRunAt:"2026-02-22T02:15:00Z",runs:[{id:"r6",startedAt:"2026-02-22T02:15:00Z",completedAt:"2026-02-22T02:15:05Z",status:"success",triggeredBy:"agent.error",stepsCompleted:3,stepsTotal:3},{id:"r7",startedAt:"2026-02-21T18:30:00Z",completedAt:null,status:"running",triggeredBy:"agent.error",stepsCompleted:1,stepsTotal:3}],nodes:[{id:"n1",kind:"trigger",label:"Agent Error",description:"Fires on agent.error event",config:{eventType:"agent.error"},nextIds:["n2"],x:8,y:50,status:"active"},{id:"n2",kind:"condition",label:"Retry Count",description:"Has this error occurred >3 times?",config:{field:"retryCount",op:"gt",value:"3"},nextIds:["n3","n4"],x:30,y:50,status:"active"},{id:"n3",kind:"action",label:"Auto Retry",description:"Schedule an automatic retry in 30s",config:{delay:30,maxRetries:3},nextIds:["n6"],x:55,y:25,status:"active"},{id:"n4",kind:"condition",label:"Severity Check",description:"Is severity CRITICAL?",config:{field:"severity",op:"eq",value:"critical"},nextIds:["n5","n6"],x:55,y:70,status:"active"},{id:"n5",kind:"notify",label:"Page On-Call",description:"PagerDuty alert to on-call engineer",config:{integration:"pagerduty",urgency:"high"},nextIds:["n6"],x:78,y:55,status:"active"},{id:"n6",kind:"end",label:"Done",description:"Workflow complete",config:{},nextIds:[],x:95,y:50,status:"active"}]}],r={trigger:{emoji:"âš¡",color:"text-amber-400",bg:"bg-amber-900/30",border:"border-amber-600/50",label:"Trigger"},condition:{emoji:"ðŸ”€",color:"text-blue-400",bg:"bg-blue-900/30",border:"border-blue-600/50",label:"Condition"},action:{emoji:"âš™ï¸",color:"text-indigo-400",bg:"bg-indigo-900/30",border:"border-indigo-600/50",label:"Action"},delay:{emoji:"â±ï¸",color:"text-purple-400",bg:"bg-purple-900/30",border:"border-purple-600/50",label:"Delay"},notify:{emoji:"ðŸ””",color:"text-emerald-400",bg:"bg-emerald-900/30",border:"border-emerald-600/50",label:"Notify"},branch:{emoji:"ðŸŒ¿",color:"text-teal-400",bg:"bg-teal-900/30",border:"border-teal-600/50",label:"Branch"},end:{emoji:"ðŸ",color:"text-zinc-400",bg:"bg-zinc-800/50",border:"border-zinc-600/50",label:"End"}},z={active:{label:"Active",color:"text-emerald-400",dot:"bg-emerald-400"},draft:{label:"Draft",color:"text-zinc-400",dot:"bg-zinc-400"},paused:{label:"Paused",color:"text-amber-400",dot:"bg-amber-400"},archived:{label:"Archived",color:"text-zinc-600",dot:"bg-zinc-600"}},h={success:{label:"Success",color:"text-emerald-400",bg:"bg-emerald-900/30 border-emerald-700/50"},failed:{label:"Failed",color:"text-rose-400",bg:"bg-rose-900/30 border-rose-700/50"},running:{label:"Running",color:"text-amber-400",bg:"bg-amber-900/30 border-amber-700/50"}};function R(){const[j,w]=u.useState(d[0]),[a,b]=u.useState(null),[o,y]=u.useState("canvas"),[k,T]=u.useState(!1),l=j,f=z[l.status],N=d.reduce((t,s)=>t+s.runs.length,0),A=d.reduce((t,s)=>t+s.runs.filter(i=>i.status==="success").length,0),C=d.filter(t=>t.status==="active").length;return e.jsxs("div",{className:"h-full flex flex-col bg-zinc-950 overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 px-6 py-4 border-b border-zinc-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"Workflow Builder"}),e.jsx("p",{className:"text-sm text-zinc-400",children:"Automate agent operations with visual workflows"})]}),e.jsx("button",{onClick:()=>T(!k),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg text-sm font-medium",children:"+ New Workflow"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:[{label:"Total Workflows",value:d.length,color:"text-white"},{label:"Active",value:C,color:"text-emerald-400"},{label:"Total Runs",value:N,color:"text-indigo-400"},{label:"Success Rate",value:`${Math.round(A/N*100)}%`,color:"text-emerald-400"}].map(t=>e.jsxs("div",{className:"bg-zinc-900 rounded-lg p-3 border border-zinc-800",children:[e.jsx("div",{className:n("text-xl font-bold",t.color),children:t.value}),e.jsx("div",{className:"text-xs text-zinc-500",children:t.label})]},t.label))})]}),e.jsxs("div",{className:"flex-1 overflow-hidden flex",children:[e.jsxs("div",{className:"flex-shrink-0 w-64 border-r border-zinc-800 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b border-zinc-800",children:e.jsx("div",{className:"text-xs text-zinc-500 font-medium uppercase tracking-wide px-1 mb-2",children:"Workflows"})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:d.map(t=>{const s=z[t.status],i=j.id===t.id,c=t.runs.find(x=>x.status==="running")??t.runs[0];return e.jsxs("button",{onClick:()=>{w(t),b(null),y("canvas")},className:n("w-full text-left p-3 rounded-lg border transition-all",i?"bg-indigo-900/30 border-indigo-600/60":"bg-zinc-900/50 border-zinc-800 hover:border-zinc-600"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx("span",{className:"text-sm font-medium text-white truncate",children:t.name}),e.jsx("span",{className:n("w-2 h-2 rounded-full flex-shrink-0 ml-2",s.dot)})]}),e.jsx("div",{className:"text-xs text-zinc-500 mb-2 leading-relaxed truncate",children:t.description}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[e.jsxs("span",{className:"bg-zinc-800 text-zinc-400 px-1.5 py-0.5 rounded",children:[t.nodes.length," nodes"]}),e.jsxs("span",{className:"bg-zinc-800 text-zinc-400 px-1.5 py-0.5 rounded",children:[t.runs.length," runs"]}),c&&e.jsx("span",{className:n("px-1.5 py-0.5 rounded border",h[c.status].bg,h[c.status].color),children:h[c.status].label})]})]},t.id)})}),e.jsxs("div",{className:"border-t border-zinc-800 p-3",children:[e.jsx("div",{className:"text-xs text-zinc-500 font-medium uppercase tracking-wide px-1 mb-2",children:"Node Types"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:Object.keys(r).filter(t=>t!=="end").map(t=>{const s=r[t];return e.jsxs("div",{className:n("flex items-center gap-1.5 px-2 py-1.5 rounded border cursor-default text-[11px]",s.bg,s.border,s.color),children:[e.jsx("span",{children:s.emoji}),e.jsx("span",{children:s.label})]},t)})})]})]}),e.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 px-5 py-3 border-b border-zinc-800 bg-zinc-900/50 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-base font-semibold text-white",children:l.name}),e.jsxs("span",{className:n("flex items-center gap-1.5 text-xs",f.color),children:[e.jsx("span",{className:n("w-1.5 h-1.5 rounded-full",f.dot)}),f.label]})]}),e.jsxs("div",{className:"text-xs text-zinc-500 mt-0.5",children:[l.triggerType," Â· ",l.nodes.length," nodes"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[["canvas","runs","settings"].map(t=>e.jsx("button",{onClick:()=>y(t),className:n("px-3 py-1.5 rounded text-sm capitalize",o===t?"bg-indigo-600 text-white":"bg-zinc-800 text-zinc-400 hover:text-white"),children:t},t)),e.jsx("button",{className:"bg-zinc-800 hover:bg-zinc-700 text-zinc-300 px-3 py-1.5 rounded text-sm ml-2",children:"â–¶ Run Now"})]})]}),e.jsxs("div",{className:"flex-1 overflow-hidden flex",children:[e.jsxs("div",{className:"flex-1 overflow-auto",children:[o==="canvas"&&e.jsxs("div",{className:"relative bg-zinc-950",style:{height:480,minWidth:900},children:[e.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(circle, #71717a 1px, transparent 1px)",backgroundSize:"24px 24px"}}),l.nodes.map(t=>t.nextIds.map(s=>{const i=l.nodes.find(S=>S.id===s);if(!i)return null;const c=t.x,x=t.y,g=i.x,p=i.y,m=(c+g)/2,v=p-x,I=v>5;return e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute bg-zinc-600",style:{left:`calc(${c}% + 68px)`,top:`calc(${x}% + 18px)`,width:`calc(${m-c}% - 68px + ${Math.abs(m-g)<5,0}px)`,height:1.5}}),Math.abs(v)>3&&e.jsx("div",{className:"absolute bg-zinc-600",style:{left:`${m}%`,top:`calc(${Math.min(x,p)}% + 18px)`,width:1.5,height:`calc(${Math.abs(v)}% + 0px)`}}),e.jsx("div",{className:"absolute bg-zinc-600",style:{left:`${m}%`,top:`calc(${p}% + 18px)`,width:`calc(${g-m}%)`,height:1.5}}),e.jsx("div",{className:"absolute text-zinc-600 text-xs",style:{left:`calc(${g}% - 6px)`,top:`calc(${p}% + 13px)`},children:"â–¶"})]},`${t.id}->${s}`)})),l.nodes.map(t=>{const s=r[t.kind],i=(a==null?void 0:a.id)===t.id;return e.jsxs("button",{onClick:()=>b(i?null:t),className:n("absolute flex flex-col items-center gap-1.5 p-3 rounded-xl border transition-all text-left","w-32",s.bg,s.border,i?"ring-2 ring-indigo-400 ring-offset-1 ring-offset-zinc-950 shadow-lg shadow-indigo-900/30":"hover:brightness-110"),style:{left:`${t.x}%`,top:`${t.y}%`,transform:"translateY(-50%)",zIndex:i?10:1},children:[e.jsx("span",{className:"text-xl",children:s.emoji}),e.jsx("span",{className:n("text-xs font-semibold leading-tight text-center",s.color),children:t.label}),e.jsx("span",{className:"text-[10px] text-zinc-500 text-center leading-tight",children:s.label})]},t.id)})]}),o==="runs"&&e.jsxs("div",{className:"p-5 space-y-3",children:[e.jsx("div",{className:"text-sm font-medium text-white mb-3",children:"Run History"}),l.runs.map(t=>{const s=h[t.status],i=t.completedAt?`${Math.round((new Date(t.completedAt).getTime()-new Date(t.startedAt).getTime())/1e3)}s`:"Runningâ€¦",c=Math.round(t.stepsCompleted/t.stepsTotal*100);return e.jsxs("div",{className:n("rounded-xl border p-4",s.bg),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:n("text-sm font-semibold",s.color),children:s.label}),e.jsx("span",{className:"text-xs text-zinc-500",children:t.id})]}),e.jsx("span",{className:"text-xs text-zinc-500",children:i})]}),e.jsxs("div",{className:"text-xs text-zinc-400 mb-2",children:["Triggered by ",e.jsx("span",{className:"text-zinc-300",children:t.triggeredBy})," Â· ",t.startedAt.slice(0,16).replace("T"," ")]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-1.5 bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:n("h-full rounded-full",t.status==="success"?"bg-emerald-500":t.status==="failed"?"bg-rose-500":"bg-amber-500"),style:{width:`${c}%`}})}),e.jsxs("span",{className:"text-xs text-zinc-500",children:[t.stepsCompleted,"/",t.stepsTotal," steps"]})]})]},t.id)})]}),o==="settings"&&e.jsxs("div",{className:"p-5 max-w-lg space-y-4",children:[e.jsx("div",{className:"text-sm font-medium text-white mb-3",children:"Workflow Settings"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-zinc-400 block mb-1",children:"Name"}),e.jsx("input",{type:"text",defaultValue:l.name,className:"bg-zinc-800 border border-zinc-700 text-white rounded px-3 py-2 text-sm w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-zinc-400 block mb-1",children:"Description"}),e.jsx("textarea",{defaultValue:l.description,className:"bg-zinc-800 border border-zinc-700 text-white rounded px-3 py-2 text-sm w-full resize-none",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-zinc-400 block mb-1",children:"Trigger"}),e.jsx("input",{type:"text",defaultValue:l.triggerType,className:"bg-zinc-800 border border-zinc-700 text-white rounded px-3 py-2 text-sm w-full font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-zinc-400 block mb-1",children:"Status"}),e.jsxs("select",{className:"bg-zinc-800 border border-zinc-700 text-white rounded px-3 py-2 text-sm w-full",defaultValue:l.status,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"paused",children:"Paused"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded text-sm",children:"Save Changes"}),e.jsx("button",{className:"bg-zinc-800 hover:bg-zinc-700 text-zinc-300 px-4 py-2 rounded text-sm",children:"Cancel"})]})]})]})]}),a&&o==="canvas"&&e.jsxs("div",{className:"flex-shrink-0 w-72 border-l border-zinc-800 bg-zinc-900 overflow-y-auto p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:n("text-xs font-medium mb-1",r[a.kind].color),children:[r[a.kind].emoji," ",r[a.kind].label]}),e.jsx("h3",{className:"text-base font-semibold text-white",children:a.label}),e.jsx("p",{className:"text-xs text-zinc-400 mt-1 leading-relaxed",children:a.description})]}),e.jsx("button",{onClick:()=>b(null),className:"text-zinc-500 hover:text-white ml-2",children:"âœ•"})]}),Object.keys(a.config).length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-zinc-500 font-medium mb-2 uppercase tracking-wide",children:"Configuration"}),e.jsx("div",{className:"space-y-2",children:Object.entries(a.config).map(([t,s])=>e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] text-zinc-500 block mb-1 capitalize",children:t.replace(/([A-Z])/g," $1")}),e.jsx("input",{type:"text",defaultValue:String(s),className:"bg-zinc-800 border border-zinc-700 text-white rounded px-2.5 py-1.5 text-xs w-full font-mono"})]},t))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-zinc-500 font-medium mb-2 uppercase tracking-wide",children:"Connections Out"}),a.nextIds.length===0?e.jsx("div",{className:"text-xs text-zinc-600",children:"Terminal node â€” no outgoing connections"}):e.jsx("div",{className:"space-y-1",children:a.nextIds.map(t=>{const s=l.nodes.find(i=>i.id===t);return s?e.jsxs("button",{onClick:()=>b(s),className:"flex items-center gap-2 bg-zinc-800 rounded px-2.5 py-1.5 w-full text-left hover:bg-zinc-700 transition-colors",children:[e.jsx("span",{children:r[s.kind].emoji}),e.jsx("span",{className:"text-xs text-zinc-300",children:s.label}),e.jsx("span",{className:n("text-[10px] ml-auto",r[s.kind].color),children:r[s.kind].label})]},t):null})})]}),e.jsxs("div",{className:"flex gap-2 pt-3 border-t border-zinc-800",children:[e.jsx("button",{className:"flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded text-xs",children:"Save"}),e.jsx("button",{className:"flex-1 bg-rose-900/40 hover:bg-rose-900/60 text-rose-400 border border-rose-700/50 py-1.5 rounded text-xs",children:"Delete"})]})]})]})]})]})]})}export{R as default};
