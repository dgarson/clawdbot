(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[556],{3298:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>q});var a=t(80534),l=t(74166),r=t(29068),n=t(74765),d=t(86719),c=t(82505),i=t(44446),o=t(94517),x=t(71216),u=t(88431);function m(e){let{height:s=300}=e;return(0,a.jsx)("div",{className:"flex items-center justify-center bg-muted/30 rounded-lg animate-pulse",style:{height:s},children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(u.A,{className:"h-5 w-5 animate-spin"}),(0,a.jsx)("span",{className:"text-xs",children:"Loading chart..."})]})})}let h=l.lazy(()=>Promise.all([t.e(307),t.e(518)]).then(t.bind(t,64518)).then(e=>({default:e.TokenUsageChart}))),p=l.lazy(()=>Promise.all([t.e(307),t.e(518)]).then(t.bind(t,64518)).then(e=>({default:e.CostBreakdownChart})));function f(e){let{data:s}=e;return(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)(m,{height:300}),children:(0,a.jsx)(h,{data:s})})}function j(e){let{data:s}=e;return(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)(m,{height:300}),children:(0,a.jsx)(p,{data:s})})}var g=t(53573);let N=(0,g.A)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);var b=t(12542),v=t(40267),y=t(82806);let w=(0,g.A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var k=t(74350);let S=(0,g.A)("coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);var A=t(27487),C=t(32824);function M(e){return"$".concat((e/100).toFixed(2))}function D(e){return e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(1),"k"):e.toString()}function F(e){return e.toISOString().split("T")[0]}function T(e){let{title:s,value:t,description:l,icon:r,variant:d="default"}=e;return(0,a.jsx)(n.Zp,{className:{default:"",success:"border-l-4 border-l-emerald-500",warning:"border-l-4 border-l-amber-500"}[d],children:(0,a.jsx)(n.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:s}),(0,a.jsx)("p",{className:"text-2xl font-bold tracking-tight",children:t}),l&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:l})]}),(0,a.jsx)("div",{className:"rounded-lg bg-muted p-3",children:(0,a.jsx)(r,{className:"h-5 w-5 text-muted-foreground"})})]})})})}function z(){return(0,a.jsx)(n.Zp,{className:"animate-pulse",children:(0,a.jsx)(n.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"h-3 w-20 rounded bg-muted"}),(0,a.jsx)("div",{className:"h-7 w-24 rounded bg-muted"}),(0,a.jsx)("div",{className:"h-3 w-32 rounded bg-muted"})]}),(0,a.jsx)("div",{className:"h-11 w-11 rounded-lg bg-muted"})]})})})}function Z(){return(0,a.jsxs)("tr",{className:"animate-pulse",children:[(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)("div",{className:"h-4 w-32 rounded bg-muted"})}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)("div",{className:"h-4 w-16 rounded bg-muted"})}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)("div",{className:"h-4 w-14 rounded bg-muted"})}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)("div",{className:"h-4 w-10 rounded bg-muted"})}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)("div",{className:"h-4 w-24 rounded bg-muted"})})]})}function L(e){let{label:s,field:t,currentField:l,currentDir:r,onSort:n}=e,d=l===t;return(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wide cursor-pointer select-none hover:text-foreground transition-colors",onClick:()=>n(t),children:(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[s,(0,a.jsx)(N,{className:(0,C.cn)("h-3 w-3",d?"text-foreground":"text-muted-foreground/50")}),d&&(0,a.jsx)("span",{className:"text-[10px]",children:"asc"===r?"↑":"↓"})]})})}function R(){return(0,a.jsx)(n.Zp,{className:"border-dashed",children:(0,a.jsxs)(n.Wu,{className:"flex flex-col items-center justify-center py-16 text-center",children:[(0,a.jsx)("div",{className:"rounded-full bg-muted p-4 mb-4",children:(0,a.jsx)(b.A,{className:"h-8 w-8 text-muted-foreground"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-1",children:"No usage data"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground max-w-sm",children:(0,a.jsx)(x.v,{beginner:"Start chatting with your agent to see usage stats here.",standard:"No session usage data found for the selected date range.",expert:"No usage records returned for the queried interval."})})]})})}function q(){let{connected:e,request:s}=(0,r.z)(),[t,u]=l.useState(()=>{let e=new Date;return e.setDate(e.getDate()-7),F(e)}),[m,h]=l.useState(()=>F(new Date)),[p,g]=l.useState(null),[N,q]=l.useState([]),[E,W]=l.useState([]),[_,I]=l.useState(!0),[P,O]=l.useState(null),[U,V]=l.useState("cost"),[$,K]=l.useState("desc"),B=l.useCallback(async()=>{if(e){I(!0),O(null);try{var a,l;let[e,r,n]=await Promise.all([s("usage.status",{startDate:t,endDate:m}),s("sessions.usage",{startDate:t,endDate:m}),s("usage.daily",{startDate:t,endDate:m}).catch(()=>({daily:[]}))]);g(e),q(null!=(a=r.sessions)?a:[]),W(null!=(l=n.daily)?l:[])}catch(e){O(e instanceof Error?e.message:"Failed to load analytics")}finally{I(!1)}}},[e,s,t,m]);l.useEffect(()=>{B()},[B]);let G=l.useCallback(e=>{U===e?K(e=>"asc"===e?"desc":"asc"):(V(e),K("desc"))},[U]),H=l.useMemo(()=>[...N].sort((e,s)=>{var t,a;let l=null!=(t=e[U])?t:0,r=null!=(a=s[U])?a:0;return"asc"===$?l-r:r-l}),[N,U,$]);return(0,a.jsxs)("div",{className:"flex flex-col gap-6 p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:(0,a.jsx)(x.v,{beginner:"Usage",standard:"Analytics",expert:"Usage Analytics"})}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:(0,a.jsx)(x.v,{beginner:"See how much your agent has been used.",standard:"Token usage, costs, and session activity.",expert:"Aggregated usage metrics, cost breakdown, and session-level telemetry."})})]}),(0,a.jsxs)(d.$,{variant:"outline",size:"sm",onClick:B,disabled:_||!e,children:[(0,a.jsx)(v.A,{className:(0,C.cn)("mr-1.5 h-3.5 w-3.5",_&&"animate-spin")}),"Refresh"]})]}),!e&&(0,a.jsx)(n.Zp,{className:"border-warning/50 bg-warning/5",children:(0,a.jsxs)(n.Wu,{className:"flex items-center gap-3 py-3",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 text-warning"}),(0,a.jsx)("p",{className:"text-sm text-warning",children:"Not connected to Gateway. Analytics data may be stale."})]})}),P&&(0,a.jsx)(n.Zp,{className:"border-destructive/50 bg-destructive/5",children:(0,a.jsx)(n.Wu,{className:"py-3",children:(0,a.jsx)("p",{className:"text-sm text-destructive",children:P})})}),(0,a.jsx)(n.Zp,{children:(0,a.jsxs)(n.Wu,{className:"flex flex-col gap-3 py-4 sm:flex-row sm:items-center",children:[(0,a.jsx)(w,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-muted-foreground whitespace-nowrap",children:"From"}),(0,a.jsx)(c.p,{type:"date",value:t,onChange:e=>u(e.target.value),className:"w-40"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-muted-foreground whitespace-nowrap",children:"To"}),(0,a.jsx)(c.p,{type:"date",value:m,onChange:e=>h(e.target.value),className:"w-40"})]}),(0,a.jsx)("div",{className:"flex gap-2 sm:ml-auto",children:[{label:"7d",days:7},{label:"30d",days:30},{label:"90d",days:90}].map(e=>{let{label:s,days:t}=e;return(0,a.jsx)(d.$,{variant:"ghost",size:"sm",onClick:()=>{let e=new Date,s=new Date;s.setDate(s.getDate()-t),u(F(s)),h(F(e))},children:s},s)})})]})}),_?(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsx)(z,{}),(0,a.jsx)(z,{}),(0,a.jsx)(z,{})]}):p?(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsx)(T,{title:"Total Tokens",value:D(p.totalTokens),description:"".concat(p.totalTokens.toLocaleString()," tokens"),icon:k.A}),(0,a.jsx)(T,{title:"Total Cost",value:M(p.totalCost),description:"For selected period",icon:S,variant:"warning"}),(0,a.jsx)(T,{title:"Active Sessions",value:p.activeSessions,description:"Sessions with activity",icon:b.A,variant:"success"})]}):null,(0,a.jsx)(o.g,{level:"standard",children:(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsx)(f,{data:E}),(0,a.jsx)(j,{data:N.length>0?(()=>{let e=new Map;for(let a of N){var s,t;let l=null!=(s=a.agentId)?s:"unknown";e.set(l,(null!=(t=e.get(l))?t:0)+a.cost)}return Array.from(e.entries()).map(e=>{let[s,t]=e;return{name:s,value:t}}).sort((e,s)=>s.value-e.value).slice(0,8)})():[]})]})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:(0,a.jsx)(x.v,{beginner:"Session Details",standard:"Session Usage",expert:"Per-Session Telemetry"})}),(0,a.jsx)(o.g,{level:"expert",children:(0,a.jsxs)(d.$,{variant:"ghost",size:"sm",disabled:!0,children:[(0,a.jsx)(A.A,{className:"mr-1.5 h-3.5 w-3.5"}),"Export CSV"]})})]}),_?(0,a.jsx)(n.Zp,{children:(0,a.jsx)(i.F,{className:"w-full",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase",children:"Session"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase",children:"Tokens"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase",children:"Cost"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase",children:"Requests"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase",children:"Last Active"})]})}),(0,a.jsx)("tbody",{children:Array.from({length:5}).map((e,s)=>(0,a.jsx)(Z,{},s))})]})})}):0===H.length?(0,a.jsx)(R,{}):(0,a.jsx)(n.Zp,{children:(0,a.jsx)(i.F,{className:"w-full",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Session"}),(0,a.jsx)(L,{label:"Tokens",field:"tokens",currentField:U,currentDir:$,onSort:G}),(0,a.jsx)(L,{label:"Cost",field:"cost",currentField:U,currentDir:$,onSort:G}),(0,a.jsx)(L,{label:"Requests",field:"requests",currentField:U,currentDir:$,onSort:G}),(0,a.jsx)(L,{label:"Last Active",field:"lastActiveAtMs",currentField:U,currentDir:$,onSort:G})]})}),(0,a.jsx)("tbody",{children:H.map(e=>{var s,t;return(0,a.jsxs)("tr",{className:"border-b last:border-0 hover:bg-muted/50 transition-colors",children:[(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-sm font-medium truncate max-w-[200px]",children:null!=(s=e.label)?s:e.sessionKey}),e.agentId&&(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.agentId})]})}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm tabular-nums",children:D(e.tokens)}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm tabular-nums",children:M(e.cost)}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm tabular-nums",children:e.requests}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-muted-foreground",children:(t=e.lastActiveAtMs)?new Date(t).toLocaleString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"—"})]},e.sessionKey)})})]})})})]}),(0,a.jsx)(o.g,{level:"expert",children:(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[N.length," session",1!==N.length?"s":""," \xb7"," ","Range: ",t," → ",m," \xb7"," ","Sorted by ",U," ",$]})})]})}},27487:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(53573).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},44446:(e,s,t)=>{"use strict";t.d(s,{F:()=>d});var a=t(80534),l=t(74166),r=t(94152),n=t(32824);let d=l.forwardRef((e,s)=>{let{className:t,children:l,...d}=e;return(0,a.jsxs)(r.bL,{ref:s,className:(0,n.cn)("relative overflow-hidden",t),...d,children:[(0,a.jsx)(r.LM,{className:"h-full w-full rounded-[inherit]",children:l}),(0,a.jsx)(c,{}),(0,a.jsx)(r.OK,{})]})});d.displayName="ScrollArea";let c=l.forwardRef((e,s)=>{let{className:t,orientation:l="vertical",...d}=e;return(0,a.jsx)(r.VM,{ref:s,orientation:l,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===l&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===l&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...d,children:(0,a.jsx)(r.lr,{className:"relative flex-1 rounded-full bg-border"})})});c.displayName="ScrollBar"},77243:(e,s,t)=>{Promise.resolve().then(t.bind(t,3298))},82505:(e,s,t)=>{"use strict";t.d(s,{p:()=>n});var a=t(80534),l=t(74166),r=t(32824);let n=l.forwardRef((e,s)=>{let{className:t,type:l,...n}=e;return(0,a.jsx)("input",{type:l,className:(0,r.cn)("flex h-9 w-full rounded-lg border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n})});n.displayName="Input"},88431:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(53573).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])}},e=>{e.O(0,[329,470,452,705,522,358],()=>e(e.s=77243)),_N_E=e.O()}]);