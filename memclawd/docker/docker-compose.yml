version: "3.9"

services:
  memclawd:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    environment:
      MEMCLAWD_CONFIG: "{}"
      MEMCLAWD_LOG_LEVEL: "info"
      REDIS_URL: "redis://redis:6379/0"
      POSTGRES_URL: "postgresql://memclawd:memclawd@postgres:5432/memclawd"
      NEO4J_URI: "bolt://neo4j:7687"
      NEO4J_USER: "neo4j"
      NEO4J_PASSWORD: "memclawd"
    ports:
      - "8080:8080"
    depends_on:
      - redis
      - postgres
      - neo4j

  redis:
    image: redis:7.4-alpine
    ports:
      - "6379:6379"

  postgres:
    image: pgvector/pgvector:pg16
    environment:
      POSTGRES_USER: "memclawd"
      POSTGRES_PASSWORD: "memclawd"
      POSTGRES_DB: "memclawd"
    ports:
      - "5432:5432"

  neo4j:
    image: neo4j:5.26-community
    environment:
      NEO4J_AUTH: "neo4j/memclawd"
    ports:
      - "7474:7474"
      - "7687:7687"
